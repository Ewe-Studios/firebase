{"version":3,"sources":["store/database/index.ts","store/logviewer/actions.ts","store/logviewer/index.ts","components/Auth/UserFormDialog/UserFormDialog.module.scss","components/Auth/UsersCard/header/AuthFilter.module.scss","components/Auth/UsersCard/header/AuthHeader.module.scss","components/Firestore/Collection.module.scss","components/Home/StatusLabel.module.scss","store/utils.ts","store/config/reducer.ts","store/config/sagas.ts","store/database/reducer.ts","store/database/sagas.ts","store/logviewer/reducer.ts","components/Auth/OneAccountPerEmailCard/OneAccountPerEmailCard.module.scss","components/Auth/OneAccountPerEmailCard/OneAccountPerEmailDialog.module.scss","components/Auth/UsersCard/UsersCard.module.scss","components/Auth/UsersCard/table/ProviderCell.module.scss","components/Database/DataViewer/ImportDialog.module.scss","components/Firestore/DocumentListItem.module.scss","components/Auth/index.module.scss","components/Firestore/models.ts","colors.tsx","components/Firestore/utils.ts","components/Firestore/DocumentEditor/types.ts","components/Firestore/DocumentEditor/utils.ts","store/auth/actions.tsx","store/auth/reducer.tsx","components/common/rest_api.ts","components/Auth/api.ts","store/auth/selectors.ts","store/auth/sagas.ts","store/index.ts","components/common/icons.tsx","components/common/EmulatorDisabled.tsx","themes.tsx","components/common/Spinner.tsx","components/Auth/OneAccountPerEmailCard/OneAccountPerEmailDialog.tsx","components/Auth/OneAccountPerEmailCard/OneAccountPerEmailCard.tsx","components/common/Callout.tsx","components/common/DialogQueue.tsx","components/Auth/UsersCard/ClearAll.tsx","components/Auth/UsersCard/confirmClearAllData.tsx","components/common/Field.tsx","components/Auth/UserFormDialog/controls/customClaimsValidation.ts","components/Auth/UserFormDialog/controls/CustomAttributes.tsx","components/Auth/UserFormDialog/controls/ImageUrlInput.tsx","components/Auth/UserFormDialog/controls/EmailPassword.tsx","components/Auth/UserFormDialog/controls/PhoneControl.tsx","components/Auth/UserFormDialog/controls/SignInMethod.tsx","components/Auth/UserFormDialog/UserForm.tsx","components/common/CardActionBar.tsx","components/Auth/UsersCard/header/AuthFilter.tsx","components/Auth/UsersCard/header/RefreshButton.tsx","components/Auth/UsersCard/header/AuthHeader.tsx","components/Auth/UsersCard/table/AuthZeroState.tsx","components/Auth/UsersCard/table/confirmDeleteUser.tsx","components/Auth/UsersCard/table/NoResults.tsx","components/Auth/types.ts","components/Auth/UsersCard/table/ProviderCell.tsx","components/Auth/UsersCard/table/UsersTable.tsx","components/Auth/UsersCard/UsersCard.tsx","components/Auth/index.tsx","firebase.ts","components/common/BreadCrumbs.tsx","components/common/InteractiveBreadCrumbBar.tsx","components/Database/api.ts","components/Database/DataViewer/common/view_model.ts","components/common/FileField.tsx","components/Database/DataViewer/ImportDialog.tsx","components/Database/DataViewer/common/fetch.ts","components/Firestore/DocumentEditor/actions.ts","components/Firestore/DocumentEditor/BooleanEditor.tsx","components/Firestore/DocumentEditor/GeoPointEditor.tsx","components/Firestore/DocumentEditor/JsonEditor.tsx","components/Firestore/DocumentEditor/NumberEditor.tsx","components/Firestore/DocumentEditor/ReferenceEditor.tsx","components/Firestore/DocumentEditor/store.tsx","components/Firestore/DocumentEditor/StringEditor.tsx","components/Firestore/DocumentEditor/TimestampEditor.tsx","components/Firestore/DocumentEditor/index.tsx","components/Firestore/DocumentPreview/InlineEditor.tsx","components/Database/DataViewer/NodeLink.tsx","components/Database/DataViewer/ValueDisplay.tsx","components/Database/DataViewer/NodeLeaf.tsx","components/Database/DataViewer/CloneDialog.tsx","components/Database/DataViewer/InlineQuery.tsx","components/Database/DataViewer/RenameDialog.tsx","components/Database/DataViewer/NodeTabularDisplay.tsx","components/Database/DataViewer/NodeActions.tsx","components/Database/DataViewer/NodeParent.tsx","components/Database/DataViewer/NodeContainer.tsx","components/Database/Database.tsx","store/database/selectors.ts","components/Database/DatabasePicker.tsx","components/Database/DatabaseContainer.tsx","components/Database/index.tsx","components/Firestore/dialogs/clearAll.tsx","components/common/CopyButton.tsx","components/Firestore/actions.tsx","components/Firestore/store.tsx","components/Firestore/CollectionFilter/ConditionEntry.tsx","components/Firestore/CollectionFilter/ConditionEntries.tsx","components/Firestore/CollectionFilter/SortRadioGroup.tsx","components/Firestore/CollectionFilter/CollectionFilter.tsx","components/Firestore/dialogs/AddDocumentDialog.tsx","components/Firestore/DocumentListItem.tsx","components/common/useRequest.ts","components/Firestore/FirestoreEmulatedApiProvider.tsx","components/Firestore/PanelHeader.tsx","components/Firestore/useAutoSelect.tsx","components/Firestore/Collection.tsx","components/Firestore/dialogs/AddCollectionDialog.tsx","components/Firestore/CollectionList.tsx","components/Firestore/dialogs/deleteDocument.tsx","components/Firestore/dialogs/deleteDocumentFields.tsx","components/Firestore/DocumentPreview/api.tsx","components/Firestore/DocumentPreview/store.tsx","components/Firestore/DocumentPreview/FieldPreview.tsx","components/LogViewer/HighlightedJSON.tsx","components/Firestore/DocumentPreview/index.tsx","components/Firestore/Document.tsx","components/Firestore/index.tsx","components/Home/LocalWarningCallout.tsx","components/common/constants.ts","components/Home/StatusLabel.tsx","components/Home/index.tsx","components/LogViewer/CompiledGetterCache.ts","components/LogViewer/QueryBar.tsx","components/LogViewer/ReconnectingWebSocket.ts","components/LogViewer/History.tsx","components/LogViewer/index.tsx","routes.ts","components/common/Logo.tsx","components/App/AppBar.tsx","components/App/AppDisconnected.tsx","components/App/index.tsx","index.tsx","configureStore.ts","store/config/selectors.ts","components/Firestore/CollectionFilter/CollectionFilter.module.scss","store/database/actions.ts","store/config/actions.ts","components/Auth/UserFormDialog/controls/controls.module.scss","store/config/index.ts","components/Auth/UsersCard/table/UsersTable.module.scss"],"names":["logReceived","createAction","logReset","module","exports","hasData","result","undefined","hasError","map","dataMapper","data","mapResult","remoteResult","loading","createRemoteDataLoaded","combineData","results","handle","mappers","onNone","onError","error","onData","squash","squashOrDefaut","defaultValue","a","replaceIfChanged","parent","key","newValue","oldValue","isDraft","original","deepEquals","configReducer","createReducer","handleAction","fetchRequest","state","produce","draft","fetchSuccess","payload","fetchError","fetchConfig","pollConfig","configSaga","fetchConfigApi","fetch","res","status","Error","statusText","json","_","call","config","put","message","delay","all","takeLatest","getType","subscribe","databaseReducer","databases","databasesSubscribed","databasesFetchRequest","databasesFetchSuccess","sort","db1","db2","name","localeCompare","databasesFetchError","databasesSubscribe","databasesUnsubscribe","getDbConfig","fetchDatabases","pollDatabases","databaseSaga","fetchDatabasesApi","projectId","hostAndPort","getProjectIdAndDbConfig","createSelector","getProjectIdResult","getDatabaseConfigResult","select","getDatabasesSubscribed","database","take","logReducer","history","FieldType","primary","grey100","isSingleValueCollectionFilter","cf","operator","isMultiValueCollectionFilter","isSortableCollectionFilter","NUMBER_REGEX","getParentPath","path","slice","length","lastFieldName","getFieldType","value","NULL","firebase","firestore","Timestamp","TIMESTAMP","Array","ARRAY","DocumentReference","REFERENCE","GeoPoint","GEOPOINT","Blob","BLOB","MAP","isBoolean","isNumber","isMap","isArray","isPrimitive","withFieldSet","get","Number","withFieldRemoved","splice","summarize","maxLen","array","output","element","summarizeArray","Object","entries","b","compareFirestoreKeys","summarizeMap","base64","toBase64","substr","BOOLEAN","toString","lat","latitude","Math","abs","long","longitude","NUMBER","STRING","toDate","JSON","fieldA","fieldB","DocumentPath","isFirestoreMap","isFirestoreArray","isNativePrimitive","isMapField","field","isArrayField","isJSONField","assertStoreHasRoot","store","uuid","assertIsMapField","assertIsArrayField","getUniqueId","normalize","children","reduce","mapChildren","fields","child","push","valueId","normalizeMap","arrayChildren","normalizeArray","normalizePrimitive","denormalize","acc","curr","doc","defaultValueForPrimitiveType","type","fromDate","Date","getDescendantIds","ids","id","c","createUserRequest","createUserSuccess","updateUserRequest","updateUserSuccess","setUserDisabledRequest","setUserDisabledSuccess","deleteUserRequest","deleteUserSuccess","updateFilter","nukeUsersRequest","nukeUsersSuccess","authFetchUsersRequest","authFetchUsersSuccess","authFetchUsersError","setAllowDuplicateEmailsRequest","setAllowDuplicateEmailsSuccess","getAllowDuplicateEmailsRequest","openAuthUserDialog","setAuthUserDialogLoading","setAuthUserDialogError","clearAuthUserDialogData","authReducer","users","filter","allowDuplicateEmails","authActions","createdAt","getTime","lastLoginAt","localId","disabled","user","u","authUserDialogData","ResponseError","response","RestApi","accessToken","url","method","headers","this","getToken","body","stringify","Authorization","jsonRequest","file","toFormData","append","text","formData","FormData","importUser","match","passwordHash","PASSWORD_HASH_REGEX","password","providerUserInfo","AuthApi","baseUrl","baseEmulatorUrl","deleteRequest","userInfo","fetchUser","patchRequest","signIn","getAuth","auth","getAuthUsers","getAuthUserDialog","getCurrentEditedUser","isEditingUser","getAuthUsersResult","getUsers","getAllEmails","Set","email","e","getAllPhoneNumbers","phoneNumber","hasUsers","getFilter","getAllowDuplicateEmails","getFilteredUsers","displayName","join","toLocaleUpperCase","includes","getShowZeroState","getShowZeroResults","filteredUsers","getShowTable","getAuthConfigResult","getConfigResult","fetchAuthUsers","initAuth","deleteUser","createUser","updateUser","setUserDisabled","setAllowDuplicateEmails","nukeUsers","configureAuthSaga","authSaga","authApi","newUser","customAttributes","keepDialogOpen","disableUser","rootSaga","fork","rootReducer","combineReducers","log","createStructuredSelector","selectors","reselect","FirestoreIcon","svgIcon","xmlns","viewBox","fill","d","fillRule","AuthIcon","DatabaseIcon","FunctionsIcon","HostingIcon","PubSubIcon","cx","cy","r","DatabaseCircleIcon","clipRule","stroke","strokeOpacity","HintIcon","svgElement","size","props","icon","strategy","Type","EmulatorDisabled","productName","desktop","tablet","phone","span","align","className","src","alt","use","tag","href","Spinner","cover","scrim","classnames","mapStateToProps","connect","dispatch","onClose","React","useState","setValue","renderToPortal","open","onSubmit","preventDefault","styles","description","checked","onChange","onClick","action","theme","unelevated","setOpen","wrapper","target","rel","outlined","tipTheme","background","primaryRgb","textIconOnBackground","textPrimaryOnBackground","textSecondaryOnBackground","teal700","teal800","successTheme","navy300","navy600","noteTheme","amber800","deepOrange900","cautionTheme","onPrimary","red700","red800","errorTheme","THEME_MAP","CAUTION","NOTE","SUCCESS","TIP","WARNING","CustomThemeProvider","wrap","options","DEFAULT_ICON_MAP","Callout","actions","aside","iconName","asideClass","classes","aria-hidden","createDialogQueue","dialogs","confirm","alert","prompt","clearAllData","clearAllButton","title","acceptLabel","cancelLabel","footer","isDefaultAction","danger","Field","fieldClassName","label","tip","fullwidth","textFieldProps","randomId","subtextId","htmlFor","aria-describedby","invalid","aria-invalid","role","SelectField","selectProps","assert","assertion","BadRequestError","validateSerializedCustomClaims","claims","parsed","parse","FORBIDDEN_CUSTOM_CLAIMS","reservedField","validateCustomClaims","validate","attributes","forbiddenClaim","ImagePreviewStatus","CUSTOM_ATTRIBUTES_CONTROL_NAME","CustomAttributes","errors","register","customAttributesWrapper","inputRef","textarea","placeholder","ImageUrlInput","watch","triggerValidation","ImageConstructor","Image","previewUrl","setPreviewUrl","image","useRef","imageUrlRef","NONE","photoUrl","useEffect","img","current","onload","LOADING","LOADED","onerror","ERROR","trim","imageWrapper","aria-busy","aria-live","data-testid","EMAIL_REGEX","getErrorText","emailpassword","allEmails","isEditing","setError","clearError","editedUserEmail","authKindLabel","emailWrapper","has","pattern","minLength","PHONE_REGEX","allPhoneNumbers","editedUserPhoneNumber","ERROR_AT_LEAST_ONE_METHOD_REQUIRED","SignInMethod","form","formState","isTouched","touched","isOnlyError","values","signInWrapper","signInHeader","useForm","defaultValues","mode","save","useCallback","handleSubmit","reset","canSubmit","isValid","submit","CardActionBar","surface","CardActionBarActions","style","flex","f","clear","filterEl","useLayoutEffect","focus","filterForm","input","aria-label","ripple","filterTextField","trailingIcon","onKeyDown","keyCode","keycode","refresh","AuthHeader","onOpenNewUserDialog","barActions","addUserButton","AuthZeroState","noResultsWrapper","confirmDeleteUser","NoResults","providerToIconMap","ProviderCell","iconWrapper","providerInfo","providerId","UsersTableRow","onEditUser","toggleUserDisabled","onDeleteUser","menuOpen","setMenuOpen","formattedCreatedAt","toLocaleDateString","formattedSignedIn","width","onOpen","shouldShowTable","shouldShowZeroResults","shouldShowZeroState","tableWrapper","projectIdResult","authConfigResult","authUsersResult","Auth","z","AuthRouteDisabled","initDatabase","namespace","databaseURL","app","initializeApp","random","applyAdminAuth","db","window","console","cleanup","delete","mockAuthComponent","Component","getUid","addAuthTokenListener","listener","removeAuthTokenListener","_addOrOverwriteComponent","EMPTY_KEYS","BreadCrumbs","base","onEdit","normalizedPath","startsWith","keys","split","hrefs","prevLink","Link","to","i","decodeURIComponent","InteractiveBreadCrumbBar","onNavigate","inputPrefix","breadCrumbProps","setIsEditing","handleCancel","useKey","eventTypes","when","currentTarget","DatabaseApi","ref","params","URLSearchParams","ns","access_token","getUploadPath","postFile","URL","pathname","replace","ChildrenDisplayType","FileField","onFiles","accept","useDropzone","onDrop","isDragActive","getRootProps","getInputProps","isDragReject","ImportDialog","api","reference","onComplete","droppedFile","setFile","isImporting","setIsImporting","importFile","container","required","files","DEFAULT_PAGE_SIZE","DEFAULT_QUERY_PARAMS","limit","jsonIshValue","getDbRootUrl","NO_CHILDREN","ADMIN_AUTH_HEADERS","createViewModel","canDoRealtime$","query","ReplaySubject","next","viewModel$","pipe","switchMap","queryParams","concatMap","realtime","from","once","snap","hasChildren","toObservable","applyQuery","val","isRealtime","isLoading","realtimeToViewModel","realtimeRef","orderBy","limitToFirst","equalTo","endAt","startAt","getRestQueryParams","shallow","restUrl","defer","fetchNonRealtime","nonRealtimeToViewModel","Observable","o","handler","on","snapshot","off","orderByChild","rootUrl","indexOf","encodeURIComponent","addToMap","addToArray","removeFromMap","removeFromArray","updateName","updateType","updateValue","BooleanEditor","GeoPointEditor","String","setLatitude","setLongitude","useFormContext","unregister","latitudeName","longitudeName","min","max","geoPoint","step","JsonEditor","initialValue","handleChange","NumberEditor","parseFloat","ReferenceEditor","useFirestore","documentStoreContext","reducer","normalized","find","childId","childField","isJson","assertIsPrimitiveField","storeReducer","handlers","DocumentStore","Provider","useDocumentStore","context","useStore","useDispatch","useField","StringEditor","dateToLocale","date","year","getFullYear","month","getMonth","padStart","dateOfMonth","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","TimestampEditor","setDate","isNaN","toMillis","timestamp","FIRESTORE_FIELD_TYPES","FIRESTORE_ARRAY_FIELD_TYPES","ft","RTDB_FIELD_TYPES","supportedFieldTypeSet","FieldEditor","isRtdb","areNamesMutable","areFieldsMutable","startingIndex","supportNestedArrays","allowedChildTypes","readonly","allowedTypes","index","valueEditor","isGeoPoint","isTimestamp","ChildTypeSelect","getDocumentFieldType","NameEditor","formName","siblingNames","useMemo","isUnique","every","DocumentEditor","areRootNamesMutable","areRootFieldsMutable","rtdb","initialState","useReducer","methods","denormalizedStore","errorCount","InlineEditor","onCancel","onSave","areRootKeysMutable","internalValue","setInternalValue","onClickOutside","onEscapeKey","stopPropagation","NodeLink","dbRef","absolutePath","useRouteMatch","withoutPath","matchPath","strict","useHrefWithinSameRoute","ValueDisplay","otherProps","trimmedValue","getClass","NodeLeaf","isAdding","setIsAdding","handleEdit","handleEditSuccess","set","handleAddSuccess","handleDelete","remove","showAddButton","content","getAbsoluteRefPath","CloneDialog","ok","hasQuery","originalKey","newDestinationPath","setNewDestinationPath","setForm","setIsLoading","isCloningWithFiltered","setCloningFiltered","forEach","loadData","updateField","root","event","InlineQuery","setValues","keyInputRef","valueInputRef","toParams","TableType","RenameDialog","isOpen","newKey","update","getNextDisplayType","Table","TreeView","getToggleIcon","ACTIVE_ICON","color","NodeActions","displayType","onDisplayTypeChange","updateQuery","onExpandRequested","isMenuOpen","showQueryUi","setShowQueryUi","cloneDialogIsOpen","setCloneDialogIsOpen","renameDialogIsOpen","setRenameDialogIsOpen","isActive","isRoot","pushId","removeNode","potentialQuery","onIcon","NodeTabularDisplay","hasMoreRows","onLoadMore","rows","table","setTable","buildTable","header","row","idx","colIndex","pkId","KeyValue","getColumnValue","colSpan","getTableType","getHeaders","parseInt","KeyObject","NodeParent","isViewRoot","isExpanded","setIsExpanded","setDisplayType","hasMore","loadMore","currentPageSize","toggleExpansion","NodeContainer","viewModel","setViewModel","querySubject","setQuerySubject","silent","print","timeout","mapTo","catchError","of","shareReplay","bufferSize","refCount","canDoRealtime","sub","vm","unsubscribe","setQueryParams","q","getPrefix","substring","Database","setRef","setApi","useHistory","importDialogOpen","setImportDialogOpen","setDroppedFile","urlBase","newPath","DatabaseDropZone","noClick","isDragAccept","getDatabaseNames","DatabaseListItem","navigation","activated","DatabasePicker","secondaryDbs","pickerClassName","dbs","setDbs","hasNewDbs","configResult","DatabaseRouteContent","exact","render","dbPath","DatabaseRouteDisabled","promptClearAll","CopyButton","textToCopy","writeText","isTextCopied","setIsTextCopied","navigator","clipboard","then","catch","useClipboard","addCollectionFilter","removeCollectionFilter","INIT_STATE","collectionFilters","firestoreStoreContext","FirestoreStore","initState","useFirestoreStore","useCollectionFilter","ConditionEntry","memo","getConditionEntryType","fieldType","setFieldType","conditionEntry","evt","conditionEntryType","as","conditionEntryValue","rules","BooleanCondition","selectValue","ConditionEntries","useFieldArray","conditionEntries","conditionName","removeFilter","hidden","SortRadioGroup","CollectionFilter","collectionFilter","formMethods","nest","preview","defaultOpen","CollectionFilterTheme","ConditionPreview","Preview","collectionId","pop","previewFilter","ConditionSelect","FilterItem","expanded","setExpanded","listItem","headerTitle","metaIcon","AddDocumentStep","collectionRef","setId","setData","getValue","invalidData","AddDocumentDialog","onValue","dialogProps","document","setDocument","detail","DocumentListItem","docId","queryFieldValue","missing","listItemClass","classNames","NavLink","activeClassName","useFetcher","onSuccess","useRequest","refreshInterval","fetcher","useSwr","suspense","FirestoreEmulatedApiProvider","disableDevTools","useProjectId","useEmulatedFirebaseApp","useFirestoreConfig","firebaseApp","fallback","FirestoreEmulatorSettings","FirestoreDevTools","connected","setConnected","useFirebaseApp","preloadFirestore","setup","useEmulator","host","port","windowWithFirestore","useFirestoreRestApi","databaseId","DOCUMENT_PATH_RE","encodePath","uri","PanelHeader","FIRESTORE_ROUTE","useAutoSelect","list","useLocation","autoSelect","setAutoSelect","isRootOrRootCollection","hasNothingSelected","firstChild","NO_DOCS","CollectionLoading","collection","Presentation","Step","Collection","addDocument","docs","missingDocs","isFilterOpen","setIsFilterOpen","isAddDocumentDialogOpen","setAddDocumentDialogOpen","badge","dense","Button","twoLine","docRef","newDocumentId","setNewDocumentId","filteredCollection","where","applyCollectionFilter","collectionSnapshot","useFirestoreCollection","encodedPath","documents","createTime","exec","useMissingDocuments","redirectIfAutoSelectable","AddCollectionStep","documentRef","AddCollectionDialog","COLLECTION","setStep","setCollectionId","DOCUMENT","RootCollectionList","rootCollections","collectionIds","useRootCollections","collections","SubCollectionList","subCollections","useSubCollections","CollectionList","isAddCollectionDialogOpen","setAddCollectionDialogOpen","addCollection","newCollection","encodedCollectionId","encodedReferencePath","coll","routeMatchUrl","CollectionListItem","promptDeleteDocument","promptDeleteDocumentFields","DELETE_FIELD","FieldValue","documentData","adjustPayloadForArray","addFieldToMissingDocument","exists","fieldPath","cur","parentPath","pathToUpdate","FieldPath","childPath","isEqual","DocumentStateContext","createContext","DocumentProvider","useDocumentState","useContext","useFieldState","documentState","HierarchyReferenceMode","FieldPreview","maxSummaryLen","parentState","isAddingField","setIsAddingField","childFields","childLeaf","deleteField","DocumentWarning","DocumentPreview","useFirestoreDoc","docExists","docEmpty","Doc","collectionById","Root","Document","handleDeleteDocument","handleDeleteFields","getFirestoreConfigResult","Firestore","location","isRefreshing","setIsRefreshing","eject","mutate","useEjector","showCollectionShell","showDocumentShell","handleNavigate","handleClearData","FirestoreRouteDisabled","DISMISS_KEY","LocalWarningCallout","useLocalStorage","writeStorage","INACTIVE_ICON","StatusLabel","configRemote","getConfig","Overview","linkTo","testId","functions","linkLabel","hosting","linkToExternal","pubsub","EmulatorCard","CompiledGetterCache","getters","obj","Function","err","warn","toHierarchyStep","DOT","BRACKET","toHierarchyJS","hierarchy","INCREMENT","HighlightedJSON","appendToQuery","compiledGetters","lines","isObject","pluck","getOrCompile","elements","line","quote_count","isStart","isEnd","endsWith","isEmptyArray","isEmptyObj","isKeyedObjStart","isKeyedArrayStart","isKeylessArrayStart","isKeylessObjStart","isLiteral","isObjEnd","isArrayEnd","start","splat","indent","v","hierarchy_chain","new_indent","queryFields","parseQuery","escapedQuery","isEscaped","char","sections","t","filters","queryChunks","position","quoted_section","section","isKeyPair","pairKey","search","WebSocketState","QueryBar","setQuery","temporaryQuery","setTemporaryQuery","parsedQuery","spellCheck","formatTimestamp","segment","number","FilterTag","tagButton","metadata","function","emulator","originalFieldPath","toLowerCase","fieldValue","isQueryMatch","messagesEndRef","scrollIntoView","formattedQueryLines","filtersToQueryString","getUserData","level","toUpperCase","ReconnectingWebSocket","DISCONNECTED","interval","ws","setInterval","WebSocket","PENDING","onopen","CONNECTED","onclose","onmessage","msg","clearInterval","close","mapDispatchToProps","routes","component","Home","showInNav","logging","qs","useQuery","webSocket","Logo","height","x1","y1","x2","y2","gradientTransform","gradientUnits","offset","stopColor","stopOpacity","clipPath","opacity","fillOpacity","AppBar","navRoutes","tabs","activeTabIndex","findIndex","onSurface","fixed","preventOutsideDismiss","App","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","sagaMiddleware","createSagaMiddleware","createStore","applyMiddleware","run","configureStore","RouterWithInit","subscribeToConfig","ReactDOM","unstable_createBlockingRoot","getElementById","StrictMode","secondary","useRemoteResultData","useSelector"],"mappings":"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","file":"static/js/main.351031c2.chunk.js","sourcesContent":["/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from './types';\nexport * from './actions';\nexport * from './reducer';\nexport * from './sagas';\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createAction } from 'typesafe-actions';\n\nimport { LogEntry } from './types';\n\nexport const logReceived = createAction('@log/RECEIVED')<LogEntry>();\n\n// TODO: Remove this hack once it's not needed.\nexport const logReset = createAction('@log/RESET')();\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from './types';\nexport * from './actions';\nexport * from './reducer';\n// export * from './sagas';\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"image\":\"UserFormDialog_image__1Z6Cw\",\"loading\":\"UserFormDialog_loading__nfVD8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"filterForm\":\"AuthFilter_filterForm__W0zqx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"barActions\":\"AuthHeader_barActions__3eROi\",\"addUserButton\":\"AuthHeader_addUserButton__35cpq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"query-panel\":\"Collection_query-panel__1MziT\",\"badge\":\"Collection_badge__B5KHa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"StatusLabel_container__2Y6KW\",\"icon\":\"StatusLabel_icon__34nuE\"};","import { isDraft, original } from 'immer';\nimport deepEquals from 'lodash.isequal';\n\nexport interface ErrorInfo {\n  message: string;\n}\n\n/* Represents result of a task, either success (with data) or error. */\nexport type Result<T, E = ErrorInfo> = DataResult<T> | ErrorResult<E>;\nexport type DataResult<T> = { data: T };\nexport type ErrorResult<E> = { error: E };\n\n// Type helper to extract the type of T.data.\nexport type DataTypeOf<T extends Result<any, any>> = T extends Result<\n  infer D,\n  any\n>\n  ? D\n  : any;\n\nexport type DataTypeIfPresent<\n  T extends Result<any, any> | undefined\n> = T extends DataResult<infer D> ? D : never;\n\n// Type helper to extract the type of T.error.\nexport type ErrorTypeOf<T extends Result<any, any>> = T extends Result<\n  any,\n  infer E\n>\n  ? E\n  : any;\n\nexport type ErrorTypeIfPresent<\n  T extends Result<any, any> | undefined\n> = T extends ErrorResult<infer E> ? E : never;\n\nexport function hasData<T, E>(\n  result: Result<T, E> | undefined\n): result is DataResult<T> {\n  return result !== undefined && 'data' in result;\n}\n\nexport function hasError<T, E>(\n  result: Result<T, E> | undefined\n): result is ErrorResult<E> {\n  return result !== undefined && 'error' in result;\n}\n\n// Transform data if present or return error unchanged.\nexport function map<T, E, R>(\n  result: Result<T, E>,\n  dataMapper: (data: T) => R\n): Result<R, E>;\n\n// Transform data if present or return error / undefined unchanged.\nexport function map<T, E, R>(\n  result: Result<T, E> | undefined,\n  dataMapper: (data: T) => R\n): Result<R, E> | undefined;\n\n// (Implementation of overloaded function. Not exposed.)\nexport function map<T, E, R>(\n  result: Result<T, E> | undefined,\n  dataMapper: (data: T) => R\n): Result<R, E> | undefined {\n  if (result === undefined) return undefined;\n  return 'error' in result ? result : { data: dataMapper(result.data) };\n}\n\n// Represents a piece of remote info, which may be\n// - No info and not loading (initial)\n// - No info and loading (fetching)\n// - Has info and not loading (completed)\n// - Has info and loading (refreshing)\nexport type Remote<T> = { result?: T; loading: boolean };\n\nexport type RemoteResult<T, E = ErrorInfo> = Remote<Result<T, E>>;\n\n// Transform result.data if present or return result.error unchanged.\nexport function mapResult<T, E, R>(\n  remoteResult: RemoteResult<T, E>,\n  dataMapper: (data: T) => R\n): RemoteResult<R, E> {\n  return {\n    loading: remoteResult.loading,\n    result: map(remoteResult.result, dataMapper),\n  };\n}\n\nexport function createRemoteDataLoaded<T>(data: T): RemoteResult<T> {\n  return {\n    loading: false,\n    result: { data },\n  };\n}\n\nexport type DataTypeOfEach<\n  T extends ReadonlyArray<Result<any, any> | undefined>\n> = {\n  [P in keyof T]: T[P] extends Result<any, any> | undefined\n    ? DataTypeIfPresent<T[P]>\n    : T[P];\n};\n\n/**\n * Combine data of the remote results, or return first error encountered.\n *\n * If there are no errors but any result is undefined, return undefined.\n */\nexport function combineData<\n  Arr extends ReadonlyArray<Result<any, any> | undefined>\n>(\n  ...results: Arr\n): Result<DataTypeOfEach<Arr>, ErrorTypeIfPresent<Arr[number]>> | undefined {\n  for (const result of results) {\n    if (hasError(result)) {\n      return result;\n    }\n  }\n  for (const result of results) {\n    if (result === undefined) {\n      return undefined;\n    }\n  }\n\n  return {\n    data: (results.map(\n      (result) => (result as DataResult<unknown>).data\n    ) as unknown) as DataTypeOfEach<Arr>,\n  };\n}\n\n// Handle missing / data / error cases of a result and return a single value.\nexport function handle<T, E, R>(\n  result: Result<T, E> | undefined,\n  mappers: {\n    onNone: () => R;\n    onData: (data: T) => R;\n    onError: (error: E) => R;\n  }\n): R {\n  if (result === undefined) {\n    return mappers.onNone();\n  } else {\n    if (hasError(result)) {\n      return mappers.onError(result.error);\n    } else {\n      return mappers.onData(result.data);\n    }\n  }\n}\n\n// Same as handle, but for remote result, also passes loading state to the callbacks.\nexport function squash<T, E, R>(\n  remoteResult: RemoteResult<T, E>,\n  mappers: {\n    onNone: (loading: boolean) => R;\n    onData: (data: T, loading: boolean) => R;\n    onError: (error: E, loading: boolean) => R;\n  }\n): R {\n  return handle(remoteResult.result, {\n    onNone: () => mappers.onNone(remoteResult.loading),\n    onData: (data) => mappers.onData(data, remoteResult.loading),\n    onError: (error) => mappers.onError(error, remoteResult.loading),\n  });\n}\n\nexport function squashOrDefaut<T>(\n  remoteResult: RemoteResult<T, unknown>,\n  defaultValue: T\n) {\n  return squash(remoteResult, {\n    onNone: () => defaultValue,\n    onData: (a) => a,\n    onError: () => defaultValue,\n  });\n}\n\n// Set parent[key] to newValue unless exising value is deeply equal.\n// Can be used to set an immer draft property to a nested external object.\nexport function replaceIfChanged<Parent, Key extends keyof Parent>(\n  parent: Parent,\n  key: Key,\n  newValue: Parent[Key]\n): void {\n  const oldValue = isDraft(parent) ? original(parent)![key] : parent[key];\n  if (!deepEquals(oldValue, newValue)) {\n    parent[key] = newValue;\n  }\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport produce from 'immer';\nimport { Action, createReducer } from 'typesafe-actions';\n\nimport { replaceIfChanged } from '../utils';\nimport { fetchError, fetchRequest, fetchSuccess } from './actions';\nimport { ConfigState } from './types';\n\nexport const configReducer = createReducer<ConfigState, Action>({\n  loading: false,\n})\n  .handleAction(fetchRequest, (state) =>\n    produce(state, (draft) => {\n      draft.loading = true;\n    })\n  )\n  .handleAction(fetchSuccess, (state, { payload }) =>\n    produce(state, (draft) => {\n      draft.loading = false;\n      replaceIfChanged(draft, 'result', { data: payload });\n    })\n  )\n  .handleAction(fetchError, (state, { payload }) =>\n    produce(state, (draft) => {\n      draft.loading = false;\n      replaceIfChanged(draft, 'result', { error: payload });\n    })\n  );\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { all, call, delay, put, takeLatest } from 'redux-saga/effects';\nimport { ActionType, getType } from 'typesafe-actions';\n\nimport { fetchError, fetchRequest, fetchSuccess, subscribe } from './actions';\nimport { Config } from './types';\n\nexport async function fetchConfigApi(): Promise<Config> {\n  const res = await fetch('/api/config');\n  if (res.status !== 200) {\n    throw new Error(`HTTP ${res.status}: ${res.statusText}`);\n  }\n  return res.json();\n}\n\nexport function* fetchConfig(_: ActionType<typeof fetchRequest>) {\n  try {\n    const config: Config = yield call(fetchConfigApi);\n    yield put(fetchSuccess(config));\n  } catch (e) {\n    yield put(fetchError({ message: e.message }));\n  }\n}\n\nexport const POLL_COOLDOWN_MS = 5000;\n\n// TODO: Refactor subscription and polling logic into a common util.\nexport function* pollConfig() {\n  while (true) {\n    yield put(fetchRequest());\n    yield delay(POLL_COOLDOWN_MS);\n  }\n}\n\nexport function* configSaga() {\n  yield all([\n    takeLatest(getType(fetchRequest), fetchConfig),\n    takeLatest(getType(subscribe), pollConfig),\n  ]);\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport produce from 'immer';\nimport { Action, createReducer } from 'typesafe-actions';\n\nimport { replaceIfChanged } from '../utils';\nimport {\n  databasesFetchError,\n  databasesFetchRequest,\n  databasesFetchSuccess,\n  databasesSubscribe,\n  databasesUnsubscribe,\n} from './actions';\nimport { DatabaseState } from './types';\n\nexport const databaseReducer = createReducer<DatabaseState, Action>({\n  databases: { loading: false },\n  databasesSubscribed: false,\n})\n  .handleAction(databasesFetchRequest, (state, _) =>\n    produce(state, (draft) => {\n      draft.databases.loading = true;\n    })\n  )\n  .handleAction(databasesFetchSuccess, (state, { payload }) => {\n    const databases = [...payload];\n    databases.sort((db1, db2) => db1.name.localeCompare(db2.name));\n    return produce(state, (draft) => {\n      draft.databases.loading = false;\n      replaceIfChanged(draft.databases, 'result', { data: databases });\n    });\n  })\n  .handleAction(databasesFetchError, (state, { payload }) =>\n    produce(state, (draft) => {\n      draft.databases.loading = false;\n      replaceIfChanged(draft.databases, 'result', { error: payload });\n    })\n  )\n  .handleAction(databasesSubscribe, (state) =>\n    produce(state, (draft) => {\n      draft.databasesSubscribed = true;\n    })\n  )\n  .handleAction(databasesUnsubscribe, (state) =>\n    produce(state, (draft) => {\n      draft.databasesSubscribed = false;\n    })\n  );\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  all,\n  call,\n  delay,\n  put,\n  select,\n  take,\n  takeLatest,\n} from 'redux-saga/effects';\nimport { createSelector } from 'reselect';\nimport { ActionType, getType } from 'typesafe-actions';\n\nimport { DatabaseConfig } from '../config';\nimport {\n  getDatabaseConfigResult,\n  getProjectIdResult,\n} from '../config/selectors';\nimport { combineData, hasError } from '../utils';\nimport {\n  databasesFetchError,\n  databasesFetchRequest,\n  databasesFetchSuccess,\n  databasesSubscribe,\n} from './actions';\nimport { DatabaseInfo } from './types';\nimport { AppState } from '..';\n\nexport async function fetchDatabasesApi(\n  config: DatabaseConfig,\n  projectId: string\n): Promise<DatabaseInfo[]> {\n  const res = await fetch(\n    `http://${config.hostAndPort}/.inspect/databases.json?ns=${projectId}`\n  );\n  if (res.status !== 200) {\n    throw new Error(`HTTP ${res.status}: ${res.statusText}`);\n  }\n  return res.json();\n}\n\nexport interface GetDbConfigReturn {\n  config: DatabaseConfig;\n  projectId: string;\n}\n\nconst getProjectIdAndDbConfig = createSelector(\n  getProjectIdResult,\n  getDatabaseConfigResult,\n  combineData\n);\n\ntype ProjectIdAndDbConfigResult = ReturnType<typeof getProjectIdAndDbConfig>;\n\nexport function* getDbConfig(): Generator<unknown, GetDbConfigReturn> {\n  const result = (yield select(\n    getProjectIdAndDbConfig\n  )) as ProjectIdAndDbConfigResult;\n  if (!result) {\n    throw new Error('Database emulator config is not ready yet.');\n  }\n  if (hasError(result)) {\n    throw new Error(\n      'Error fetching Database emulator config: ' + result.error.message\n    );\n  }\n  const [projectId, config] = result.data;\n  if (!config) {\n    throw new Error('Database emulator is not started!');\n  }\n  return { projectId, config };\n}\n\nexport function* fetchDatabases(\n  _: ActionType<typeof databasesFetchRequest>\n): Generator<any> {\n  try {\n    const { projectId, config } = (yield call(\n      getDbConfig\n    )) as GetDbConfigReturn;\n    const databases = (yield call(\n      fetchDatabasesApi,\n      config,\n      projectId\n    )) as DatabaseInfo[];\n    yield put(databasesFetchSuccess(databases));\n  } catch (e) {\n    yield put(databasesFetchError({ message: e.message }));\n  }\n}\n\nexport const POLL_DATABASE_COOLDOWN_MS = 5000;\nexport const getDatabasesSubscribed = (state: AppState) =>\n  state.database.databasesSubscribed;\n\nexport function* pollDatabases(): Generator<any> {\n  while (true) {\n    yield take(getType(databasesSubscribe));\n    while (yield select(getDatabasesSubscribed)) {\n      yield put(databasesFetchRequest());\n      yield delay(POLL_DATABASE_COOLDOWN_MS);\n    }\n  }\n}\n\nexport function* databaseSaga() {\n  yield all([\n    takeLatest(getType(databasesFetchRequest), fetchDatabases),\n    pollDatabases(),\n  ]);\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Action, createReducer } from 'typesafe-actions';\n\nimport { logReceived, logReset } from './actions';\nimport { LogState } from './types';\n\nexport const logReducer = createReducer<LogState, Action>({\n  history: [],\n})\n  .handleAction(logReceived, (state: LogState, { payload }) => {\n    return { ...state, history: [...state.history, payload] };\n  })\n  .handleAction(logReset, (state: LogState) => {\n    return { ...state, history: [] };\n  });\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"OneAccountPerEmailCard_wrapper__3fZZe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"description\":\"OneAccountPerEmailDialog_description__HG1Vb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"clearAllButton\":\"UsersCard_clearAllButton__23izn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconWrapper\":\"ProviderCell_iconWrapper__2KYaU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ImportDialog_container__3M_uy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"missing\":\"DocumentListItem_missing__2gbCW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sign-in-quota\":\"Auth_sign-in-quota__XoMrq\"};","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\n\nexport interface DocumentCollectionDatabaseApi<U, V> {\n  projectId: string;\n  databaseId: string;\n\n  database: U;\n\n  delete(): Promise<void>;\n\n  getCollections(docRef?: V): Promise<firebase.firestore.CollectionReference[]>;\n}\n\nexport type FirestoreApi = DocumentCollectionDatabaseApi<\n  firebase.firestore.Firestore,\n  firebase.firestore.DocumentReference\n>;\n\n/** Field types supported by Firestore  */\nexport enum FieldType {\n  ARRAY = 'array',\n  BLOB = 'blob',\n  BOOLEAN = 'boolean',\n  GEOPOINT = 'geopoint',\n  JSON = 'json',\n  MAP = 'map',\n  NULL = 'null',\n  NUMBER = 'number',\n  REFERENCE = 'reference',\n  STRING = 'string',\n  TIMESTAMP = 'timestamp',\n}\n\nexport type FirestoreAny = FirestoreMap | FirestoreArray | FirestorePrimitive;\n\nexport type FirestorePrimitive =\n  | string\n  | number\n  | boolean\n  | null\n  | firebase.firestore.DocumentReference\n  | firebase.firestore.GeoPoint\n  | firebase.firestore.Blob\n  | firebase.firestore.Timestamp\n  | firebase.firestore.FieldValue;\n\nexport type FirestoreArray = Array<FirestorePrimitive | FirestoreMap>;\n\nexport type FirestoreMap = {\n  [field: string]: FirestoreAny;\n};\n\n/** Collection filter */\nexport type CollectionFilterSort = 'ascending' | 'descending';\n\ninterface Filter<T extends firebase.firestore.WhereFilterOp | undefined> {\n  field: string;\n  operator: T;\n}\n\ntype ConditionValue = number | boolean | string;\n\ninterface SingleValueCondition {\n  value: ConditionValue;\n}\n\ninterface MultiValueCondition {\n  values: ConditionValue[];\n}\n\ninterface SortableCondition {\n  sort?: 'asc' | 'desc';\n}\n\ntype Unspecified = Filter<undefined> & SortableCondition;\ntype Equal = Filter<'=='> & SingleValueCondition;\ntype NotEqual = Filter<'!='> & SingleValueCondition;\ntype GreaterThan = Filter<'>'> & SingleValueCondition & SortableCondition;\ntype GreaterThanEqual = Filter<'>='> & SingleValueCondition & SortableCondition;\ntype LessThanEqual = Filter<'<='> & SingleValueCondition & SortableCondition;\ntype LessThan = Filter<'<'> & SingleValueCondition & SortableCondition;\ntype In = Filter<'in'> & MultiValueCondition;\ntype NotIn = Filter<'not-in'> & MultiValueCondition;\ntype ArrayContains = Filter<'array-contains'> & SingleValueCondition;\ntype ArrayContainsAny = Filter<'array-contains-any'> & MultiValueCondition;\n\nexport type CollectionFilter =\n  | Unspecified\n  | Equal\n  | NotEqual\n  | GreaterThan\n  | GreaterThanEqual\n  | LessThanEqual\n  | LessThan\n  | In\n  | NotIn\n  | ArrayContains\n  | ArrayContainsAny;\n\nexport function isSingleValueCollectionFilter(\n  cf: CollectionFilter\n): cf is Extract<CollectionFilter, SingleValueCondition> {\n  return (\n    cf.operator === '==' ||\n    cf.operator === '!=' ||\n    cf.operator === '>' ||\n    cf.operator === '>=' ||\n    cf.operator === '<=' ||\n    cf.operator === '<' ||\n    cf.operator === 'array-contains'\n  );\n}\n\nexport function isMultiValueCollectionFilter(\n  cf: CollectionFilter\n): cf is Extract<CollectionFilter, MultiValueCondition> {\n  return (\n    cf.operator === 'in' ||\n    cf.operator === 'not-in' ||\n    cf.operator === 'array-contains-any'\n  );\n}\n\nexport function isSortableCollectionFilter(\n  cf: CollectionFilter\n): cf is Extract<CollectionFilter, SortableCondition> {\n  return (\n    !cf.operator ||\n    cf.operator === '>' ||\n    cf.operator === '>=' ||\n    cf.operator === '<=' ||\n    cf.operator === '<'\n  );\n}\n\nexport interface MissingDocument {\n  path: string;\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport const background = '#F6F7F9';\nexport const primary = '#681DA8'; // Google Purple 900.\nexport const secondary = 'rgba(0, 0, 0, .54)';\n\nexport const grey100 = '#F5F5F5';\n\nexport const navBarPrimary = '#D7AEFB'; // Google Purple 200.\nexport const navBarSurface = '#0c2d48'; // Navy 700\nexport const navBarOnSurface = '#FFF';\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\nimport produce from 'immer';\nimport get from 'lodash.get';\n\nimport {\n  FieldType,\n  FirestoreAny,\n  FirestoreArray,\n  FirestoreMap,\n  FirestorePrimitive,\n} from './models';\n\n/** Firestore supported numbers */\nexport const NUMBER_REGEX = /^-?([\\d]*\\.?\\d+|Infinity|NaN)$/;\n\nexport function getParentPath(path: string[]) {\n  return path.slice(0, path.length - 1);\n}\n\nexport function lastFieldName(path: string[]): string {\n  if (!path.length)\n    throw new Error(`${path} is empty and has no _last_ field name`);\n  return path[path.length - 1];\n}\n\nexport function getFieldType(value: FirestoreAny): FieldType {\n  if (value === null) {\n    return FieldType.NULL;\n  }\n\n  if (value instanceof firebase.firestore.Timestamp) {\n    return FieldType.TIMESTAMP;\n  }\n\n  if (value instanceof Array) {\n    return FieldType.ARRAY;\n  }\n\n  if (value instanceof firebase.firestore.DocumentReference) {\n    return FieldType.REFERENCE;\n  }\n\n  if (value instanceof firebase.firestore.GeoPoint) {\n    return FieldType.GEOPOINT;\n  }\n\n  if (value instanceof firebase.firestore.Blob) {\n    return FieldType.BLOB;\n  }\n\n  if (typeof value === 'object') {\n    return FieldType.MAP;\n  }\n\n  return typeof value as FieldType;\n}\n\nexport function isBoolean(value: FirestoreAny): value is boolean {\n  return typeof value === 'boolean';\n}\n\nexport function isReference(\n  value: FirestoreAny\n): value is firebase.firestore.DocumentReference {\n  return value instanceof firebase.firestore.DocumentReference;\n}\n\nexport function isTimestamp(\n  value: FirestoreAny\n): value is firebase.firestore.Timestamp {\n  return value instanceof firebase.firestore.Timestamp;\n}\n\nexport function isString(value: FirestoreAny): value is string {\n  return typeof value === 'string';\n}\n\nexport function isNumber(value: FirestoreAny): value is number {\n  return typeof value === 'number';\n}\n\nexport function isGeoPoint(\n  value: FirestoreAny\n): value is firebase.firestore.GeoPoint {\n  return value instanceof firebase.firestore.GeoPoint;\n}\n\nexport function isMap(value: any): value is FirestoreMap {\n  return getFieldType(value) === FieldType.MAP;\n}\n\nexport function isArray(value: any): value is FirestoreArray {\n  return getFieldType(value) === FieldType.ARRAY;\n}\n\nexport function isPrimitive(value: any): value is FirestorePrimitive {\n  return !isMap(value) && !isArray(value);\n}\n\n/*\n  Return a copy of base with the field (specified by path) updated to value.\n  This function also works with array elements. base is never modified.\n*/\nexport const withFieldSet = produce((draft, path: string[], value: any) => {\n  const parent = get(draft, getParentPath(path)) || draft;\n  if (isMap(parent)) {\n    parent[lastFieldName(path)] = value;\n  } else if (isArray(parent)) {\n    parent[Number(lastFieldName(path))] = value;\n  } else {\n    return value;\n  }\n});\n\n/*\n  Return a copy of base with the field (specified by path) deleted.\n  This function also works with removing array elements. base is never modified.\n*/\nexport const withFieldRemoved = produce((draft, path: string[]) => {\n  const parent = get(draft, getParentPath(path)) || draft;\n  if (isMap(parent)) {\n    delete parent[lastFieldName(path)];\n  } else if (isArray(parent)) {\n    parent.splice(Number(lastFieldName(path)), 1);\n  }\n});\n\n// Give a brief text summary of the data.\n// Note: maxLen is soft (at least for now). End result may still be longer.\nexport function summarize(data: FirestoreAny, maxLen: number): string {\n  switch (getFieldType(data)) {\n    case FieldType.ARRAY:\n      return summarizeArray(data as FirestoreAny[], maxLen);\n    case FieldType.MAP:\n      return summarizeMap(data as Record<string, FirestoreAny>, maxLen);\n    case FieldType.BLOB:\n      const base64 = (data as firebase.firestore.Blob).toBase64();\n      if (base64.length < maxLen) return base64;\n      else return base64.substr(0, maxLen) + '...';\n    case FieldType.BOOLEAN:\n      return (data as boolean).toString();\n    case FieldType.GEOPOINT:\n      const value = data as firebase.firestore.GeoPoint;\n      return `[${latStr(value.latitude)}, ${longStr(value.longitude)}]`;\n    case FieldType.NULL:\n      return 'null';\n    case FieldType.NUMBER:\n      return (data as number).toString();\n    case FieldType.REFERENCE:\n      return (data as firebase.firestore.DocumentReference).path;\n    case FieldType.STRING:\n      return `\"${data as string}\"`;\n    case FieldType.TIMESTAMP:\n      // TODO: Better date time formatting.\n      // Note: Not using toLocaleString() since it does not stringify timezone.\n      return (data as firebase.firestore.Timestamp).toDate().toString();\n    case FieldType.JSON:\n      throw new Error('JSON field type is input only');\n  }\n}\n\nfunction summarizeArray(array: FirestoreAny[], maxLen: number): string {\n  let output = '[';\n  for (const element of array) {\n    if (output.length > 1) output += ', ';\n    if (output.length > maxLen) {\n      output += '...';\n      break;\n    }\n    output += summarize(element, maxLen - output.length);\n  }\n  output += ']';\n  return output;\n}\n\nfunction summarizeMap(\n  map: Record<string, FirestoreAny>,\n  maxLen: number\n): string {\n  let output = '{';\n  for (const [key, value] of Object.entries(map).sort((a, b) =>\n    compareFirestoreKeys(a[0], b[0])\n  )) {\n    if (output.length > 1) output += ', ';\n    if (output.length > maxLen) {\n      output += '...';\n      break;\n    }\n    output += `${key}: ${summarize(value, maxLen - output.length)}`;\n  }\n  output += '}';\n  return output;\n}\n\nfunction latStr(lat: number): string {\n  return `${Math.abs(lat)}° ${lat >= 0 ? 'N' : 'S'}`;\n}\n\nfunction longStr(long: number): string {\n  return `${Math.abs(long)}° ${long >= 0 ? 'E' : 'W'}`;\n}\n\nexport function compareFirestoreKeys(fieldA: string, fieldB: string): number {\n  // TODO: Use UTF-8 encoded byte order instead of localCompare to match Firestore production behavior https://firebase.google.com/docs/firestore/manage-data/data-types\n  return fieldA.localeCompare(fieldB);\n}\n","import {\n  FirestoreAny,\n  FirestoreArray,\n  FirestoreMap,\n  FirestorePrimitive,\n} from '../models';\nimport { isPrimitive as isNativePrimitive } from '../utils';\n\nexport class DocumentPath {\n  constructor(readonly path: string) {}\n}\n\nexport type MapChildren = Array<{\n  readonly uuid: number;\n  name: string;\n  valueId: number;\n}>;\nexport interface MapField {\n  mapChildren: MapChildren;\n}\n\nexport type ArrayChildren = Array<{ readonly uuid: number; valueId: number }>;\nexport interface ArrayField {\n  arrayChildren: ArrayChildren;\n}\n\nexport interface JSONField {\n  isJson: boolean;\n  value: FirestoreAny;\n}\n\nexport type PrimitiveValue = FirestorePrimitive | DocumentPath;\nexport interface PrimitiveField {\n  value: PrimitiveValue;\n}\n\nexport type Field = MapField | ArrayField | JSONField | PrimitiveField;\nexport type Fields = {\n  [uuid: number]: Field;\n};\nexport type Store = {\n  uuid?: number;\n  fields: Fields;\n};\n\nexport function isPrimitive(\n  data: FirestoreAny | DocumentPath\n): data is PrimitiveValue {\n  return isNativePrimitive(data) || data instanceof DocumentPath;\n}\n\nexport function isFirestoreMap(data: FirestoreAny): data is FirestoreMap {\n  return !isFirestoreArray(data) && !isPrimitive(data);\n}\n\nexport function isFirestoreArray(data: FirestoreAny): data is FirestoreArray {\n  return data instanceof Array;\n}\n\nexport function isMapField(field: Field): field is MapField {\n  return 'mapChildren' in field;\n}\n\nexport function isArrayField(field: Field): field is ArrayField {\n  return 'arrayChildren' in field;\n}\n\nexport function isJSONField(field: Field): field is JSONField {\n  return 'isJson' in field;\n}\n\nexport function assertStoreHasRoot(\n  store: Store\n): asserts store is Store & { uuid: number } {\n  if (store.uuid === undefined) {\n    throw new Error('Store has no root');\n  }\n}\n\nexport function assertIsPrimitiveField(\n  field: Field\n): asserts field is PrimitiveField {\n  if (!('value' in field)) {\n    throw new Error('Field is not primitive');\n  }\n}\n\nexport function assertIsMapField(field: Field): asserts field is MapField {\n  if (!isMapField(field)) {\n    throw new Error('Field is not a map');\n  }\n}\n\nexport function assertIsArrayField(field: Field): asserts field is ArrayField {\n  if (!isArrayField(field)) {\n    throw new Error('Field is not an array');\n  }\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\n\nimport {\n  FieldType,\n  FirestoreAny,\n  FirestoreArray,\n  FirestoreMap,\n  FirestorePrimitive,\n} from '../models';\nimport {\n  ArrayChildren,\n  DocumentPath,\n  Fields,\n  MapChildren,\n  PrimitiveValue,\n  Store,\n  assertStoreHasRoot,\n  isArrayField,\n  isFirestoreArray,\n  isFirestoreMap,\n  isMapField,\n} from './types';\n\nlet uuid = 0;\nexport function getUniqueId() {\n  return uuid++;\n}\n\nfunction normalizeMap(data: FirestoreMap): Store {\n  const uuid = getUniqueId();\n\n  // reducer over object.entries -> childFields\n  const children = Object.entries(data).reduce(\n    (\n      { mapChildren, fields }: { mapChildren: MapChildren; fields: Fields },\n      [name, value]: [string, FirestoreAny]\n    ) => {\n      const child = normalize(value);\n      assertStoreHasRoot(child);\n      mapChildren.push({\n        uuid: getUniqueId(),\n        name,\n        valueId: child.uuid,\n      });\n      return { mapChildren, fields: { ...fields, ...child.fields } };\n    },\n    { mapChildren: [], fields: {} }\n  );\n  return {\n    uuid,\n    fields: {\n      ...children.fields,\n      // add item for current node\n      [uuid]: { mapChildren: children.mapChildren },\n    },\n  };\n}\n\nfunction normalizeArray(data: FirestoreArray): Store {\n  const uuid = getUniqueId();\n\n  // reducer over array elements -> childFields\n  const children = data.reduce(\n    (\n      {\n        arrayChildren,\n        fields,\n      }: { arrayChildren: ArrayChildren; fields: Fields },\n      value: FirestoreMap | FirestorePrimitive\n    ) => {\n      const child = normalize(value);\n      assertStoreHasRoot(child);\n      arrayChildren.push({\n        uuid: getUniqueId(),\n        valueId: child.uuid,\n      });\n      return { arrayChildren, fields: { ...fields, ...child.fields } };\n    },\n    { arrayChildren: [], fields: {} }\n  );\n  return {\n    uuid,\n    fields: {\n      ...children.fields,\n      // add item for current node\n      [uuid]: { arrayChildren: children.arrayChildren },\n    },\n  };\n}\n\nfunction normalizePrimitive(data: FirestorePrimitive): Store {\n  const uuid = getUniqueId();\n\n  if (data instanceof firebase.firestore.DocumentReference) {\n    return {\n      uuid,\n      fields: { [uuid]: { value: new DocumentPath(data.path) } },\n    };\n  }\n  return { uuid, fields: { [uuid]: { value: data } } };\n}\n\nexport function normalize(data: FirestoreAny): Store {\n  if (isFirestoreMap(data)) {\n    return normalizeMap(data);\n  } else if (isFirestoreArray(data)) {\n    return normalizeArray(data);\n  } else {\n    return normalizePrimitive(data);\n  }\n}\n\nexport function denormalize(\n  store: Store,\n  firestore?: firebase.firestore.Firestore\n): FirestoreAny {\n  assertStoreHasRoot(store);\n  const field = store.fields[store.uuid];\n  if (isMapField(field)) {\n    return field.mapChildren.reduce((acc, curr) => {\n      acc[curr.name] = denormalize(\n        {\n          uuid: curr.valueId,\n          fields: store.fields,\n        },\n        firestore\n      );\n      return acc;\n    }, {} as any);\n  } else if (isArrayField(field)) {\n    return field.arrayChildren.reduce((acc, curr) => {\n      acc.push(\n        denormalize({ uuid: curr.valueId, fields: store.fields }, firestore)\n      );\n      return acc;\n    }, [] as any);\n  } else {\n    if (field.value instanceof DocumentPath) {\n      if (!firestore) {\n        // TODO: Trying to reference a Firestore Document without a Firestore instance.\n        return '';\n      }\n      try {\n        return firestore.doc(field.value.path);\n      } catch {\n        // TODO: The store does not always have a valid DocRef, reconsider.\n        return '';\n      }\n    }\n    return field.value;\n  }\n}\n\nexport function defaultValueForPrimitiveType(type: FieldType): PrimitiveValue {\n  switch (type) {\n    case FieldType.BLOB:\n      // TODO\n      return '';\n    case FieldType.BOOLEAN:\n      return true;\n    case FieldType.GEOPOINT:\n      return new firebase.firestore.GeoPoint(0, 0);\n    case FieldType.NULL:\n      return null;\n    case FieldType.NUMBER:\n      return 0;\n    case FieldType.REFERENCE:\n      return new DocumentPath('');\n    case FieldType.STRING:\n      return '';\n    case FieldType.TIMESTAMP:\n      return firebase.firestore.Timestamp.fromDate(new Date());\n  }\n  return '';\n}\n\nexport function getDescendantIds(fields: Fields, ids: number[]): number[] {\n  return ids.reduce((acc, id) => {\n    acc.push(id);\n    const field = fields[id];\n    if (isMapField(field)) {\n      acc.push(\n        ...getDescendantIds(\n          fields,\n          field.mapChildren.map((c) => c.valueId)\n        )\n      );\n    } else if (isArrayField(field)) {\n      acc.push(\n        ...getDescendantIds(\n          fields,\n          field.arrayChildren.map((c) => c.valueId)\n        )\n      );\n    }\n    return acc;\n  }, [] as number[]);\n}\n","import { createAction } from 'typesafe-actions';\n\nimport { AddAuthUserPayload, AuthUser } from '../../components/Auth/types';\nimport { RemoteResult } from '../utils';\n\nexport const createUserRequest = createAction('@auth/CREATE_USER_REQUEST')<{\n  user: AddAuthUserPayload;\n  keepDialogOpen?: boolean;\n}>();\n\nexport const createUserSuccess = createAction('@auth/CREATE_USER_SUCCESS')<{\n  user: AuthUser;\n}>();\n\nexport const updateUserRequest = createAction('@auth/UPDATE_USER_REQUEST')<{\n  user: AddAuthUserPayload;\n  localId: string;\n}>();\n\nexport const updateUserSuccess = createAction('@auth/UPDATE_USER_SUCCESS')<{\n  user: AuthUser;\n}>();\n\nexport const setUserDisabledRequest = createAction(\n  '@auth/SET_USER_DISABLED_REQUEST'\n)<{\n  localId: string;\n  disabled: boolean;\n}>();\n\nexport const setUserDisabledSuccess = createAction(\n  '@auth/SET_USER_DISABLED_SUCCESS'\n)<{\n  localId: string;\n  disabled: boolean;\n}>();\n\nexport const deleteUserRequest = createAction('@auth/DELETE_USER_REQUEST')<{\n  localId: string;\n}>();\n\nexport const deleteUserSuccess = createAction('@auth/DELETE_USER_SUCCESS')<{\n  localId: string;\n}>();\n\nexport const updateFilter = createAction('@auth/UPDATE_FILTER')<{\n  filter: string;\n}>();\n\nexport const nukeUsersRequest = createAction('@auth/NUKE_USERS_REQUEST')();\n\nexport const nukeUsersSuccess = createAction('@auth/NUKE_USERS_SUCCESS')();\n\nexport const authFetchUsersRequest = createAction(\n  '@auth/AUTH_FETCH_USERS_REQUEST'\n)();\n\nexport const authFetchUsersSuccess = createAction(\n  '@auth/AUTH_FETCH_USERS_SUCCESS'\n)<AuthUser[]>();\n\nexport const authFetchUsersError = createAction(\n  '@auth/AUTH_FETCH_USERS_ERROR'\n)<{ message: string }>();\n\nexport const setAllowDuplicateEmailsRequest = createAction(\n  '@auth/SET_ALLOW_DUPLICATE_EMAILS_REQUEST'\n)<boolean>();\n\nexport const setAllowDuplicateEmailsSuccess = createAction(\n  '@auth/SET_ALLOW_DUPLICATE_EMAILS_SUCCESS'\n)<boolean>();\n\nexport const getAllowDuplicateEmailsRequest = createAction(\n  '@auth/GET_ALLOW_DUPLICATE_EMAILS_REQUEST'\n)();\n\nexport const getAllowDuplicateEmailsSuccess = createAction(\n  '@auth/GET_ALLOW_DUPLICATE_EMAILS_SUCCESS'\n)<boolean>();\n\nexport const openAuthUserDialog = createAction(\n  '@auth/SET_AUTH_USER_DIALOG_DATA'\n)<RemoteResult<AuthUser | undefined>>();\n\nexport const setAuthUserDialogLoading = createAction(\n  '@auth/SET_AUTH_USER_DIALOG_DATA_LOADING'\n)<boolean>();\n\nexport const setAuthUserDialogError = createAction(\n  '@auth/SET_AUTH_USER_DIALOG_DATA_ERRORS'\n)<string | undefined>();\n\nexport const clearAuthUserDialogData = createAction(\n  '@auth/CLEAR_AUTH_USER_DIALOG_DATA'\n)();\n","import produce from 'immer';\nimport { Action, createReducer } from 'typesafe-actions';\n\nimport { AuthState, AuthUser } from '../../components/Auth/types';\nimport { getUniqueId } from '../../components/Firestore/DocumentEditor/utils';\nimport { mapResult } from '../utils';\nimport * as authActions from './actions';\n\nconst INIT_STATE = {\n  users: { loading: true },\n  filter: '',\n  allowDuplicateEmails: false,\n};\n\nexport const authReducer = createReducer<AuthState, Action>(INIT_STATE)\n  .handleAction(\n    authActions.createUserSuccess,\n    produce((draft, { payload }) => {\n      draft.users = mapResult(draft.users, (users: AuthUser[]) => [\n        ...users,\n        {\n          createdAt: new Date().getTime().toString(),\n          lastLoginAt: new Date().getTime().toString(),\n          localId: getUniqueId().toString(),\n          disabled: false,\n          ...payload.user,\n        },\n      ]);\n    })\n  )\n  .handleAction(\n    authActions.updateUserSuccess,\n    produce((draft: AuthState, { payload }) => {\n      draft.users = mapResult(draft.users, (users) =>\n        users.map((user: AuthUser) => {\n          return user.localId === payload.user.localId\n            ? { ...user, ...payload.user }\n            : user;\n        })\n      );\n    })\n  )\n  .handleAction(\n    authActions.nukeUsersSuccess,\n    produce((draft) => {\n      draft.users = mapResult(draft.users, () => []);\n    })\n  )\n  .handleAction(\n    authActions.setAllowDuplicateEmailsSuccess,\n    produce((draft, { payload }) => {\n      draft.allowDuplicateEmails = payload;\n    })\n  )\n  .handleAction(\n    authActions.setUserDisabledSuccess,\n    produce((draft, { payload }) => {\n      draft.users = mapResult(draft.users, (users: AuthUser[]) => {\n        return users.map((u: AuthUser) =>\n          u.localId === payload.localId\n            ? { ...u, disabled: payload.disabled }\n            : u\n        );\n      });\n    })\n  )\n  .handleAction(\n    authActions.deleteUserSuccess,\n    produce((draft, { payload }) => {\n      draft.users = mapResult(draft.users, (users: AuthUser[]) =>\n        users.filter((u: AuthUser) => u.localId !== payload.localId)\n      );\n    })\n  )\n  .handleAction(\n    authActions.updateFilter,\n    produce((draft, { payload: { filter } }) => {\n      draft.filter = filter;\n    })\n  )\n  .handleAction(\n    authActions.openAuthUserDialog,\n    produce((draft, { payload: authUserDialogData }) => {\n      draft.authUserDialogData = authUserDialogData;\n    })\n  )\n  .handleAction(\n    authActions.setAuthUserDialogLoading,\n    produce((draft, { payload: loading }) => {\n      if (draft.authUserDialogData) {\n        draft.authUserDialogData.loading = loading;\n      }\n    })\n  )\n  .handleAction(\n    authActions.setAuthUserDialogError,\n    produce((draft, { payload: error }) => {\n      if (draft.authUserDialogData && draft.authUserDialogData.result) {\n        draft.authUserDialogData.result.error = error;\n      }\n    })\n  )\n  .handleAction(\n    authActions.clearAuthUserDialogData,\n    produce((draft) => {\n      draft.authUserDialogData = undefined;\n    })\n  )\n  .handleAction(\n    authActions.authFetchUsersSuccess,\n    produce((draft: AuthState, { payload }) => {\n      draft.users = {\n        loading: false,\n        result: { data: payload },\n      };\n    })\n  )\n  .handleAction(\n    authActions.authFetchUsersError,\n    produce((draft: AuthState, { payload }) => {\n      draft.users = {\n        loading: false,\n        result: { error: payload },\n      };\n    })\n  );\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ntype RequestMethod = 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\n\nexport class ResponseError extends Error {\n  constructor(\n    message: string,\n    readonly response: Response,\n    readonly json?: {}\n  ) {\n    super(message);\n  }\n}\n\n/** Simple REST api helpers */\nexport abstract class RestApi {\n  protected getToken() {\n    return { accessToken: 'owner' };\n  }\n\n  protected async jsonRequest(\n    url: string,\n    data: {},\n    method: RequestMethod = 'GET',\n    headers: Record<string, string> = { 'Content-Type': 'application/json' }\n  ) {\n    const { accessToken } = this.getToken();\n\n    const res = await fetch(url, {\n      method,\n      body: JSON.stringify(data),\n      headers: {\n        Authorization: 'Bearer ' + accessToken,\n        ...headers,\n      },\n    });\n\n    const json = await res.json();\n\n    if (res.status >= 400 && res.status < 600) {\n      throw new ResponseError(json.error.message, res, json);\n    }\n\n    return { res, json };\n  }\n\n  protected async deleteRequest(url: string) {\n    const { accessToken } = this.getToken();\n\n    const res = await fetch(url, {\n      method: 'DELETE',\n      headers: {\n        Authorization: 'Bearer ' + accessToken,\n      },\n    });\n\n    const json = await res.json();\n\n    if (res.status >= 400 && res.status < 600) {\n      throw new ResponseError(json.error.message, res, json);\n    }\n\n    return { res, json };\n  }\n\n  protected async patchRequest(url: string, data: {}) {\n    return this.jsonRequest(url, data, 'PATCH');\n  }\n\n  /** Upload a file with multipart/form-data */\n  protected async postFile(\n    url: string,\n    file: File,\n    method: RequestMethod = 'POST'\n  ) {\n    const body = toFormData(file);\n\n    const { accessToken } = this.getToken();\n    body.append('auth', accessToken);\n\n    // We cannot set the Content-Type header here, since that will\n    // break multipart/form-data payload.\n    // Furthermore, setting non-simple headers may cause a CORS pre-flight\n    // request. RTDB Emulator, for one, doesn't handle those correctly.\n    // See: https://fetch.spec.whatwg.org/#simple-header\n    const res = await fetch(url, { method, body });\n\n    const text = await res.text();\n\n    if (res.status >= 400 && res.status < 600) {\n      throw new ResponseError(text, res);\n    }\n\n    return { res, text };\n  }\n}\n\n/** build `multipart/form-data` payload */\nfunction toFormData(file: File) {\n  const formData = new FormData();\n  formData.append('upload', file);\n  return formData;\n}\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RestApi } from '../common/rest_api';\nimport { AddAuthUserPayload, AuthUser } from './types';\n\nconst importUser = (user: AuthUser & ApiAuthUserFields) => {\n  const match = user.passwordHash?.match(PASSWORD_HASH_REGEX);\n\n  return {\n    password: match ? match[1] : '',\n    ...user,\n    providerUserInfo: user.providerUserInfo || [],\n  };\n};\n\nexport interface ApiAuthUserFields {\n  passwordHash: string;\n}\n\nexport default class AuthApi extends RestApi {\n  // Note: Always use API paths that contain `projectId` for consistency.\n  // Unprefixed versions (e.g. /v1/accounts:signUp) are intended for non-admin\n  // clients and infers projectId, which can lead to unexpected mismatches.\n\n  // https://cloud.google.com/identity-platform/docs/reference/rest/v1/projects.accounts\n  private readonly baseUrl = `http://${this.hostAndPort}/identitytoolkit.googleapis.com/v1/projects/${this.projectId}`;\n  private readonly baseEmulatorUrl = `http://${this.hostAndPort}/emulator/v1/projects/${this.projectId}`;\n\n  constructor(\n    private readonly hostAndPort: string,\n    private readonly projectId: string\n  ) {\n    super();\n  }\n\n  async nukeUsers() {\n    await this.deleteRequest(`${this.baseEmulatorUrl}/accounts`);\n    return [];\n  }\n\n  async fetchUsers(): Promise<AuthUser[]> {\n    const { json } = await this.jsonRequest(\n      `${this.baseUrl}/accounts:query`,\n      {},\n      'POST'\n    );\n\n    return json.userInfo.map(importUser);\n  }\n\n  async fetchUser(localId: string): Promise<AuthUser> {\n    const { json } = await this.jsonRequest(\n      `${this.baseUrl}/accounts:lookup`,\n      { localId: [localId] },\n      'POST'\n    );\n\n    if (!json.users || !json.users.length) {\n      throw new Error(\n        `User \"${localId}\" not found in Project \"${this.projectId}\"!`\n      );\n    }\n    return importUser(json.users[0]);\n  }\n\n  async createUser(user: AddAuthUserPayload): Promise<AuthUser> {\n    const { json } = await this.jsonRequest(\n      `${this.baseUrl}/accounts`,\n      { ...user },\n      'POST'\n    );\n\n    return this.fetchUser(json.localId);\n  }\n\n  async updateConfig(\n    allowDuplicateEmails: boolean\n  ): Promise<{ signIn: { allowDuplicateEmails: boolean } }> {\n    const { json } = await this.patchRequest(`${this.baseEmulatorUrl}/config`, {\n      signIn: { allowDuplicateEmails },\n    });\n\n    return json;\n  }\n\n  async getConfig(): Promise<AuthUser> {\n    const { signIn } = await (\n      await fetch(`${this.baseEmulatorUrl}/config`)\n    ).json();\n\n    return signIn.allowDuplicateEmails;\n  }\n\n  async updateUser(user: AddAuthUserPayload): Promise<AuthUser> {\n    const { json } = await this.jsonRequest(\n      `${this.baseUrl}/accounts:update`,\n      user,\n      'POST'\n    );\n\n    return this.fetchUser(json.localId);\n  }\n\n  async deleteUser(user: AuthUser): Promise<void> {\n    await this.jsonRequest(`${this.baseUrl}/accounts:delete`, user, 'POST');\n  }\n}\n\nconst PASSWORD_HASH_REGEX = /^fakeHash:salt=[\\w\\d]+:password=(.*)$/;\n","import { createSelector } from 'reselect';\n\nimport { AuthState, AuthUser } from '../../components/Auth/types';\nimport { getConfigResult } from '../config/selectors';\nimport { AppState } from '../index';\nimport { hasData, map, squashOrDefaut } from '../utils';\n\nexport const getAuth = (state: AppState) => state.auth;\n\nexport const getAuthUsers = createSelector(getAuth, (state: AuthState) => {\n  return state.users;\n});\n\nexport const getAuthUserDialog = createSelector(getAuth, (state: AuthState) => {\n  return state.authUserDialogData;\n});\n\nexport const getCurrentEditedUser = createSelector(\n  getAuthUserDialog,\n  (authUserDialogData) => {\n    return authUserDialogData && hasData(authUserDialogData.result)\n      ? authUserDialogData.result.data\n      : undefined;\n  }\n);\n\nexport const isEditingUser = createSelector(getCurrentEditedUser, (user) => {\n  return !!user;\n});\n\nexport const getAuthUsersResult = createSelector(getAuthUsers, (users) => {\n  return users.result;\n});\n\nexport const getUsers = createSelector(getAuthUsers, (users) => {\n  return [...squashOrDefaut(users, [])].sort(\n    (a, b) => Number(new Date(b.createdAt)) - Number(new Date(a.createdAt || 0))\n  );\n});\n\nexport const getAllEmails = createSelector(getUsers, (users) => {\n  return new Set(users.map((u) => u.email).filter((e) => !!e));\n});\n\nexport const getAllPhoneNumbers = createSelector(getUsers, (users) => {\n  return new Set(users.map((u) => u.phoneNumber).filter((e) => !!e));\n});\n\nexport const hasUsers = createSelector(\n  getUsers,\n  (users: unknown[]) => users.length > 0\n);\n\nexport const getFilter = createSelector(\n  getAuth,\n  (state: AuthState) => state.filter\n);\n\nexport const getAllowDuplicateEmails = createSelector(\n  getAuth,\n  (state: AuthState) => state.allowDuplicateEmails\n);\n\nexport const getFilteredUsers = createSelector(\n  getUsers,\n  getFilter,\n  (users: AuthUser[], filter: string) => {\n    if (!filter) {\n      return users;\n    }\n    return users.filter((u) => {\n      return [u.localId, u.displayName, u.email || '', u.phoneNumber || '']\n        .join('\\n')\n        .toLocaleUpperCase()\n        .includes(filter.toLocaleUpperCase());\n    });\n  }\n);\nexport const getShowZeroState = createSelector(\n  getUsers,\n  (users) => users.length === 0\n);\nexport const getShowZeroResults = createSelector(\n  getUsers,\n  getFilteredUsers,\n  (users, filteredUsers) => users.length > 0 && filteredUsers.length === 0\n);\nexport const getShowTable = createSelector(\n  getUsers,\n  getFilteredUsers,\n  (users, filteredUsers) => filteredUsers.length > 0\n);\n\nexport const getAuthConfigResult = createSelector(getConfigResult, (result) =>\n  map(result, (config) => config.auth)\n);\n","import { all, call, put, select, take, takeLatest } from 'redux-saga/effects';\nimport { getType } from 'typesafe-actions';\n\nimport AuthApi from '../../components/Auth/api';\nimport { AuthUser } from '../../components/Auth/types';\nimport { fetchSuccess } from '../config';\nimport { getProjectIdResult } from '../config/selectors';\nimport {\n  authFetchUsersError,\n  authFetchUsersRequest,\n  authFetchUsersSuccess,\n  clearAuthUserDialogData,\n  createUserRequest,\n  createUserSuccess,\n  deleteUserRequest,\n  deleteUserSuccess,\n  getAllowDuplicateEmailsRequest,\n  nukeUsersRequest,\n  nukeUsersSuccess,\n  setAllowDuplicateEmailsRequest,\n  setAllowDuplicateEmailsSuccess,\n  setAuthUserDialogError,\n  setAuthUserDialogLoading,\n  setUserDisabledRequest,\n  setUserDisabledSuccess,\n  updateUserRequest,\n  updateUserSuccess,\n} from './actions';\nimport { getAuthConfigResult } from './selectors';\n\nexport function* fetchAuthUsers() {\n  const authApi = yield call(configureAuthSaga);\n  try {\n    const users = yield call([authApi, 'fetchUsers']);\n    yield put(authFetchUsersSuccess(users));\n  } catch (e) {\n    yield put(authFetchUsersError({ message: 'Error when fetching users' }));\n  }\n}\n\nexport function* initAuth() {\n  const result = yield select(getAuthConfigResult);\n  if (result.data) {\n    yield put(authFetchUsersRequest());\n    yield put(getAllowDuplicateEmailsRequest());\n  }\n}\n\nexport function* deleteUser({ payload }: ReturnType<typeof deleteUserRequest>) {\n  const authApi = yield call(configureAuthSaga);\n  yield call([authApi, 'deleteUser'], { localId: payload.localId });\n  yield put(deleteUserSuccess({ localId: payload.localId }));\n}\n\nexport function* createUser({ payload }: ReturnType<typeof createUserRequest>) {\n  const authApi = yield call(configureAuthSaga);\n\n  try {\n    yield put(setAuthUserDialogLoading(true));\n\n    const newUser: AuthUser = yield call([authApi, 'createUser'], payload.user);\n\n    const user = {\n      ...newUser,\n      ...payload.user,\n    };\n\n    if (payload.user.customAttributes) {\n      yield call([authApi, 'updateUser'], user);\n    }\n\n    yield put(\n      createUserSuccess({\n        user: newUser,\n      })\n    );\n\n    if (!payload.keepDialogOpen) {\n      yield put(clearAuthUserDialogData());\n    }\n  } catch (e) {\n    yield put(setAuthUserDialogError(e.message));\n  } finally {\n    yield put(setAuthUserDialogLoading(false));\n  }\n}\n\nexport function* updateUser({ payload }: ReturnType<typeof updateUserRequest>) {\n  const authApi = yield call(configureAuthSaga);\n  try {\n    yield put(setAuthUserDialogLoading(true));\n    const user: AuthUser = yield call([authApi, 'updateUser'], {\n      ...payload.user,\n      localId: payload.localId,\n    });\n    yield put(updateUserSuccess({ user: { ...user, ...payload.user } }));\n    yield put(clearAuthUserDialogData());\n  } catch (e) {\n    yield put(setAuthUserDialogError(e.message));\n  } finally {\n    yield put(setAuthUserDialogLoading(false));\n  }\n}\n\nexport function* setUserDisabled({\n  payload,\n}: ReturnType<typeof setUserDisabledRequest>) {\n  const authApi = yield call(configureAuthSaga);\n  yield call([authApi, 'updateUser'], {\n    disableUser: payload.disabled,\n    localId: payload.localId,\n  });\n  yield put(setUserDisabledSuccess(payload));\n}\n\nexport function* setAllowDuplicateEmails({\n  payload,\n}: ReturnType<typeof setAllowDuplicateEmailsRequest>) {\n  const authApi = yield call(configureAuthSaga);\n  yield call([authApi, 'updateConfig'], payload);\n  yield put(setAllowDuplicateEmailsSuccess(payload));\n}\n\nexport function* getAllowDuplicateEmails() {\n  const authApi = yield call(configureAuthSaga);\n  const config = yield call([authApi, 'getConfig']);\n  yield put(setAllowDuplicateEmailsSuccess(config));\n}\n\nexport function* nukeUsers() {\n  const authApi = yield call(configureAuthSaga);\n  yield call([authApi, 'nukeUsers']);\n  yield put(nukeUsersSuccess());\n}\n\nexport function* configureAuthSaga() {\n  const result = yield select(getAuthConfigResult);\n\n  const { data: projectId } = yield select(getProjectIdResult);\n\n  return new AuthApi(result.data.hostAndPort, projectId);\n}\n\nexport function* authSaga() {\n  yield take(fetchSuccess);\n\n  yield all([\n    takeLatest(getType(authFetchUsersRequest), fetchAuthUsers),\n    takeLatest(getType(createUserRequest), createUser),\n    takeLatest(getType(nukeUsersRequest), nukeUsers),\n    takeLatest(getType(deleteUserRequest), deleteUser),\n    takeLatest(getType(updateUserRequest), updateUser),\n    takeLatest(getType(setUserDisabledRequest), setUserDisabled),\n    takeLatest(\n      getType(setAllowDuplicateEmailsRequest),\n      setAllowDuplicateEmails\n    ),\n    takeLatest(\n      getType(getAllowDuplicateEmailsRequest),\n      getAllowDuplicateEmails\n    ),\n    call(initAuth),\n  ]);\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { combineReducers } from 'redux';\nimport { all, fork } from 'redux-saga/effects';\nimport * as reselect from 'reselect';\n\nimport { AuthState } from '../components/Auth/types';\nimport { authReducer } from './auth/reducer';\nimport { authSaga } from './auth/sagas';\nimport { ConfigState, configReducer, configSaga } from './config';\nimport { DatabaseState, databaseReducer, databaseSaga } from './database';\nimport { LogState, logReducer } from './logviewer';\n\nexport interface AppState {\n  config: ConfigState;\n  database: DatabaseState;\n  auth: AuthState;\n  log: LogState;\n}\n\nexport function* rootSaga() {\n  yield all([fork(configSaga), fork(databaseSaga), fork(authSaga)]);\n}\n\nexport const rootReducer = combineReducers<AppState>({\n  config: configReducer,\n  database: databaseReducer,\n  auth: authReducer,\n  log: logReducer,\n});\n\nexport function createStructuredSelector<T>(\n  selectors: { [K in keyof T]: reselect.Selector<AppState, T[K]> }\n) {\n  return reselect.createStructuredSelector<AppState, T>(selectors);\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Icon, IconProps } from '@rmwc/icon';\nimport { ComponentProps } from '@rmwc/types';\nimport React from 'react';\n\n// Firebase products from https://firebase.google.com/brand-guidelines?hl=en\n// To adapt those icons and make them work nicely, follow steps below:\n// 1. Copy and paste full SVG source code (including the <svg> element).\n//    Prefer files with suffix \"(7- Raw Icon, Dark).svg\".\n// 2. Remove width and height from <svg> and add viewBox=\"0 0 192 192\" to make\n//    the icon resizable. (Replace 192 with actual width and height values.)\n// 3. Change fill=\"#000\" etc. to fill=\"currentColor\" everywhere for theming.\n// 4. Change kabab-case-attrs to snakeCaseAttrs to keep React happy.\n\nexport const FirestoreIcon = svgIcon(\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 192 192\">\n    <g fill=\"none\">\n      <path d=\"M0 0h192v192H0z\" />\n      <path\n        d=\"M96 104l-72 32v-32l72-32 72 32v28-6 10zm0-88l72 32v32L96 48 24 80V48zm27 116l36 16-63 28v-32z\"\n        fill=\"currentColor\"\n        fillRule=\"evenodd\"\n      />\n    </g>\n  </svg>\n);\n\nexport const AuthIcon = svgIcon(\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n    <path\n      d=\"M10.8 7.79999C10.8 9.45684 9.45681 10.8 7.79995 10.8C6.1431 10.8 4.79995 9.45684 4.79995 7.79999C4.79995\n      6.14313 6.1431 4.79999 7.79995 4.79999C9.45681 4.79999 10.8 6.14313 10.8 7.79999ZM1.19995\n      16.68V19.2H14.4V16.68C14.4 14.2745 11.445 13.2 7.79995 13.2C4.15487 13.2 1.19995\n      14.2745 1.19995 16.68ZM16.2 10.8C17.8568 10.8 19.2 9.45684 19.2 7.79999C19.2 6.14313 17.8568 4.79999 16.2\n      4.79999C14.5431 4.79999 13.2 6.14313 13.2 7.79999C13.2 9.45684 14.5431 10.8 16.2 10.8ZM22.8 19.2H15.6V16.68C15.6\n      15.25 14.9331 14.1526 13.7752 13.3811C14.5258 13.2593 15.3439 13.2 16.2 13.2C19.845 13.2 22.8 14.2745 22.8\n      16.68V19.2Z\"\n      fill=\"currentColor\"\n      fillRule=\"evenodd\"\n    />\n  </svg>\n);\n\nexport const DatabaseIcon = svgIcon(\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 192 192\">\n    <g fill=\"none\">\n      <path d=\"M0 0h192v192H0z\" />\n      <path\n        d=\"M24 120h144v32.016c0 8.832-7.144 15.984-15.96 15.984H39.96C31.144 168 24 160.816 24 152.016zm0-80.064C24 31.136 31.144 24 39.96 24h112.08c8.816 0 15.96 7.2 15.96 15.936v56.128c0 8.8-7.144 15.936-15.96 15.936H39.96C31.144 112 24 104.8 24 96.064zM40 40h112v24H40zm0 44.04C40 81.8 41.712 80 44.04 80h7.92C54.2 80 56 81.712 56 84.04v7.92C56 94.2 54.288 96 51.96 96h-7.92C41.8 96 40 94.288 40 91.96zm0 56c0-2.24 1.712-4.04 4.04-4.04h7.92c2.24 0 4.04 1.712 4.04 4.04v7.92c0 2.24-1.712 4.04-4.04 4.04h-7.92c-2.24 0-4.04-1.712-4.04-4.04z\"\n        fill=\"currentColor\"\n        fillRule=\"evenodd\"\n      />\n    </g>\n  </svg>\n);\n\nexport const FunctionsIcon = svgIcon(\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 192 192\">\n    <g fill=\"none\">\n      <path d=\"M0 0h192v192H0z\" />\n      <path\n        d=\"M160.056 134.048v-76.08l-26.944-26.944 16.952-16.96L184 48v86.16l-.056.032v9.832l-33.904 33.912L133.112 161zm-128.112-.024l26.944 26.952-16.952 16.96L8 144V57.84l.056-.032v-9.832L41.96 14.064 58.888 31 31.944 57.952v76.08zm28.064-26c-6.647 0-12.036-5.389-12.036-12.036 0-6.647 5.389-12.036 12.036-12.036 6.645 0 12.032 5.387 12.032 12.032 0 6.645-5.387 12.032-12.032 12.032zm35.984 0c-6.647 0-12.036-5.389-12.036-12.036 0-6.647 5.389-12.036 12.036-12.036 6.645 0 12.032 5.387 12.032 12.032 0 6.645-5.387 12.032-12.032 12.032zm35.984 0c-6.647 0-12.036-5.389-12.036-12.036 0-6.647 5.389-12.036 12.036-12.036 6.645 0 12.032 5.387 12.032 12.032 0 6.645-5.387 12.032-12.032 12.032z\"\n        fill=\"currentColor\"\n        fillRule=\"evenodd\"\n      />\n    </g>\n  </svg>\n);\n\nexport const HostingIcon = svgIcon(\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 192 192\">\n    <path\n      d=\"M96 16c-44.16 0-80 35.84-80 80s35.84 80 80 80 80-35.84 80-80-35.84-80-80-80zm-8 143.44c-31.6-3.92-56-30.8-56-63.44 0-4.96.64-9.68 1.68-14.32L72 120v8c0 8.8 7.2 16 16 16zm55.2-20.32c-2.08-6.48-8-11.12-15.2-11.12h-8v-24c0-4.4-3.6-8-8-8H64V80h16c4.4 0 8-3.6 8-8V56h16c8.8 0 16-7.2 16-16v-3.28c23.44 9.52 40 32.48 40 59.28 0 16.64-6.4 31.76-16.8 43.12z\"\n      fillRule=\"evenodd\"\n      fill=\"currentColor\"\n    />\n  </svg>\n);\n\nexport const PubSubIcon = svgIcon(\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n    <g>\n      <path\n        d=\"M19.83,9.7a1.72,1.72,0,1,0-2.36-.63A1.73,1.73,0,0,0,19.83,9.7Z\"\n        fill=\"currentColor\"\n      />\n      <path\n        d=\"M4.17,9.7a1.72,1.72,0,1,0-.63-2.35A1.72,1.72,0,0,0,4.17,9.7Z\"\n        fill=\"currentColor\"\n      />\n      <circle cx=\"12\" cy=\"20.28\" r=\"1.72\" fill=\"currentColor\" />\n      <path\n        d=\"M20.06,14.36a2.19,2.19,0,0,0-2.46.19l-2.9-1.68a2.67,2.67,0,0,0,.08-.64,2.77,2.77,0,0,0-2-2.65V6.22a2.19,2.19,0,1,0-1.6,0V9.58a2.77,2.77,0,0,0-2,2.65,2.67,2.67,0,0,0,.08.64L6.4,14.55a2.2,2.2,0,1,0,.79,1.38l2.9-1.68a2.75,2.75,0,0,0,3.82,0l2.9,1.68a2.18,2.18,0,1,0,3.25-1.57Z\"\n        fill=\"currentColor\"\n      />\n    </g>\n  </svg>\n);\n\n// Other icons below:\n\n// TODO: Re-implement outer circle using CSS and dedupe with DatabaseIcon.\nexport const DatabaseCircleIcon = svgIcon(\n  <svg viewBox=\"0 0 38 38\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M19 37C28.9411 37 37 28.9411 37 19C37 9.05887 28.9411 1 19 1C9.05887 1 1 9.05887 1 19C1 28.9411 9.05887 37 19 37Z\"\n      fill=\"white\"\n      stroke=\"black\"\n      strokeOpacity=\"0.12\"\n    />\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M10 22H28V26.002C28.0005 26.5315 27.7906 27.0396 27.4164 27.4143C27.0423 27.7891 26.5345 27.9997 26.005 28H11.995C10.8929 27.9978 10.0005 27.1041 10 26.002V22ZM10 11.992C10 10.892 10.893 10 11.995 10H26.005C27.107 10 28 10.9 28 11.992V19.008C28 20.108 27.107 21 26.005 21H11.995C10.893 21 10 20.1 10 19.008V11.992ZM12 12H26V15H12V12ZM12 17.505C12 17.225 12.214 17 12.505 17H13.495C13.775 17 14 17.214 14 17.505V18.495C14 18.775 13.786 19 13.495 19H12.505C12.3704 19.0022 12.2407 18.9497 12.1455 18.8545C12.0503 18.7593 11.9978 18.6296 12 18.495V17.505ZM12 24.505C12 24.225 12.214 24 12.505 24H13.495C13.775 24 14 24.214 14 24.505V25.495C14 25.775 13.786 26 13.495 26H12.505C12.3704 26.0022 12.2407 25.9497 12.1455 25.8545C12.0503 25.7593 11.9978 25.6296 12 25.495V24.505Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n);\n\nexport const HintIcon = svgIcon(\n  <svg viewBox=\"0 0 10 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M2.99998 13C2.99998 13.3667 3.29998 13.6667 3.66665 13.6667H6.33331C6.69998 13.6667 6.99998 13.3667 6.99998 13V12.3334H2.99998V13ZM4.99998 0.333374C2.42665 0.333374 0.333313 2.42671 0.333313 5.00004C0.333313 6.58671 1.12665 7.98004 2.33331 8.82671V10.3334C2.33331 10.7 2.63331 11 2.99998 11H6.99998C7.36665 11 7.66665 10.7 7.66665 10.3334V8.82671C8.87331 7.98004 9.66665 6.58671 9.66665 5.00004C9.66665 2.42671 7.57331 0.333374 4.99998 0.333374ZM6.89998 7.73337L6.33331 8.13337V9.66671H3.66665V8.13337L3.09998 7.73337C2.65831 7.42718 2.29727 7.01867 2.04768 6.54271C1.79809 6.06675 1.66736 5.53747 1.66665 5.00004C1.66665 3.16004 3.15998 1.66671 4.99998 1.66671C6.83998 1.66671 8.33331 3.16004 8.33331 5.00004C8.33331 6.08671 7.79998 7.10671 6.89998 7.73337Z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n);\n\nfunction svgIcon(\n  svgElement: JSX.Element\n): React.FC<\n  { size?: string } & ComponentProps<Omit<IconProps, 'size'>, {}, 'svg'>\n> {\n  return ({ size = 'small', ...props }) => {\n    return (\n      <Icon\n        icon={{\n          strategy: 'component',\n          size,\n          icon: svgElement,\n        }}\n        {...props}\n      />\n    );\n  };\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport './EmulatorDisabled.scss';\n\nimport { Card } from '@rmwc/card';\nimport { GridCell } from '@rmwc/grid';\nimport { Typography } from '@rmwc/typography';\nimport React from 'react';\n\nimport { HintIcon } from './icons';\n\nexport const EmulatorDisabled: React.FC<{\n  productName: string;\n}> = ({ productName }) => (\n  <>\n    <GridCell desktop={2} tablet={0} phone={0}>\n      {/* Spacing */}\n    </GridCell>\n    <GridCell span={8} align=\"middle\">\n      <Card className=\"EmulatorDisabled\">\n        <div className=\"EmulatorDisabled-graphics\">\n          <img src=\"/assets/img/database.png\" alt=\"\" />\n        </div>\n        <div className=\"EmulatorDisabled-description\">\n          <Typography use=\"headline6\" tag=\"h3\">\n            The {productName} Emulator is currently not running.\n          </Typography>\n          <Typography use=\"body1\" tag=\"p\">\n            If you are not using {productName} in your testing, everything is\n            fine. If you want to use {productName} in your testing, then the\n            best way to set it up and start it is to run the following command\n            initialize the {productName} Emulator:{' '}\n            <code>firebase init emulators</code>. Followed by:{' '}\n            <code>firebase emulators:start</code>.\n          </Typography>\n          <Typography use=\"body1\" tag=\"p\">\n            <a href=\"https://firebase.google.com/docs/emulator-suite/install_and_configure#configure_emulator_suite\">\n              <HintIcon size=\"xsmall\" /> Learn more\n            </a>\n          </Typography>\n        </div>\n      </Card>\n    </GridCell>\n  </>\n);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ThemeProvider } from '@rmwc/theme';\nimport React from 'react';\n\nimport { primary } from './colors';\n\n/** Error color used in global theme */\nexport const error = '#d32f2f'; // Red 700\n\nconst purple50 = '#f3e5f5';\nexport const tipTheme = {\n  background: purple50,\n  primary,\n  primaryRgb: '104, 29, 168',\n  textIconOnBackground: primary,\n  textPrimaryOnBackground: primary,\n  textSecondaryOnBackground: `rgba(${primary}, 0.7)`,\n};\n\nconst teal50 = '#e0f2f1';\nconst teal700 = '#00796b';\nconst teal800 = '#00695c';\nexport const successTheme = {\n  background: teal50,\n  primary: teal700,\n  primaryRgb: '0, 121, 107',\n  textIconOnBackground: teal700,\n  textPrimaryOnBackground: teal800,\n  textSecondaryOnBackground: `rgba(${teal800}, 0.7)`,\n};\n\nconst navy20 = '#e5eaf0';\nconst navy300 = '#476282';\nconst navy600 = '#1b3a57';\nexport const noteTheme = {\n  background: navy20,\n  primary: navy300,\n  primaryRgb: '71, 98, 130',\n  textIconOnBackground: navy300,\n  textPrimaryOnBackground: navy600,\n  textSecondaryOnBackground: `rgba(${navy600}, 0.7)`,\n};\n\nconst orange50 = '#fff3e0';\nconst amber800 = '#ff8f00';\nconst deepOrange900 = '#bf360c';\nexport const cautionTheme = {\n  background: orange50,\n  primary: amber800,\n  primaryRgb: '255, 143, 0',\n  onPrimary: 'white',\n  textIconOnBackground: amber800,\n  textPrimaryOnBackground: deepOrange900,\n  textSecondaryOnBackground: `rgba(${deepOrange900}, 0.7)`,\n};\n\nconst deepOrange50 = '#fbe9e7';\nconst red700 = '#d32f2f';\nconst red800 = '#c62828';\nexport const errorTheme = {\n  background: deepOrange50,\n  primary: red700,\n  primaryRgb: '211, 47, 47',\n  textIconOnBackground: red700,\n  textPrimaryOnBackground: red800,\n  textSecondaryOnBackground: `rgba(${red800}, 0.7)`,\n};\n\n/** Possible theme types */\nexport enum Type {\n  CAUTION = 'caution',\n  NOTE = 'note',\n  SUCCESS = 'success',\n  TIP = 'tip',\n  WARNING = 'warning',\n}\n\nconst THEME_MAP: Record<string, Record<string, string>> = {\n  [Type.CAUTION]: cautionTheme,\n  [Type.NOTE]: noteTheme,\n  [Type.SUCCESS]: successTheme,\n  [Type.TIP]: tipTheme,\n  [Type.WARNING]: errorTheme,\n};\n\nexport type CustomThemeType =\n  | 'caution'\n  | 'note'\n  | 'success'\n  | 'tip'\n  | 'warning';\n\ninterface Props {\n  use: CustomThemeType;\n  wrap?: boolean;\n}\n\nexport const CustomThemeProvider: React.FC<Props> = ({\n  use,\n  wrap,\n  children,\n}) => (\n  <ThemeProvider options={THEME_MAP[use]} wrap={wrap}>\n    {children}\n  </ThemeProvider>\n);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './Spinner.scss';\n\nimport { CircularProgress } from '@rmwc/circular-progress';\nimport { GridCell } from '@rmwc/grid';\nimport { Typography } from '@rmwc/typography';\nimport classnames from 'classnames';\nimport React from 'react';\n\nexport const Spinner: React.FC<\n  {\n    message?: string;\n    span?: number;\n    cover?: boolean;\n    scrim?: boolean;\n  } & React.HTMLProps<any>\n> = ({ message, span, cover, scrim, ...props }) => {\n  const children = (\n    <>\n      <CircularProgress size=\"xlarge\" />\n      {message && (\n        <Typography use=\"body2\" tag=\"p\">\n          {message}\n        </Typography>\n      )}\n    </>\n  );\n  if (span === undefined) {\n    return (\n      <div className={classnames('Spinner', { cover, scrim })} {...props}>\n        {children}\n      </div>\n    );\n  } else {\n    return (\n      <GridCell span={span} align=\"middle\" className=\"Spinner\" {...props}>\n        {children}\n      </GridCell>\n    );\n  }\n};\n","import {\n  Dialog,\n  DialogActions,\n  DialogButton,\n  DialogContent,\n  DialogTitle,\n} from '@rmwc/dialog';\nimport { Radio } from '@rmwc/radio';\nimport { Typography } from '@rmwc/typography';\nimport React from 'react';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../store';\nimport { setAllowDuplicateEmailsRequest } from '../../../store/auth/actions';\nimport { getAllowDuplicateEmails } from '../../../store/auth/selectors';\nimport styles from './OneAccountPerEmailDialog.module.scss';\n\ninterface OneAccountPerEmailDialogProps {\n  onClose: () => void;\n}\n\ntype Props = PropsFromDispatch & PropsFromStore & OneAccountPerEmailDialogProps;\n\nexport const OneAccountPerEmailDialog: React.FC<Props> = ({\n  allowDuplicateEmails,\n  onClose,\n  setAllowDuplicateEmails,\n}) => {\n  const [value, setValue] = React.useState(allowDuplicateEmails);\n\n  return (\n    <Dialog renderToPortal open onClose={onClose}>\n      <DialogTitle>Account email address settings</DialogTitle>\n      <form\n        onSubmit={(e: React.FormEvent<unknown>) => {\n          e.preventDefault();\n          setAllowDuplicateEmails(value);\n          onClose();\n        }}\n      >\n        <DialogContent>\n          <Typography use=\"body2\" className={styles.description}>\n            This setting either prevents or allows users to create multiple\n            accounts using the same email address if they sign in to your app\n            using different authentication providers.\n          </Typography>\n          <Radio\n            value=\"false\"\n            checked={!value}\n            onChange={() => setValue(false)}\n            onClick={() => setValue(false)}\n          >\n            Prevent creation of multiple accounts with the same email address\n          </Radio>\n\n          <Radio\n            value=\"true\"\n            checked={value}\n            onChange={() => setValue(true)}\n            onClick={() => setValue(true)}\n          >\n            Allow creation of multiple accounts with the same email address\n          </Radio>\n        </DialogContent>\n        <DialogActions>\n          <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n            Cancel\n          </DialogButton>\n          <DialogButton type=\"submit\" unelevated>\n            Save\n          </DialogButton>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport const mapStateToProps = createStructuredSelector({\n  allowDuplicateEmails: getAllowDuplicateEmails,\n});\n\nexport type PropsFromStore = ReturnType<typeof mapStateToProps>;\n\nexport interface PropsFromDispatch {\n  setAllowDuplicateEmails: typeof setAllowDuplicateEmailsRequest;\n}\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => ({\n  setAllowDuplicateEmails: (value: boolean) =>\n    dispatch(setAllowDuplicateEmailsRequest(value)),\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(OneAccountPerEmailDialog);\n","import { Button } from '@rmwc/button';\nimport { Card } from '@rmwc/card';\nimport { Typography } from '@rmwc/typography';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../store';\nimport { getAllowDuplicateEmails } from '../../../store/auth/selectors';\nimport styles from './OneAccountPerEmailCard.module.scss';\nimport OneAccountPerEmailDialog from './OneAccountPerEmailDialog';\n\nexport type OneAccountPerEmailCardProps = PropsFromStore;\nexport const OneAccountPerEmailCard: React.FC<OneAccountPerEmailCardProps> = ({\n  allowDuplicateEmails,\n}) => {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <>\n      <Card className={styles.wrapper}>\n        {allowDuplicateEmails ? (\n          <div>\n            <Typography\n              use=\"headline6\"\n              tag=\"div\"\n              theme=\"textPrimaryOnBackground\"\n            >\n              Multiple accounts per email address\n            </Typography>\n            <Typography use=\"body2\" theme=\"textPrimaryOnBackground\">\n              Allowing users to create multiple accounts for authentication\n              providers that use the same email address.{' '}\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                href=\"https://support.google.com/firebase/answer/6400716\"\n              >\n                Learn more\n              </a>\n            </Typography>\n          </div>\n        ) : (\n          <div>\n            <Typography\n              use=\"headline6\"\n              tag=\"div\"\n              theme=\"textPrimaryOnBackground\"\n            >\n              One account per email address\n            </Typography>\n            <Typography use=\"body2\" theme=\"textPrimaryOnBackground\">\n              Preventing users from creating multiple accounts using the same\n              email address with different authentication providers.\n            </Typography>\n          </div>\n        )}\n\n        <div>\n          <Button outlined={true} onClick={() => setOpen(true)}>\n            Change\n          </Button>\n        </div>\n      </Card>\n      {open && <OneAccountPerEmailDialog onClose={() => setOpen(false)} />}\n    </>\n  );\n};\nexport const mapStateToProps = createStructuredSelector({\n  allowDuplicateEmails: getAllowDuplicateEmails,\n});\n\nexport type PropsFromStore = ReturnType<typeof mapStateToProps>;\nexport default connect(mapStateToProps)(OneAccountPerEmailCard);\n","import './Callout.scss';\n\nimport { Icon } from '@rmwc/icon';\nimport { Theme, ThemeProvider } from '@rmwc/theme';\nimport { Typography } from '@rmwc/typography';\nimport React, { ReactNode } from 'react';\n\nimport { CustomThemeProvider, CustomThemeType, Type } from '../../themes';\n\nexport interface CalloutProps {\n  /** Custom icon to override the default */\n  icon?: string;\n  /** Show a lighter version of the callout */\n  aside?: true;\n  /** The color scheme of the callout. Defaults to 'note' */\n  type?: CustomThemeType;\n\n  /** Action buttons */\n  actions?: ReactNode;\n}\n\nconst DEFAULT_ICON_MAP: Record<string, string> = {\n  [Type.CAUTION]: 'error',\n  [Type.NOTE]: 'info',\n  [Type.SUCCESS]: 'check_circle',\n  [Type.TIP]: 'star',\n  [Type.WARNING]: 'warning',\n};\n\nexport const Callout: React.FC<CalloutProps> = ({\n  children,\n  actions,\n  icon,\n  aside,\n  type = Type.NOTE,\n}) => {\n  const iconName = icon || DEFAULT_ICON_MAP[type];\n  const asideClass = aside ? ' Callout-aside' : '';\n  const classes = `Callout Callout-${type}${asideClass}`;\n\n  return (\n    <CustomThemeProvider use={type} wrap>\n      <Theme\n        className={classes}\n        use={aside ? [] : ['onPrimary', 'primaryBg']}\n        tag=\"div\"\n      >\n        <div className=\"Callout-body\">\n          <div className=\"Callout-message\">\n            {iconName && (\n              <Icon\n                icon={iconName}\n                aria-hidden=\"true\"\n                className=\"Callout-icon\"\n              />\n            )}\n            <Typography use=\"subtitle2\">{children}</Typography>\n          </div>\n        </div>\n        {/* Make \"white\" the new primary, just to invert buttons from props */}\n        <ThemeProvider wrap options={aside ? {} : { primary: '#fff' }}>\n          <div className=\"Callout-actions\">{actions}</div>\n        </ThemeProvider>\n      </Theme>\n    </CustomThemeProvider>\n  );\n};\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createDialogQueue } from '@rmwc/dialog';\n\nexport const { dialogs, alert, confirm, prompt } = createDialogQueue();\n","import { Button } from '@rmwc/button';\nimport React from 'react';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../store';\nimport { nukeUsersRequest } from '../../../store/auth/actions';\nimport { hasUsers } from '../../../store/auth/selectors';\nimport { CustomThemeProvider } from '../../../themes';\nimport { confirmClearAll } from './confirmClearAllData';\nimport styles from './UsersCard.module.scss';\n\nexport type Props = PropsFromState & PropsFromDispatch;\nexport const ClearAll: React.FC<Props> = ({ hasUsers, clearAllData }) => {\n  return (\n    <>\n      {hasUsers && (\n        <div className={styles.clearAllButton}>\n          <CustomThemeProvider use=\"warning\" wrap>\n            <Button\n              unelevated\n              onClick={async () => {\n                if (await confirmClearAll()) {\n                  clearAllData();\n                }\n              }}\n            >\n              Clear all data\n            </Button>\n          </CustomThemeProvider>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport interface PropsFromDispatch {\n  clearAllData: typeof nukeUsersRequest;\n}\n\nexport const mapStateToProps = createStructuredSelector({\n  hasUsers: hasUsers,\n});\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => ({\n  clearAllData: () => dispatch(nukeUsersRequest()),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ClearAll);\n","import { DialogButton } from '@rmwc/dialog';\nimport React from 'react';\n\nimport { Callout } from '../../common/Callout';\nimport { confirm } from '../../common/DialogQueue';\n\nexport const confirmClearAll = () =>\n  confirm({\n    title: 'Clear all data',\n    body: (\n      <div className=\"Firestore--dialog-body\">\n        <Callout aside type=\"warning\">\n          This will delete all users\n        </Callout>\n      </div>\n    ),\n    // hide standard buttons so as to use `danger` button\n    acceptLabel: null,\n    cancelLabel: null,\n    footer: (\n      <>\n        <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n          Cancel\n        </DialogButton>\n        <DialogButton unelevated action=\"accept\" isDefaultAction danger>\n          Delete\n        </DialogButton>\n      </>\n    ),\n  });\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './Field.scss';\n\nimport { randomId } from '@rmwc/base';\nimport { Select, SelectProps } from '@rmwc/select';\nimport { TextField, TextFieldHTMLProps, TextFieldProps } from '@rmwc/textfield';\nimport { HTMLProps } from '@rmwc/types';\nimport { Typography } from '@rmwc/typography';\nimport classnames from 'classnames';\nimport React, { useState } from 'react';\n\ntype Props = {\n  fieldClassName?: string;\n  tip?: string;\n  error?: React.ReactNode | string;\n} & TextFieldProps &\n  TextFieldHTMLProps;\n\nexport const Field: React.FC<Props> = ({\n  fieldClassName,\n  label,\n  // strip fullwidth or outlined, always use outlined\n  fullwidth,\n  outlined,\n  tip,\n  error,\n  ...textFieldProps\n}) => {\n  const [id] = useState(randomId('field'));\n  const [subtextId] = useState(randomId('field-subtext'));\n  return (\n    <div className={classnames('Field', fieldClassName)}>\n      <Typography\n        className=\"Field-label\"\n        use=\"body2\"\n        theme=\"secondary\"\n        tag=\"label\"\n        htmlFor={id}\n      >\n        {label}\n      </Typography>\n      <TextField\n        outlined\n        aria-describedby={subtextId}\n        invalid={!!error}\n        aria-invalid={!!error}\n        {...textFieldProps}\n        tag=\"div\"\n        id={id}\n      />\n      <div className=\"Field-subtext\" id={subtextId}>\n        {error ? (\n          <Typography\n            className=\"Field-tip\"\n            role=\"alert\"\n            use=\"body2\"\n            theme=\"error\"\n          >\n            {error}\n          </Typography>\n        ) : (\n          tip && (\n            <Typography className=\"Field-tip\" use=\"body2\" theme=\"secondary\">\n              {tip}\n            </Typography>\n          )\n        )}\n      </div>\n    </div>\n  );\n};\n\ntype SelectFieldProps = {\n  fieldClassName?: string;\n  tip?: string;\n  error?: string;\n} & SelectProps &\n  HTMLProps<HTMLSelectElement>;\n\nexport const SelectField: React.FC<SelectFieldProps> = ({\n  fieldClassName,\n  label,\n  // strip outlined bool, always use outlined\n  outlined,\n  tip,\n  theme, // TODO: 5.0 theme, incompatible with 6.0 remove at 6.0\n  error,\n  ...selectProps\n}) => {\n  const [id] = useState(randomId());\n  return (\n    <div className={classnames('Field', fieldClassName)}>\n      <Typography\n        className=\"Field-label\"\n        use=\"body2\"\n        theme=\"secondary\"\n        tag=\"label\"\n        htmlFor={id}\n      >\n        {label}\n      </Typography>\n      <Select outlined {...selectProps} id={id} />\n      <div className=\"Field-subtext\">\n        {error ? (\n          <Typography className=\"Field-tip\" use=\"body2\" theme=\"error\">\n            {error}\n          </Typography>\n        ) : (\n          tip && (\n            <Typography className=\"Field-tip\" use=\"body2\" theme=\"secondary\">\n              {tip}\n            </Typography>\n          )\n        )}\n      </div>\n    </div>\n  );\n};\n","// This assert is not exported and is intentionally inconsistent with the rest of the app.\nfunction assert(assertion: unknown, error: string): asserts assertion {\n  if (!assertion) {\n    throw new Error(error);\n  }\n}\n\nconst BadRequestError = Error;\n\n/**\n * The code below has been copy-pasted from firebase-tools repo as is.\n * https://github.com/firebase/firebase-tools/blob/14977a2df4f046c6439167e9037373363db648a2/src/emulator/auth/operations.ts#L1350\n */\nconst CUSTOM_ATTRIBUTES_MAX_LENGTH = 1000;\n\nexport function validateSerializedCustomClaims(claims: string): void {\n  assert(claims.length <= CUSTOM_ATTRIBUTES_MAX_LENGTH, 'CLAIMS_TOO_LARGE');\n\n  let parsed;\n  try {\n    parsed = JSON.parse(claims);\n  } catch {\n    throw new BadRequestError('INVALID_CLAIMS');\n  }\n  validateCustomClaims(parsed);\n}\n\n// https://firebase.google.com/docs/auth/admin/create-custom-tokens#create_custom_tokens_using_the_firebase_admin_sdk\nconst FORBIDDEN_CUSTOM_CLAIMS = [\n  'iss',\n  'aud',\n  'sub',\n  'iat',\n  'exp',\n  'nbf',\n  'jti',\n  'nonce',\n  'azp',\n  'acr',\n  'amr',\n  'cnf',\n  'auth_time',\n  'firebase',\n  'at_hash',\n  'c_hash',\n];\n\nfunction validateCustomClaims(\n  claims: unknown\n): asserts claims is Record<string, unknown> {\n  // Only JSON objects (maps) are valid. Others are not.\n  assert(\n    typeof claims === 'object' && claims != null && !Array.isArray(claims),\n    'INVALID_CLAIMS'\n  );\n  for (const reservedField of FORBIDDEN_CUSTOM_CLAIMS) {\n    assert(!(reservedField in claims), `FORBIDDEN_CLAIM : ${reservedField}`);\n  }\n}\n","import { Typography } from '@rmwc/typography';\nimport React from 'react';\nimport { FormContextValues } from 'react-hook-form/dist/contextTypes';\n\nimport { Field } from '../../../common/Field';\nimport { AddAuthUserPayload } from '../../types';\nimport styles from './controls.module.scss';\nimport { validateSerializedCustomClaims } from './customClaimsValidation';\n\nfunction validate(attributes: string) {\n  if (attributes === '') {\n    return true;\n  }\n\n  try {\n    // We're reusing server validation.\n    validateSerializedCustomClaims(attributes);\n    return true;\n  } catch (e) {\n    if (e.message === 'INVALID_CLAIMS') {\n      return 'Custom claims must be a valid JSON object';\n    }\n    if (e.message === 'CLAIMS_TOO_LARGE') {\n      return 'Custom claims length must not exceed 1000 characters';\n    }\n    const forbiddenClaim = e.message.match(/FORBIDDEN_CLAIM : (\\w+)$/);\n    if (forbiddenClaim && forbiddenClaim[1]) {\n      return 'Custom claims must not have forbidden key: ' + forbiddenClaim[1];\n    }\n  }\n}\n\nconst CUSTOM_ATTRIBUTES_CONTROL_NAME = 'customAttributes';\n\nexport const CustomAttributes: React.FC<\n  FormContextValues<AddAuthUserPayload>\n> = ({ errors, register }) => {\n  const label = (\n    <label>\n      <Typography use=\"subtitle2\" tag=\"div\" theme=\"textPrimaryOnBackground\">\n        Custom Claims (optional)\n      </Typography>\n    </label>\n  );\n  return (\n    <div className={styles.customAttributesWrapper}>\n      <Field\n        inputRef={register({ validate })}\n        error={errors[CUSTOM_ATTRIBUTES_CONTROL_NAME]?.message}\n        name={CUSTOM_ATTRIBUTES_CONTROL_NAME}\n        label={label}\n        textarea\n        placeholder={`Enter valid json, e.g. {\"role\":\"admin\"}`}\n      />\n      <Typography use=\"body2\">\n        These custom key:value attributes can be used with Rules to implement\n        various access control strategies (e.g. based on roles){' '}\n        <a\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          href=\"https://firebase.google.com/docs/auth/admin/custom-claims\"\n        >\n          Learn more\n        </a>\n      </Typography>\n    </div>\n  );\n};\n","import { CircularProgress } from '@rmwc/circular-progress';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { FormContextValues } from 'react-hook-form/dist/contextTypes';\n\nimport { Field } from '../../../common/Field';\nimport { AddAuthUserPayload } from '../../types';\nimport styles from '../UserFormDialog.module.scss';\n\nenum ImagePreviewStatus {\n  NONE = 'NONE',\n  LOADING = 'LOADING',\n  LOADED = 'LOADED',\n  ERROR = 'ERROR',\n}\n\nexport interface ImageUrlInput {\n  ImageConstructor?: typeof Image;\n}\n\nexport type ImageUrlInputProps = ImageUrlInput &\n  FormContextValues<AddAuthUserPayload>;\nexport const ImageUrlInput: React.FC<ImageUrlInputProps> = ({\n  register,\n  watch,\n  triggerValidation,\n  ImageConstructor,\n}) => {\n  ImageConstructor = ImageConstructor || Image;\n  const [previewUrl, setPreviewUrl] = useState('');\n  const image = useRef(new ImageConstructor());\n  const imageUrlRef = useRef('');\n  const status = useRef(ImagePreviewStatus.NONE);\n  const photoUrl = watch('photoUrl') || '';\n\n  useEffect(() => {\n    const img = image.current;\n\n    img.onload = () => {\n      if (status.current === ImagePreviewStatus.LOADING) {\n        status.current = ImagePreviewStatus.LOADED;\n        setPreviewUrl(imageUrlRef.current);\n        triggerValidation('photoUrl');\n      }\n    };\n    img.onerror = () => {\n      if (status.current === ImagePreviewStatus.LOADING) {\n        status.current = ImagePreviewStatus.ERROR;\n        setPreviewUrl('');\n        triggerValidation('photoUrl');\n      }\n    };\n\n    return () => {\n      img.onload = null;\n      img.onerror = null;\n    };\n  }, [triggerValidation]);\n\n  useEffect(() => {\n    if (photoUrl.trim() !== '') {\n      status.current = ImagePreviewStatus.LOADING;\n      imageUrlRef.current = photoUrl;\n      image.current.src = photoUrl;\n    } else {\n      status.current = ImagePreviewStatus.NONE;\n    }\n    triggerValidation('photoUrl');\n  }, [photoUrl, triggerValidation]);\n\n  const validate = () => {\n    return (\n      status.current === ImagePreviewStatus.LOADED ||\n      status.current === ImagePreviewStatus.NONE\n    );\n  };\n\n  return (\n    <>\n      <Field\n        name=\"photoUrl\"\n        label=\"User Photo URL (optional)\"\n        placeholder=\"Enter URL\"\n        error={\n          status.current === ImagePreviewStatus.ERROR && 'Error loading image'\n        }\n        type=\"text\"\n        inputRef={register({ validate })}\n      />\n      {status.current === ImagePreviewStatus.LOADED && (\n        <img className={styles.image} src={previewUrl} alt=\"Profile preview\" />\n      )}\n      {status.current === ImagePreviewStatus.LOADING && (\n        <div\n          className={styles.imageWrapper}\n          aria-busy=\"true\"\n          aria-live=\"polite\"\n          data-testid=\"spinner\"\n        >\n          <CircularProgress size=\"large\" />\n        </div>\n      )}\n    </>\n  );\n};\n","import { Typography } from '@rmwc/typography';\nimport React, { useEffect } from 'react';\nimport { FormContextValues } from 'react-hook-form/dist/contextTypes';\nimport { connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../../store';\nimport { getAllEmails, isEditingUser } from '../../../../store/auth/selectors';\nimport { Field } from '../../../common/Field';\nimport { AddAuthUserPayload } from '../../types';\nimport styles from './controls.module.scss';\n\n// Consistent with the Auth JS SDK and the Auth Emulator.\nconst EMAIL_REGEX = /^[^@]+@[^@]+$/;\nconst PASSWORD_MIN_LENGTH = 6;\n\nfunction getErrorText(errors: any) {\n  if (errors.email) {\n    if (errors.email.type === 'pattern') {\n      return 'Invalid email';\n    }\n    if (errors.email.type === 'validate') {\n      return 'User with this email already exists';\n    }\n  }\n\n  if (errors.emailpassword) {\n    return 'Both email and password should be present';\n  }\n  if (errors.password) {\n    return `Password should be at least ${PASSWORD_MIN_LENGTH} characters`;\n  }\n}\n\nexport type EmailPasswordProps = PropsFromState & { editedUserEmail?: string };\nexport const EmailPassword: React.FC<\n  EmailPasswordProps & FormContextValues<AddAuthUserPayload>\n> = ({\n  register,\n  watch,\n  setError,\n  clearError,\n  errors,\n  allEmails,\n  editedUserEmail,\n  isEditing,\n}) => {\n  const email = watch('email');\n  const password = watch('password');\n\n  useEffect(() => {\n    if (\n      (email === '' && password === '') ||\n      (email !== '' && (password !== '' || isEditing))\n    ) {\n      clearError('emailpassword' as any);\n    } else {\n      setError('emailpassword' as any, 'both');\n    }\n  }, [email, password, clearError, setError, isEditing]);\n\n  function validate(value: string) {\n    return value === editedUserEmail || !allEmails.has(value);\n  }\n\n  return (\n    <>\n      <Typography\n        use=\"body1\"\n        tag=\"div\"\n        className={styles.authKindLabel}\n        theme=\"textPrimaryOnBackground\"\n      >\n        Email authentication\n      </Typography>\n      <div className={styles.emailWrapper}>\n        <Field\n          name=\"email\"\n          placeholder=\"Enter email\"\n          label=\"Email\"\n          type=\"text\"\n          inputRef={register({ validate, pattern: EMAIL_REGEX })}\n        />\n        <Field\n          name=\"password\"\n          type=\"text\"\n          label=\"Password\"\n          placeholder=\"Enter password\"\n          inputRef={register({ minLength: PASSWORD_MIN_LENGTH })}\n        />\n      </div>\n      <Typography\n        className={styles.error}\n        use=\"body2\"\n        role=\"alert\"\n        theme=\"error\"\n      >\n        {getErrorText(errors)}\n      </Typography>\n    </>\n  );\n};\n\nexport const mapStateToProps = createStructuredSelector({\n  allEmails: getAllEmails,\n  isEditing: isEditingUser,\n});\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport default connect(mapStateToProps)(EmailPassword);\n","import { Typography } from '@rmwc/typography';\nimport React from 'react';\nimport { FormContextValues } from 'react-hook-form/dist/contextTypes';\nimport { connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../../store';\nimport { getAllPhoneNumbers } from '../../../../store/auth/selectors';\nimport { Field } from '../../../common/Field';\nimport { AddAuthUserPayload } from '../../types';\nimport styles from './controls.module.scss';\n\n// Consistent with the back-end validation. We want to be as loose as possible in\n// the emulator to avoid false negatives.\nconst PHONE_REGEX = /^\\+/;\n\nexport type PhoneControlProps = PropsFromState & {\n  editedUserPhoneNumber?: string;\n};\n\nexport const PhoneControl: React.FC<\n  PhoneControlProps & FormContextValues<AddAuthUserPayload>\n> = ({ register, errors, allPhoneNumbers, editedUserPhoneNumber }) => {\n  function validate(value: string) {\n    return editedUserPhoneNumber === value || !allPhoneNumbers.has(value);\n  }\n\n  function getErrorText() {\n    if (errors.phoneNumber) {\n      if (errors.phoneNumber.type === 'pattern') {\n        return 'Phone number must be in international format and start with a \"+\"';\n      }\n      if (errors.phoneNumber.type === 'validate') {\n        return 'User with this phone number already exists';\n      }\n    }\n  }\n\n  return (\n    <>\n      <Typography\n        use=\"body1\"\n        tag=\"div\"\n        className={styles.authKindLabel}\n        theme=\"textPrimaryOnBackground\"\n      >\n        Phone authentication\n      </Typography>\n      <Field\n        name=\"phoneNumber\"\n        label=\"Phone\"\n        placeholder=\"Enter phone number\"\n        type=\"tel\"\n        error={getErrorText()}\n        inputRef={register({ pattern: PHONE_REGEX, validate })}\n      />\n    </>\n  );\n};\n\nexport const mapStateToProps = createStructuredSelector({\n  allPhoneNumbers: getAllPhoneNumbers,\n});\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport default connect(mapStateToProps)(PhoneControl);\n","import { ListDivider } from '@rmwc/list';\nimport { Typography } from '@rmwc/typography';\nimport React, { useEffect } from 'react';\nimport { FormContextValues } from 'react-hook-form/dist/contextTypes';\n\nimport { AddAuthUserPayload } from '../../types';\nimport styles from './controls.module.scss';\nimport EmailPassword from './EmailPassword';\nimport PhoneControl from './PhoneControl';\n\nconst ERROR_AT_LEAST_ONE_METHOD_REQUIRED = 'atLeastOneMethodRequired';\n\nexport type SignInMethodProps = {\n  user?: AddAuthUserPayload;\n};\nexport const SignInMethod: React.FC<\n  SignInMethodProps & FormContextValues<AddAuthUserPayload>\n> = (form) => {\n  const { watch, setError, clearError, formState, errors, user } = form;\n  const email = watch('email');\n  const password = watch('password');\n  const phoneNumber = watch('phoneNumber');\n\n  useEffect(() => {\n    const hasEmail = email !== '';\n    const hasPhone = !!phoneNumber;\n\n    if (hasEmail || hasPhone) {\n      // According to docs ClearError should accept arbitrary key\n      // to allow cross-field validation, but it's not the case here for some\n      // reason.\n      clearError(ERROR_AT_LEAST_ONE_METHOD_REQUIRED as any);\n    } else {\n      setError(ERROR_AT_LEAST_ONE_METHOD_REQUIRED as any);\n    }\n  }, [email, password, clearError, setError, phoneNumber, errors]);\n\n  const isTouched =\n    formState.touched['email'] || formState.touched['phoneNumber'];\n  const isOnlyError =\n    ERROR_AT_LEAST_ONE_METHOD_REQUIRED in errors &&\n    Object.values(errors).length === 1;\n\n  return (\n    <div className={styles.signInWrapper}>\n      <ListDivider tag=\"div\" />\n      <div className={styles.signInHeader}>\n        <Typography use=\"body1\" theme=\"textPrimaryOnBackground\">\n          Authentication method\n        </Typography>\n        {isTouched && isOnlyError ? (\n          <Typography use=\"body2\" theme=\"error\" tag=\"div\" role=\"alert\">\n            One method is required. Please enter either an email/password or\n            phone number.\n          </Typography>\n        ) : (\n          <Typography use=\"body2\" tag=\"div\">\n            Enter details for at least one of the following methods:\n          </Typography>\n        )}\n      </div>\n      <EmailPassword {...form} editedUserEmail={user?.email} />\n      <PhoneControl {...form} editedUserPhoneNumber={user?.phoneNumber} />\n    </div>\n  );\n};\n","import { Button } from '@rmwc/button';\nimport {\n  Dialog,\n  DialogActions,\n  DialogButton,\n  DialogContent,\n  DialogTitle,\n} from '@rmwc/dialog';\nimport React, { useCallback } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../store';\nimport {\n  clearAuthUserDialogData,\n  createUserRequest,\n  updateUserRequest,\n} from '../../../store/auth/actions';\nimport {\n  getAuthUserDialog,\n  getCurrentEditedUser,\n} from '../../../store/auth/selectors';\nimport { hasError } from '../../../store/utils';\nimport { Callout } from '../../common/Callout';\nimport { Field } from '../../common/Field';\nimport { AddAuthUserPayload } from '../types';\nimport { CustomAttributes } from './controls/CustomAttributes';\nimport { ImageUrlInput } from './controls/ImageUrlInput';\nimport { SignInMethod } from './controls/SignInMethod';\n\nexport type UserFormProps = PropsFromState & PropsFromDispatch;\nexport const UserForm: React.FC<UserFormProps> = ({\n  authUserDialogData,\n  clearAuthUserDialogData,\n  updateUser,\n  createUser,\n  user,\n}) => {\n  const isEditing = !!user;\n  const localId = user?.localId!;\n\n  const form = useForm<AddAuthUserPayload>({\n    defaultValues: user,\n    mode: 'onChange',\n  });\n\n  const save = useCallback(\n    (user: AddAuthUserPayload, keepDialogOpen?: boolean) => {\n      if (isEditing) {\n        updateUser({ user, localId });\n      } else {\n        createUser({ user, keepDialogOpen });\n      }\n    },\n    [isEditing, updateUser, createUser, localId]\n  );\n\n  const { register, handleSubmit, formState, reset, errors } = form;\n\n  const canSubmit = !authUserDialogData?.loading && formState.isValid;\n\n  const submit = useCallback(\n    (user: AddAuthUserPayload) => {\n      // Take into account multi-field errors.\n      if (Object.values(errors).length === 0) {\n        save(user);\n      }\n    },\n    [errors, save]\n  );\n\n  return (\n    <Dialog renderToPortal open onClose={clearAuthUserDialogData}>\n      <DialogTitle>\n        {user ? `Edit User ${user.displayName}` : 'Add a user'}\n      </DialogTitle>\n\n      <form onSubmit={handleSubmit(submit)} data-testid=\"user-form\">\n        <DialogContent>\n          <Field\n            name=\"displayName\"\n            label=\"Display name (optional)\"\n            type=\"text\"\n            placeholder=\"Enter display name\"\n            error={errors?.displayName && 'Display name is required'}\n            inputRef={register({})}\n          />\n\n          <ImageUrlInput {...form} />\n          <CustomAttributes {...form} />\n          <SignInMethod {...form} user={user} />\n          {hasError(authUserDialogData?.result) && (\n            <Callout type=\"warning\">\n              Error: {authUserDialogData?.result.error}\n            </Callout>\n          )}\n        </DialogContent>\n        <DialogActions>\n          <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n            Cancel\n          </DialogButton>\n          {!isEditing && (\n            <Button\n              onClick={handleSubmit((result) => {\n                save(result, /* keepDialogOpen */ true);\n                reset(user);\n              })}\n              disabled={!canSubmit}\n              type=\"button\"\n            >\n              Save and create another\n            </Button>\n          )}\n\n          <DialogButton disabled={!canSubmit} type=\"submit\" unelevated>\n            Save\n          </DialogButton>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport interface PropsFromDispatch {\n  clearAuthUserDialogData: typeof clearAuthUserDialogData;\n  updateUser: typeof updateUserRequest;\n  createUser: typeof createUserRequest;\n}\n\nexport const mapStateToProps = createStructuredSelector({\n  authUserDialogData: getAuthUserDialog,\n  user: getCurrentEditedUser,\n});\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => {\n  return {\n    clearAuthUserDialogData: () => dispatch(clearAuthUserDialogData()),\n    updateUser: (d) => dispatch(updateUserRequest(d)),\n    createUser: (d) => dispatch(createUserRequest(d)),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserForm);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './CardActionBar.scss';\n\nimport { Theme, ThemeProvider } from '@rmwc/theme';\nimport classnames from 'classnames';\nimport React from 'react';\n\nimport { grey100 } from '../../colors';\n\nexport const CardActionBar: React.FC<{ className?: string }> = ({\n  className,\n  children,\n}) => {\n  return (\n    <ThemeProvider\n      options={{ surface: grey100 }}\n      className={classnames('CardActionBar', className)}\n    >\n      <Theme use={['surface']} className=\"CardActionBar-container\" tag=\"div\">\n        {children}\n      </Theme>\n    </ThemeProvider>\n  );\n};\n\nexport const CardActionBarActions: React.FC = ({ children }) => {\n  return (\n    <>\n      <span style={{ flex: '1 auto' }} />\n      <div className=\"CardActionBar-actions\">{children}</div>\n    </>\n  );\n};\n","import { TextField } from '@rmwc/textfield';\nimport keycode from 'keycode';\nimport React, { useLayoutEffect, useRef } from 'react';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../../store';\nimport { updateFilter } from '../../../../store/auth/actions';\nimport { getFilter } from '../../../../store/auth/selectors';\nimport styles from './AuthFilter.module.scss';\n\nexport const AuthFilter: React.FC<AuthFilterProps> = ({\n  filter,\n  updateFilter,\n}) => {\n  const clear = () => updateFilter({ filter: '' });\n  const filterEl = useRef<HTMLInputElement>(null);\n\n  // Focus on init and also on clear.\n  useLayoutEffect(() => {\n    if (filter === '') {\n      filterEl.current?.focus();\n    }\n  }, [filter]);\n\n  return (\n    <>\n      <form\n        role=\"search\"\n        className={styles.filterForm}\n        onSubmit={(e) => {\n          e.preventDefault();\n        }}\n      >\n        <TextField\n          onChange={(input: React.ChangeEvent<HTMLInputElement>) => {\n            updateFilter({ filter: input.target.value });\n          }}\n          placeholder=\"Search by user UID, email address, phone number, or display name\"\n          value={filter}\n          aria-label=\"filter\"\n          fullwidth\n          type=\"text\"\n          inputRef={filterEl}\n          outlined={false}\n          ripple={false}\n          icon=\"search\"\n          className={styles.filterTextField}\n          trailingIcon={\n            filter && {\n              icon: 'close',\n              role: 'button',\n              'aria-label': 'clear',\n              onClick: clear,\n              onKeyDown: (e: React.KeyboardEvent) => {\n                if (\n                  e.keyCode === keycode('spacebar') ||\n                  e.keyCode === keycode('enter')\n                ) {\n                  clear();\n                  e.preventDefault();\n                }\n              },\n            }\n          }\n        />\n      </form>\n    </>\n  );\n};\n\nexport interface PropsFromStore {\n  filter: string;\n}\n\nexport type AuthFilterProps = PropsFromStore & PropsFromDispatch;\n\nexport const mapStateToProps = createStructuredSelector({\n  filter: getFilter,\n});\n\nexport interface PropsFromDispatch {\n  updateFilter: typeof updateFilter;\n}\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => ({\n  updateFilter: (f) => dispatch(updateFilter(f)),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AuthFilter);\n","import { IconButton } from '@rmwc/icon-button';\nimport React from 'react';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { authFetchUsersRequest } from '../../../../store/auth/actions';\n\nexport const RefreshButton: React.FC<PropsFromDispatch> = ({ refresh }) => {\n  return (\n    <IconButton\n      onClick={refresh}\n      icon=\"refresh\"\n      label=\"Refresh\"\n      theme=\"secondary\"\n    />\n  );\n};\n\nexport interface PropsFromDispatch {\n  refresh: typeof authFetchUsersRequest;\n}\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => {\n  return {\n    refresh: () => dispatch(authFetchUsersRequest()),\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(RefreshButton);\n","import { Button } from '@rmwc/button';\nimport React from 'react';\n\nimport {\n  CardActionBar,\n  CardActionBarActions,\n} from '../../../common/CardActionBar';\nimport AuthFilter from './AuthFilter';\nimport styles from './AuthHeader.module.scss';\nimport RefreshButton from './RefreshButton';\n\nexport interface AuthHeaderProps {\n  onOpenNewUserDialog: () => void;\n}\n\nexport const AuthHeader: React.FC<AuthHeaderProps> = ({\n  onOpenNewUserDialog,\n}) => {\n  return (\n    <>\n      <CardActionBar>\n        <AuthFilter />\n        <div className={styles.barActions}>\n          <CardActionBarActions>\n            <RefreshButton />\n            <Button\n              className={styles.addUserButton}\n              unelevated\n              onClick={() => onOpenNewUserDialog()}\n            >\n              Add user\n            </Button>\n          </CardActionBarActions>\n        </div>\n      </CardActionBar>\n    </>\n  );\n};\n","import { Typography } from '@rmwc/typography';\nimport React from 'react';\n\nimport styles from './UsersTable.module.scss';\n\nexport const AuthZeroState: React.FC = () => {\n  return (\n    <Typography\n      use=\"body2\"\n      className={styles.noResultsWrapper}\n      theme=\"textSecondaryOnBackground\"\n    >\n      No users for this project yet\n    </Typography>\n  );\n};\n","import { DialogButton } from '@rmwc/dialog';\nimport React from 'react';\n\nimport { Callout } from '../../../common/Callout';\nimport { confirm } from '../../../common/DialogQueue';\nimport { AuthUser } from '../../types';\n\nexport const confirmDeleteUser = (user: AuthUser) =>\n  confirm({\n    title: 'Delete user',\n    body: (\n      <div className=\"Firestore--dialog-body\">\n        <Callout aside type=\"warning\">\n          This will delete user with uid {user.localId}\n        </Callout>\n      </div>\n    ),\n    // hide standard buttons so as to use `danger` button\n    acceptLabel: null,\n    cancelLabel: null,\n    footer: (\n      <>\n        <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n          Cancel\n        </DialogButton>\n        <DialogButton unelevated action=\"accept\" isDefaultAction danger>\n          Delete\n        </DialogButton>\n      </>\n    ),\n  });\n","import { Typography } from '@rmwc/typography';\nimport React from 'react';\n\nimport styles from './UsersTable.module.scss';\n\nexport const NoResults: React.FC = () => {\n  return (\n    <Typography\n      use=\"body2\"\n      aria-live=\"polite\"\n      theme=\"textSecondaryOnBackground\"\n      className={styles.noResultsWrapper}\n    >\n      No results\n    </Typography>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RemoteResult } from '../../store/utils';\n\n/** View model for Auth custom attributes */\nexport interface CustomAttribute {\n  role: string;\n  value: string;\n}\n\n/**\n * Field names are consistent with:\n * https://github.com/FirebasePrivate/firebase-tools/blob/d6b584da9f852313064d32dd219a6f23b7800d66/src/emulator/auth/schema.ts#L1670-L1779\n */\nexport interface AddAuthUserPayload {\n  customAttributes?: string;\n  displayName?: string;\n  photoUrl?: string;\n  screenName?: string;\n  email?: string;\n  password?: string;\n  phoneNumber?: string;\n}\n\nexport const providerToIconMap = {\n  'gc.apple.com': 'assets/provider-icons/auth_service_game_center.svg',\n  'apple.com': 'assets/provider-icons/auth_service_apple.svg',\n  'facebook.com': 'assets/provider-icons/auth_service_facebook.svg',\n  'github.com': 'assets/provider-icons/auth_service_github.svg',\n  'google.com': 'assets/provider-icons/auth_service_google.svg',\n  'microsoft.com': 'assets/provider-icons/auth_service_mslive.svg',\n  'playgames.google.com': 'assets/provider-icons/auth_service_play_games.svg',\n  'twitter.com': 'assets/provider-icons/auth_service_twitter.svg',\n  'yahoo.com': 'assets/provider-icons/auth_service_yahoo.svg',\n  phone: 'assets/provider-icons/auth_service_phone.svg',\n  password: 'assets/provider-icons/auth_service_email.svg',\n};\n\nexport interface AuthProviderInfo {\n  providerId: keyof typeof providerToIconMap;\n}\n\nexport interface AuthUser extends AddAuthUserPayload {\n  localId: string;\n  createdAt: string;\n  lastLoginAt: string;\n  disabled: boolean;\n  providerUserInfo: AuthProviderInfo[];\n}\n\nexport interface AuthState {\n  authUserDialogData?: RemoteResult<AuthUser | undefined>;\n  users: RemoteResult<AuthUser[]>;\n  filter: string;\n  allowDuplicateEmails: boolean;\n}\n","import { Icon } from '@rmwc/icon';\nimport { Theme } from '@rmwc/theme';\nimport React from 'react';\n\nimport { AuthUser, providerToIconMap } from '../../types';\nimport styles from './ProviderCell.module.scss';\n\nexport interface ProviderCellProps {\n  user: AuthUser;\n}\n\nexport const ProviderCell: React.FC<ProviderCellProps> = ({\n  user,\n}: ProviderCellProps) => {\n  return (\n    <Theme use=\"secondary\">\n      <div className={styles.iconWrapper}>\n        {user.providerUserInfo.map(\n          (providerInfo) =>\n            providerToIconMap[providerInfo.providerId] && (\n              <Icon\n                icon={providerToIconMap[providerInfo.providerId]}\n                key={providerInfo.providerId}\n                aria-label={providerInfo.providerId}\n              />\n            )\n        )}\n      </div>\n    </Theme>\n  );\n};\n","import {\n  DataTable,\n  DataTableBody,\n  DataTableCell,\n  DataTableContent,\n  DataTableHead,\n  DataTableHeadCell,\n  DataTableRow,\n} from '@rmwc/data-table';\nimport { IconButton } from '@rmwc/icon-button';\nimport { MenuItem, SimpleMenu } from '@rmwc/menu';\nimport React, { useState } from 'react';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../../store';\nimport {\n  deleteUserRequest,\n  openAuthUserDialog,\n  setUserDisabledRequest,\n} from '../../../../store/auth/actions';\nimport {\n  getFilteredUsers,\n  getShowTable,\n  getShowZeroResults,\n  getShowZeroState,\n} from '../../../../store/auth/selectors';\nimport { RemoteResult, createRemoteDataLoaded } from '../../../../store/utils';\nimport { AuthUser } from '../../types';\nimport { AuthZeroState } from './AuthZeroState';\nimport { confirmDeleteUser } from './confirmDeleteUser';\nimport { NoResults } from './NoResults';\nimport { ProviderCell } from './ProviderCell';\nimport styles from './UsersTable.module.scss';\n\nexport type UsersTableProps = PropsFromDispatch & PropsFromStore;\n\ninterface UserTableRowProps {\n  user: AuthUser;\n  onEditUser: () => void;\n  toggleUserDisabled: () => void;\n  onDeleteUser: () => void;\n}\n\nexport const UsersTableRow: React.FC<UserTableRowProps> = ({\n  user,\n  onEditUser,\n  toggleUserDisabled,\n  onDeleteUser,\n}) => {\n  /*\n   * Simple menu is broken when rendered in portal (it doesn't close)\n   *\n   * So here we're opening and closing it manually. see:\n   * https://github.com/jamesmfriedman/rmwc/issues/627#issuecomment-643238936\n   */\n  const [menuOpen, setMenuOpen] = useState(false);\n  const formattedCreatedAt = new Date(\n    Number(user.createdAt)\n  ).toLocaleDateString();\n  const formattedSignedIn =\n    user.lastLoginAt && new Date(Number(user.lastLoginAt)).toLocaleDateString();\n\n  return (\n    <DataTableRow className={user.disabled ? styles.disabled : ''}>\n      <DataTableCell>\n        {user.displayName || user.email || user.phoneNumber}\n      </DataTableCell>\n      <DataTableCell>{<ProviderCell user={user} />}</DataTableCell>\n      <DataTableCell>{formattedCreatedAt}</DataTableCell>\n      <DataTableCell>{formattedSignedIn}</DataTableCell>\n      <DataTableCell>{user.localId}</DataTableCell>\n      <DataTableCell style={{ width: '20px' }}>\n        <SimpleMenu\n          open={menuOpen}\n          onOpen={() => setMenuOpen(true)}\n          onClose={() => setMenuOpen(false)}\n          handle={\n            <IconButton theme=\"secondary\" icon=\"more_vert\" label=\"Open menu\" />\n          }\n          renderToPortal\n        >\n          <MenuItem\n            onClick={() => {\n              setMenuOpen(false);\n              onEditUser();\n            }}\n          >\n            Edit user\n          </MenuItem>\n          <MenuItem\n            onClick={() => {\n              setMenuOpen(false);\n              toggleUserDisabled();\n            }}\n          >\n            {user.disabled ? 'Enable user' : 'Disable user'}\n          </MenuItem>\n          <MenuItem\n            onClick={() => {\n              setMenuOpen(false);\n              onDeleteUser();\n            }}\n          >\n            Delete user\n          </MenuItem>\n        </SimpleMenu>\n      </DataTableCell>\n    </DataTableRow>\n  );\n};\n\nexport const UsersTable: React.FC<UsersTableProps> = ({\n  filteredUsers,\n  setUserDisabled,\n  deleteUser,\n  shouldShowTable,\n  openAuthUserDialog,\n  shouldShowZeroResults,\n  shouldShowZeroState,\n}) => {\n  return (\n    <>\n      <DataTable className={styles.tableWrapper}>\n        <DataTableContent>\n          <DataTableHead>\n            <DataTableRow>\n              <DataTableHeadCell>Identifier</DataTableHeadCell>\n              <DataTableHeadCell>Provider</DataTableHeadCell>\n              <DataTableHeadCell>Created</DataTableHeadCell>\n              <DataTableHeadCell>Signed In</DataTableHeadCell>\n              <DataTableHeadCell>User UID</DataTableHeadCell>\n            </DataTableRow>\n          </DataTableHead>\n          <DataTableBody>\n            {shouldShowTable &&\n              filteredUsers.map((user) => (\n                <UsersTableRow\n                  key={user.localId}\n                  user={user}\n                  onEditUser={() => {\n                    openAuthUserDialog(createRemoteDataLoaded(user));\n                  }}\n                  toggleUserDisabled={() => {\n                    setUserDisabled({\n                      localId: user.localId,\n                      disabled: !user.disabled,\n                    });\n                  }}\n                  onDeleteUser={async () => {\n                    if (await confirmDeleteUser(user)) {\n                      deleteUser(user);\n                    }\n                  }}\n                />\n              ))}\n          </DataTableBody>\n        </DataTableContent>\n      </DataTable>\n      {shouldShowZeroResults && <NoResults />}\n      {shouldShowZeroState && <AuthZeroState />}\n    </>\n  );\n};\n\nexport const mapStateToProps = createStructuredSelector({\n  shouldShowTable: getShowTable,\n  shouldShowZeroResults: getShowZeroResults,\n  shouldShowZeroState: getShowZeroState,\n  filteredUsers: getFilteredUsers,\n});\n\nexport type PropsFromStore = ReturnType<typeof mapStateToProps>;\n\nexport interface PropsFromDispatch {\n  setUserDisabled: typeof setUserDisabledRequest;\n  deleteUser: typeof deleteUserRequest;\n  openAuthUserDialog: typeof openAuthUserDialog;\n}\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => {\n  return {\n    setUserDisabled: (d) => dispatch(setUserDisabledRequest(d)),\n    deleteUser: (d) => dispatch(deleteUserRequest(d)),\n    openAuthUserDialog: (data: RemoteResult<AuthUser | undefined>) =>\n      dispatch(openAuthUserDialog(data)),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UsersTable);\n","import { Card } from '@rmwc/card';\nimport React from 'react';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../../store';\nimport { openAuthUserDialog } from '../../../store/auth/actions';\nimport { getAuthUserDialog } from '../../../store/auth/selectors';\nimport { RemoteResult, createRemoteDataLoaded } from '../../../store/utils';\nimport { AuthUser } from '../types';\nimport UserForm from '../UserFormDialog/UserForm';\nimport { AuthHeader } from './header/AuthHeader';\nimport UsersTable from './table/UsersTable';\n\nexport type UserCardProps = PropsFromDispatch & PropsFromState;\nexport const UsersCard: React.FC<UserCardProps> = ({\n  openAuthUserDialog,\n  authUserDialogData,\n}) => {\n  return (\n    <Card>\n      <AuthHeader\n        onOpenNewUserDialog={() =>\n          openAuthUserDialog(createRemoteDataLoaded(undefined))\n        }\n      />\n      <UsersTable />\n      {authUserDialogData && <UserForm />}\n    </Card>\n  );\n};\n\nexport interface PropsFromDispatch {\n  openAuthUserDialog: typeof openAuthUserDialog;\n}\n\nexport const mapStateToProps = createStructuredSelector({\n  authUserDialogData: getAuthUserDialog,\n});\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => {\n  return {\n    openAuthUserDialog: (data: RemoteResult<AuthUser | undefined>) =>\n      dispatch(openAuthUserDialog(data)),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UsersCard);\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.module.scss';\n\nimport { Elevation } from '@rmwc/elevation';\nimport { GridCell } from '@rmwc/grid';\nimport React from 'react';\nimport { connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../store';\nimport {\n  getAuthConfigResult,\n  getAuthUsersResult,\n} from '../../store/auth/selectors';\nimport { getProjectIdResult } from '../../store/config/selectors';\nimport { combineData, handle } from '../../store/utils';\nimport { EmulatorDisabled } from '../common/EmulatorDisabled';\nimport { Spinner } from '../common/Spinner';\nimport OneAccountPerEmailCard from './OneAccountPerEmailCard/OneAccountPerEmailCard';\nimport ClearAll from './UsersCard/ClearAll';\nimport UsersCard from './UsersCard/UsersCard';\n\nexport const mapStateToProps = createStructuredSelector({\n  projectIdResult: getProjectIdResult,\n  authConfigResult: getAuthConfigResult,\n  authUsersResult: getAuthUsersResult,\n});\n\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport const AuthRoute: React.FC<PropsFromState> = ({\n  projectIdResult,\n  authConfigResult,\n}) => {\n  // HACK(yuchenshi): We do not switch on authUsersResult to make sure Auth\n  // Emulator correctly shows up as disabled (instead of forever loading).\n  // TODO(yuchenshi): Fix forever loading in store when auth is disabled.\n  return handle(combineData(projectIdResult, authConfigResult), {\n    onNone: () => <Spinner span={12} message=\"Auth Emulator Loading...\" />,\n    onError: () => <AuthRouteDisabled />,\n    onData: ([projectId, config]) =>\n      config === undefined ? <AuthRouteDisabled /> : <Auth />,\n  });\n};\n\nexport const Auth: React.FC = () => (\n  <GridCell span={12} className=\"Auth\">\n    <ClearAll />\n    <Elevation z=\"2\" wrap>\n      <UsersCard />\n    </Elevation>\n    <Elevation z=\"2\" wrap>\n      <OneAccountPerEmailCard />\n    </Elevation>\n  </GridCell>\n);\n\nexport const AuthRouteDisabled: React.FC = () => (\n  <EmulatorDisabled productName=\"Auth\" />\n);\n\nexport default connect(mapStateToProps)(AuthRoute);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport 'firebase/database';\n\nimport { _FirebaseApp } from '@firebase/app-types/private';\nimport { FirebaseAuthInternal } from '@firebase/auth-interop-types';\nimport { Component, ComponentType } from '@firebase/component';\nimport firebase from 'firebase/app';\nimport { useEffect, useMemo } from 'react';\n\nimport { DatabaseConfig } from './store/config';\nimport { useProjectId } from './store/config/selectors';\n\ninterface WindowWithDb extends Window {\n  database?: firebase.database.Database;\n  firestore?: firebase.firestore.Firestore;\n}\n\nexport function initDatabase(\n  config: DatabaseConfig,\n  namespace: string\n): [firebase.database.Database, { cleanup: () => Promise<void> }] {\n  const databaseURL = `http://${config.hostAndPort}/?ns=${namespace}`;\n  const app = firebase.initializeApp(\n    { databaseURL },\n    `Database Component: ${databaseURL} ${Math.random()}`\n  );\n  applyAdminAuth(app);\n  const db = app.database();\n  // only log the first time\n  if (!(window as WindowWithDb).database) {\n    console.log(`🔥 Realtime Database is available at window.database.\n\n    Try:\n    database.ref().set({hello: 'world!'});\n    database.ref().once('value').then( snap => console.log(snap.val()) );`);\n  }\n  (window as WindowWithDb).database = db;\n  return [db, { cleanup: () => app.delete() }];\n}\n\nexport function useEmulatedFirebaseApp(name: string, config: any) {\n  const projectId = useProjectId();\n\n  const app = useMemo(() => {\n    const app = firebase.initializeApp(\n      { ...config, projectId },\n      `${name} component::${Math.random()}`\n    );\n    applyAdminAuth(app);\n    return app;\n  }, [name, config, projectId]);\n\n  useEffect(() => {\n    return () => {\n      app.delete();\n    };\n  }, [app]);\n\n  return app;\n}\n\nfunction applyAdminAuth(app: firebase.app.App): void {\n  const accessToken = 'owner'; // Accepted as admin by emulators.\n  const mockAuthComponent = new Component(\n    'auth-internal',\n    () =>\n      ({\n        getToken: async () => ({ accessToken: accessToken }),\n        getUid: () => null,\n        addAuthTokenListener: (listener) => {\n          // Call listener once immediately with predefined\n          // accessToken.\n          listener(accessToken);\n        },\n        removeAuthTokenListener: () => {},\n      } as FirebaseAuthInternal),\n    'PRIVATE' as ComponentType\n  );\n\n  ((app as unknown) as _FirebaseApp)._addOrOverwriteComponent(\n    mockAuthComponent\n  );\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './BreadCrumbs.scss';\n\nimport { IconButton } from '@rmwc/icon-button';\nimport classnames from 'classnames';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nexport interface Props {\n  /** The base url to prepend when creating Router links */\n  base: string;\n  path: string;\n  onEdit?: () => void;\n}\n\nconst EMPTY_KEYS: string[] = [];\n\nexport const BreadCrumbs: React.FC<Props> = ({\n  base,\n  path,\n  onEdit,\n  children,\n}) => {\n  const normalizedPath = path.startsWith('/') ? path.substr(1) : path;\n  const keys = normalizedPath ? normalizedPath.split('/') : EMPTY_KEYS;\n\n  const hrefs = keys.reduce<string[]>((acc, key) => {\n    const prevLink = acc.length ? acc[acc.length - 1] : base;\n    acc.push(`${prevLink}/${key}`);\n    return acc;\n  }, []);\n\n  return (\n    <ul role=\"navigation\" className=\"BreadCrumbs\">\n      <li className=\"BreadCrumbs-crumb\">\n        <IconButton icon=\"home\" tag={Link} to={base} />\n      </li>\n\n      {keys.map((key, i) => (\n        <li\n          key={hrefs[i]}\n          className={classnames('BreadCrumbs-crumb', 'BreadCrumbs-link', {\n            'BreadCrumbs-active': i === keys.length - 1,\n          })}\n        >\n          <Link to={hrefs[i]}>{decodeURIComponent(key)}</Link>\n        </li>\n      ))}\n\n      <li\n        className=\"BreadCrumbs-edit\"\n        aria-label=\"Edit URL\"\n        onClick={() => onEdit && onEdit()}\n      >\n        <IconButton icon=\"edit\" />\n      </li>\n      <li>{children}</li>\n    </ul>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './InteractiveBreadCrumbBar.scss';\n\nimport { Elevation } from '@rmwc/elevation';\nimport { IconButton } from '@rmwc/icon-button';\nimport { TextField } from '@rmwc/textfield';\nimport { Typography } from '@rmwc/typography';\nimport useKey from '@rooks/use-key';\nimport React, { useEffect, useLayoutEffect, useRef, useState } from 'react';\n\nimport { Props as BreadCrumbProps, BreadCrumbs } from './BreadCrumbs';\nimport { CardActionBar } from './CardActionBar';\n\ninterface Props extends BreadCrumbProps {\n  /** The input prefix to show before the editable input */\n  inputPrefix?: string;\n  onNavigate: (path: string) => void;\n}\n\nexport const InteractiveBreadCrumbBar: React.FC<Props> = ({\n  onNavigate,\n  children,\n  inputPrefix,\n  path,\n  ...breadCrumbProps\n}) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [value, setValue] = useState(path);\n\n  // Update input's path value if path prop changes\n  useEffect(() => setValue(path), [path]);\n\n  const handleSubmit = () => {\n    const normalizedPath = value.startsWith('/') ? value.substr(1) : value;\n    onNavigate(normalizedPath);\n    setIsEditing(false);\n  };\n\n  const handleEdit = () => {\n    setIsEditing(true);\n  };\n\n  const handleCancel = () => {\n    setIsEditing(false);\n    setValue(path);\n  };\n\n  const inputRef = useRef<HTMLInputElement>(null);\n  useKey(['Escape'], handleCancel, {\n    eventTypes: ['keypress', 'keydown', 'keyup'],\n    target: inputRef,\n    when: true,\n  });\n\n  useLayoutEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.select();\n    }\n  }, [isEditing, inputRef]);\n\n  return (\n    <div className=\"InteractiveBreadCrumbBar\">\n      {isEditing ? (\n        <Elevation z={1} wrap>\n          <form\n            className=\"InteractiveBreadCrumbBar-form\"\n            onSubmit={() => handleSubmit()}\n          >\n            {inputPrefix && (\n              <Typography\n                use=\"body2\"\n                className=\"InteractiveBreadCrumbBar-prefix\"\n                theme=\"secondary\"\n              >\n                {inputPrefix}\n              </Typography>\n            )}\n            <TextField\n              aria-label=\"Document path\"\n              fullwidth\n              className=\"value\"\n              type=\"text\"\n              value={value}\n              onChange={(e) => setValue(e.currentTarget.value)}\n              inputRef={inputRef}\n            />\n            <IconButton\n              label=\"Cancel\"\n              type=\"button\"\n              icon=\"close\"\n              onClick={handleCancel}\n              theme=\"secondary\"\n            />\n          </form>\n        </Elevation>\n      ) : (\n        <CardActionBar className=\"top\">\n          <BreadCrumbs path={path} {...breadCrumbProps} onEdit={handleEdit}>\n            {children}\n          </BreadCrumbs>\n        </CardActionBar>\n      )}\n    </div>\n  );\n};\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport firebase from 'firebase';\n\nimport { initDatabase } from '../../firebase';\nimport { DatabaseConfig } from '../../store/config';\nimport { RestApi } from '../common/rest_api';\n\nexport class DatabaseApi extends RestApi {\n  private readonly baseUrl: string;\n  private cleanup: () => Promise<void>;\n  readonly database: firebase.database.Database;\n\n  constructor(config: DatabaseConfig, private readonly namespace: string) {\n    super();\n    const [database, { cleanup }] = initDatabase(config, this.namespace);\n    this.database = database;\n    this.cleanup = cleanup;\n    this.baseUrl = `http://${config.hostAndPort}`;\n  }\n\n  delete(): Promise<void> {\n    return this.cleanup();\n  }\n\n  /**\n   * Import a file at a specific path within the current database.\n   */\n  async importFile(ref: firebase.database.Reference, file: File) {\n    const params = new URLSearchParams({\n      ns: this.namespace,\n      // Pass token in query since headers triggers CORS.\n      access_token: 'owner',\n    });\n    const path = getUploadPath(ref) + `?${params.toString()}`;\n    return await this.postFile(`${this.baseUrl}/${path}`, file);\n  }\n}\n\n/** Get absolute path for file upload (the path with `.upload` appended) */\nfunction getUploadPath(ref: firebase.database.Reference) {\n  const absolutePath = new URL(ref.toString()).pathname;\n  // trim leading and trailing slashes\n  let path = absolutePath.replace(/^\\//, '').replace(/\\/$/, '');\n  if (path !== '') {\n    path = path + '/';\n  }\n  path += '.upload';\n  return path;\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\n\n/**\n * Max nodes shown underneath each\n */\nexport const DEFAULT_PAGE_SIZE = 50;\n\nexport const NO_CHILDREN: string[] = [];\n\nexport interface ViewModel {\n  isLoading: boolean;\n  isRealtime?: boolean;\n  value?: string;\n  children: string[];\n  query?: firebase.database.Query;\n}\n\nexport interface QueryParams {\n  key?: string;\n  operator?: '>=' | '==' | '<=';\n  value?: string;\n  limit?: number;\n}\n\nexport const DEFAULT_QUERY_PARAMS: QueryParams = {\n  limit: DEFAULT_PAGE_SIZE,\n};\n\nexport enum ChildrenDisplayType {\n  Table = 'table',\n  TreeView = 'tree',\n}\n\n/** Try to json parse a value, else assume string. */\nexport function jsonIshValue(value: string) {\n  try {\n    return JSON.parse(value);\n  } catch (e) {\n    return value;\n  }\n}\n\n/** Extra internal props on db Reference. */\ninterface RefWithInternals extends firebase.database.Reference {\n  database: firebase.database.Database;\n}\n\n/** Use some internals to determine the full url with `?ns=x` param. */\nexport function getDbRootUrl(ref: firebase.database.Reference) {\n  const options = (ref as RefWithInternals).database.app.options as Record<\n    string,\n    string\n  >;\n  return options['databaseURL'];\n}\n","import './Field.scss';\nimport './FileField.scss';\n\nimport { randomId } from '@rmwc/base';\nimport { Button } from '@rmwc/button';\nimport { HTMLProps } from '@rmwc/types';\nimport { Typography } from '@rmwc/typography';\nimport React, { useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\n\ntype FileFieldProps = {\n  tip?: string;\n  error?: string;\n  onFiles?: (files: File[]) => void;\n} & HTMLProps<HTMLInputElement>;\n\nconst DROP_MESSAGE = 'Drop file(s) here';\nconst INVALID_FILE_MESSAGE = 'File type is not accepted';\n\nexport const FileField: React.FC<FileFieldProps> = ({\n  label,\n  tip,\n  error,\n  onFiles,\n  value,\n  accept,\n}) => {\n  const [id] = useState(randomId());\n\n  const {\n    isDragActive,\n    getRootProps,\n    getInputProps,\n    isDragReject,\n  } = useDropzone({\n    onDrop: onFiles,\n    accept,\n  });\n\n  return (\n    <div className=\"Field\">\n      {/* hidden input */}\n      <Typography\n        className=\"Field-label\"\n        use=\"body2\"\n        theme=\"secondary\"\n        tag=\"label\"\n        htmlFor={id}\n      >\n        {label}\n      </Typography>\n\n      <div\n        className=\"Field-filename\"\n        {...getRootProps()}\n        data-testid=\"dropzone\"\n      >\n        <input {...getInputProps({ id })} />\n        <Typography use=\"body2\" theme=\"secondary\">\n          {isDragActive\n            ? isDragReject\n              ? INVALID_FILE_MESSAGE\n              : DROP_MESSAGE\n            : value}\n        </Typography>\n        <Button type=\"button\">Browse</Button>\n      </div>\n      <div className=\"Field-subtext\">\n        {error ? (\n          <Typography\n            className=\"Field-tip\"\n            use=\"body2\"\n            theme=\"error\"\n            role=\"alert\"\n          >\n            {error}\n          </Typography>\n        ) : (\n          tip && (\n            <Typography className=\"Field-tip\" use=\"body2\" theme=\"secondary\">\n              {tip}\n            </Typography>\n          )\n        )}\n      </div>\n    </div>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  Dialog,\n  DialogActions,\n  DialogButton,\n  DialogContent,\n  DialogTitle,\n} from '@rmwc/dialog';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useState } from 'react';\n\nimport { Callout } from '../../common/Callout';\nimport { Field } from '../../common/Field';\nimport { FileField } from '../../common/FileField';\nimport { Spinner } from '../../common/Spinner';\nimport { DatabaseApi } from '../api';\nimport styles from './ImportDialog.module.scss';\n\nexport interface Props {\n  api: DatabaseApi;\n  reference: firebase.database.Reference;\n  droppedFile?: File;\n  onComplete: (reference?: firebase.database.Reference, file?: File) => void;\n}\n\nexport const ImportDialog: React.FC<Props> = ({\n  api,\n  reference,\n  onComplete,\n  droppedFile,\n}) => {\n  const [file, setFile] = useState<File | undefined>(droppedFile);\n  const [isImporting, setIsImporting] = useState(false);\n  const [error, setError] = useState();\n\n  const onSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    if (file) {\n      try {\n        setIsImporting(true);\n        await api.importFile(reference, file);\n        onComplete(reference, file);\n      } catch (e) {\n        setError(e.message);\n      }\n      setIsImporting(false);\n    }\n  };\n\n  const path = new URL(reference.toString()).pathname;\n\n  return (\n    <Dialog renderToPortal open onClose={() => onComplete()}>\n      <form onSubmit={onSubmit} className={styles.container}>\n        <DialogTitle>Import JSON</DialogTitle>\n        <DialogContent onSubmit={onSubmit}>\n          <Callout aside type=\"warning\">\n            All data at this location will be overwritten\n          </Callout>\n          <Callout aside type=\"caution\">\n            If the Functions emulator is running, database functions will be\n            executed.\n          </Callout>\n          <Field\n            disabled\n            name=\"location\"\n            label=\"Data location\"\n            value={path}\n            type=\"text\"\n          />\n          <FileField\n            name=\"file\"\n            accept=\"application/json\"\n            label=\"Data (JSON)\"\n            required\n            value={file?.name || 'Drop a file, or click to select'}\n            onFiles={(files) => setFile(files[0])}\n            error={error}\n          />\n        </DialogContent>\n        <DialogActions>\n          <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n            Cancel\n          </DialogButton>\n          <DialogButton type=\"submit\" unelevated>\n            Import\n          </DialogButton>\n        </DialogActions>\n      </form>\n      {isImporting && <Spinner cover scrim message=\"Importing...\" />}\n    </Dialog>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\nimport { Observable, ReplaySubject, defer, from, of } from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  map,\n  mapTo,\n  shareReplay,\n  switchMap,\n} from 'rxjs/operators';\n\nimport {\n  DEFAULT_PAGE_SIZE,\n  QueryParams,\n  ViewModel,\n  getDbRootUrl,\n} from './view_model';\n\n/**\n * Timeout for silent call, which should determine if the data is\n * safely loadable at the current node\n */\nconst REST_TIMEOUT = `1s`;\n\nconst NO_CHILDREN: string[] = [];\n\n// Accepted as admin by Realtime Database Emulator.\nconst ADMIN_AUTH_HEADERS = { Authorization: 'Bearer owner' };\n\n/**\n * Creates an observable view model and query subject. The view model will\n * update when the query emits/changes.\n */\nexport function createViewModel(\n  ref: firebase.database.Reference,\n  canDoRealtime$: Observable<boolean>\n) {\n  const query = new ReplaySubject<QueryParams>(1);\n  query.next({ limit: DEFAULT_PAGE_SIZE });\n  const viewModel$ = query.pipe(\n    switchMap((queryParams) => {\n      return canDoRealtime$.pipe(\n        concatMap((realtime) =>\n          realtime\n            ? realtimeToViewModel(ref, queryParams)\n            : nonRealtimeToViewModel(ref, queryParams)\n        )\n      );\n    })\n  );\n  return { query, viewModel$ };\n}\n\n/**\n * Checks if realtime is possible at the node. Only checks once for the current\n * node.\n */\nexport function canDoRealtime(\n  realtimeRef: firebase.database.Reference\n): Observable<boolean> {\n  const silent = restUrl(realtimeRef, {\n    print: 'silent',\n    timeout: REST_TIMEOUT,\n  });\n  return defer(() => fetch(silent, { headers: ADMIN_AUTH_HEADERS })).pipe(\n    mapTo(true),\n    catchError(() => of(false)),\n    shareReplay({ bufferSize: 1, refCount: true })\n  );\n}\n\nfunction realtimeToViewModel(\n  ref: firebase.database.Reference,\n  queryParams: QueryParams\n) {\n  let query: firebase.database.Query;\n  return once(ref).pipe(\n    switchMap((snap) => {\n      // The \"default\" query contains limitToFirst(50), so we can not blindly\n      // apply the query to leaf nodes. leafNodeRef.limitToFirst(n) will yield\n      // null data.\n      if (snap.hasChildren()) {\n        query = applyQuery(ref, queryParams);\n        return toObservable(query);\n      }\n      return toObservable(ref);\n    }),\n    map(\n      (snap): ViewModel => ({\n        value: snap.hasChildren() ? undefined : snap.val(),\n        children: snap.hasChildren() ? Object.keys(snap.val()) : NO_CHILDREN,\n        isRealtime: true,\n        isLoading: false,\n        query,\n      })\n    )\n  );\n}\n\nfunction nonRealtimeToViewModel(\n  ref: firebase.database.Reference,\n  queryParams: QueryParams\n): Observable<ViewModel> {\n  return fetchNonRealtime(ref, queryParams).pipe(\n    map(\n      (children): ViewModel => ({\n        children,\n        isLoading: false,\n        isRealtime: false,\n      })\n    )\n  );\n}\n\nfunction once(query: firebase.database.Query) {\n  return from(query.once('value'));\n}\n\nfunction toObservable(query: firebase.database.Query) {\n  return new Observable<firebase.database.DataSnapshot>((o) => {\n    const handler = query.on('value', (snapshot) => o.next(snapshot));\n    return () => query.off('value', handler);\n  });\n}\n\nexport function applyQuery(\n  ref: firebase.database.Reference,\n  params: QueryParams\n): firebase.database.Query {\n  const { key, operator, value, limit } = params;\n  // Check the existence value instead of it being falsy. This prevents bugs\n  // where the \"value\" is actually false.\n  // ex: { key: \"completed\", operator: \"==\", value: \"false\" }\n  if (key != null && operator != null && value != null) {\n    let query = ref.orderByChild(key).limitToFirst(limit || DEFAULT_PAGE_SIZE);\n    switch (operator) {\n      case '==':\n        return query.equalTo(value);\n      case '<=':\n        return query.endAt(value);\n      case '>=':\n        return query.startAt(value);\n    }\n  }\n  return ref.limitToFirst(limit || DEFAULT_PAGE_SIZE);\n}\n\n/** Use REST to fetch the children for a node */\nfunction fetchNonRealtime(\n  realtimeRef: firebase.database.Reference,\n  query: QueryParams\n): Observable<string[]> {\n  const params = getRestQueryParams(query);\n  const shallow = restUrl(realtimeRef, { ...params, shallow: 'true' });\n  return defer(() => fetch(shallow, { headers: ADMIN_AUTH_HEADERS })).pipe(\n    map((r) => r.json()),\n    map((data) => Object.keys(data))\n  );\n}\n\ninterface RestQueryParams {\n  orderBy?: string;\n  limitToFirst: string;\n  equalTo?: string;\n  endAt?: string;\n  startAt?: string;\n}\n\nfunction getRestQueryParams(query: QueryParams): RestQueryParams {\n  const { key, operator, value, limit } = query;\n\n  const params: RestQueryParams = {\n    orderBy: key,\n    limitToFirst: `${limit || DEFAULT_PAGE_SIZE}`,\n  };\n\n  if (key && operator && value) {\n    switch (operator) {\n      case '==':\n        params.equalTo = value;\n        break;\n      case '<=':\n        params.endAt = value;\n        break;\n      case '>=':\n        params.startAt = value;\n        break;\n    }\n  }\n\n  return params;\n}\n\nfunction restUrl(\n  ref: firebase.database.Reference,\n  params: Record<string, string | undefined>\n): string {\n  const rootUrl = getDbRootUrl(ref);\n\n  // TODO(yuchenshi): Find some cross-browser and lightweight way to parse query.\n  if (rootUrl.indexOf('?ns=') >= 0) {\n    const ns = rootUrl.split('?ns=')[1];\n    params = { ...params, ns };\n  }\n\n  const query = Object.entries(params)\n    .filter(([key, value]) => !!value)\n    .map(([key, value]) => `${key}=${encodeURIComponent(value!)}`)\n    .join('&');\n  return `${ref.toString()}.json?${query}`;\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createAction } from 'typesafe-actions';\n\nimport { FieldType } from '../models';\nimport { JSONField, PrimitiveValue } from './types';\n\nexport const addToMap = createAction('@document/addToMap')<{\n  uuid: number;\n  name: string;\n  value: PrimitiveValue;\n}>();\nexport const addToArray = createAction('@document/addToArray')<{\n  uuid: number;\n  value: PrimitiveValue;\n}>();\n// TODO\nexport const removeFromMap = createAction('@document/removeFromMap')<{\n  uuid: number;\n  childId: number;\n}>();\n// TODO\nexport const removeFromArray = createAction('@document/removeFromArray')<{\n  uuid: number;\n  childId: number;\n}>();\nexport const updateName = createAction('@document/updateName')<{\n  uuid: number;\n  childId: number;\n  name: string;\n}>();\nexport const updateType = createAction('@document/updateType')<{\n  uuid: number;\n  type: FieldType;\n}>();\nexport const updateValue = createAction('@document/updateValue')<{\n  uuid: number;\n  value: PrimitiveValue | JSONField['value'];\n}>();\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { SelectField } from '../../common/Field';\n\nconst BooleanEditor: React.FC<{\n  value: boolean;\n  onChange: (value: boolean) => void;\n}> = ({ value, onChange }) => {\n  return (\n    <SelectField\n      label=\"Value\"\n      value={value.toString()}\n      options={['true', 'false']}\n      onChange={(e) => {\n        onChange(e.currentTarget.value === 'true');\n      }}\n    />\n  );\n};\n\nexport default BooleanEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\nimport React, { useEffect, useState } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Field } from '../../common/Field';\n\nconst GeoPointEditor: React.FC<{\n  name: string;\n  value: firebase.firestore.GeoPoint;\n  onChange: (value: firebase.firestore.GeoPoint) => void;\n}> = ({ name, value, onChange }) => {\n  const [latitude, setLatitude] = useState(String(value.latitude));\n  const [longitude, setLongitude] = useState(String(value.longitude));\n  const {\n    errors,\n    formState: { touched },\n    register,\n    unregister,\n    setValue,\n  } = useFormContext();\n\n  const latitudeName = `${name}-lat`;\n  const longitudeName = `${name}-long`;\n\n  useEffect(() => {\n    register(latitudeName, {\n      required: 'Required',\n      min: {\n        value: -90,\n        message: 'Must be >= -90',\n      },\n      max: {\n        value: 90,\n        message: 'Must be <= -90',\n      },\n    });\n\n    register(longitudeName, {\n      required: 'Required',\n      min: {\n        value: -180,\n        message: 'Must be >= -180',\n      },\n      max: {\n        value: 180,\n        message: 'Must be <= -180',\n      },\n    });\n\n    return () => unregister([latitudeName, longitudeName]);\n  }, [register, unregister, latitudeName, longitudeName]);\n\n  useEffect(() => {\n    const lat = Number(latitude);\n    const long = Number(longitude);\n    if (value.latitude === lat && value.longitude === long) {\n      return;\n    }\n\n    try {\n      // Update the parent when _both_ fields are valid\n      const geoPoint = new firebase.firestore.GeoPoint(lat, long);\n      onChange(geoPoint);\n    } catch {}\n  }, [value, latitude, longitude, onChange]);\n\n  return (\n    <div className=\"FieldEditor-geo-point\">\n      <Field\n        label=\"Latitude\"\n        type=\"number\"\n        step=\"any\"\n        defaultValue={latitude}\n        onChange={(e) => {\n          setValue(latitudeName, e.currentTarget.value, true);\n          setLatitude(e.currentTarget.value);\n        }}\n        error={touched[latitudeName] && errors[latitudeName]?.message}\n      />\n\n      <Field\n        label=\"Longitude\"\n        type=\"number\"\n        step=\"any\"\n        defaultValue={longitude}\n        onChange={(e) => {\n          setValue(longitudeName, e.currentTarget.value, true);\n          setLongitude(e.currentTarget.value);\n        }}\n        error={touched[longitudeName] && errors[longitudeName]?.message}\n      />\n    </div>\n  );\n};\n\nexport default GeoPointEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Field } from '../../common/Field';\nimport { FirestoreAny } from '../models';\n\nconst JsonEditor: React.FC<{\n  value: FirestoreAny;\n  onChange: (value: FirestoreAny) => void;\n  name: string;\n}> = ({ value, onChange, name }) => {\n  const [initialValue] = useState(JSON.stringify(value));\n  const {\n    errors,\n    formState: { touched },\n    register,\n    unregister,\n    setValue,\n    triggerValidation,\n  } = useFormContext();\n\n  useEffect(() => {\n    register(name, {\n      validate: (e) => {\n        try {\n          JSON.parse(e);\n          return true;\n        } catch {\n          return 'Must be valid JSON';\n        }\n      },\n    });\n\n    return () => unregister(name);\n  }, [register, unregister, name]);\n\n  async function handleChange(value: string) {\n    if (await triggerValidation(name)) {\n      onChange(JSON.parse(value));\n    }\n  }\n\n  return (\n    <Field\n      label=\"JSON\"\n      defaultValue={initialValue}\n      onChange={(e) => {\n        setValue(name, e.currentTarget.value);\n        handleChange(e.currentTarget.value);\n      }}\n      error={touched[name] && errors[name]?.message}\n    />\n  );\n};\n\nexport default JsonEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Field } from '../../common/Field';\nimport { NUMBER_REGEX } from '../utils';\n\nconst NumberEditor: React.FC<{\n  value: number;\n  onChange: (value: number) => void;\n  name: string;\n}> = ({ value, onChange, name }) => {\n  const {\n    errors,\n    formState: { touched },\n    register,\n    unregister,\n    setValue,\n    triggerValidation,\n  } = useFormContext();\n\n  useEffect(() => {\n    register(name, {\n      required: 'Required',\n      pattern: {\n        value: NUMBER_REGEX,\n        message: 'Must be a number',\n      },\n    });\n\n    return () => unregister(name);\n  }, [register, unregister, name]);\n\n  async function handleChange(value: string) {\n    if (await triggerValidation(name)) {\n      onChange(parseFloat(value));\n    }\n  }\n\n  return (\n    <Field\n      label=\"Value\"\n      defaultValue={value}\n      onChange={(e) => {\n        setValue(name, e.currentTarget.value);\n        handleChange(e.currentTarget.value);\n      }}\n      error={touched[name] && errors[name]?.message}\n    />\n  );\n};\n\nexport default NumberEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport { useFirestore } from 'reactfire';\n\nimport { Field } from '../../common/Field';\nimport { DocumentPath } from './types';\n\nconst ReferenceEditor: React.FC<{\n  value: DocumentPath;\n  onChange: (value: DocumentPath) => void;\n  name: string;\n}> = ({ value, onChange, name }) => {\n  const [path] = useState(value.path);\n  const firestore = useFirestore();\n  const {\n    errors,\n    formState: { touched },\n    register,\n    unregister,\n    setValue,\n    triggerValidation,\n  } = useFormContext();\n\n  useEffect(() => {\n    register(name, {\n      validate: (e) => {\n        try {\n          firestore.doc(e);\n          return true;\n        } catch {\n          return 'Must point to a document';\n        }\n      },\n    });\n\n    return () => unregister(name);\n  }, [register, unregister, name, firestore]);\n\n  async function handleChange(value: string) {\n    if (await triggerValidation(name)) {\n      onChange(new DocumentPath(value));\n    }\n  }\n\n  return (\n    <Field\n      label=\"Document path\"\n      defaultValue={path}\n      onChange={(e) => {\n        setValue(name, e.currentTarget.value);\n        handleChange(e.currentTarget.value);\n      }}\n      error={touched[name] && errors[name]?.message}\n    />\n  );\n};\n\n// api.doc(path)\n\nexport default ReferenceEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport produce from 'immer';\nimport * as React from 'react';\nimport { Action, createReducer } from 'typesafe-actions';\n\nimport { FieldType } from '../models';\nimport * as actions from './actions';\nimport {\n  Field,\n  Store,\n  assertIsArrayField,\n  assertIsMapField,\n  assertIsPrimitiveField,\n  assertStoreHasRoot,\n} from './types';\nimport {\n  defaultValueForPrimitiveType,\n  getDescendantIds,\n  getUniqueId,\n  normalize,\n} from './utils';\n\nconst INIT_STATE = { fields: {} };\n\nconst documentStoreContext = React.createContext<{\n  store: Store;\n  dispatch: React.Dispatch<any>;\n}>({ store: INIT_STATE, dispatch: () => {} });\n\nexport const reducer = createReducer<Store, Action>({ fields: {} })\n  .handleAction(\n    actions.addToMap,\n    produce((draft, { payload }) => {\n      const field = draft.fields[payload.uuid];\n      assertIsMapField(field);\n      const normalized = normalize(payload.value);\n      assertStoreHasRoot(normalized);\n      draft.fields = {\n        ...draft.fields,\n        ...normalized.fields,\n      };\n      field.mapChildren.push({\n        uuid: getUniqueId(),\n        name: payload.name,\n        valueId: normalized.uuid,\n      });\n    })\n  )\n  .handleAction(\n    actions.addToArray,\n    produce((draft, { payload }) => {\n      const field = draft.fields[payload.uuid];\n      assertIsArrayField(field);\n      const normalized = normalize(payload.value);\n      assertStoreHasRoot(normalized);\n      draft.fields = {\n        ...draft.fields,\n        ...normalized.fields,\n      };\n      draft.fields[payload.uuid].arrayChildren.push({\n        uuid: getUniqueId(),\n        valueId: normalized.uuid,\n      });\n    })\n  )\n  .handleAction(\n    actions.removeFromMap,\n    produce((draft, { payload }) => {\n      const field = draft.fields[payload.uuid];\n      assertIsMapField(field);\n      const child = field.mapChildren.find((c) => c.uuid === payload.childId);\n      if (!child) {\n        throw new Error('No map-child found with given ID');\n      }\n\n      // Remove any descendants\n      for (const uuid of getDescendantIds(draft.fields, [child.valueId])) {\n        delete draft.fields[uuid];\n      }\n\n      // Remove reference from parent\n      field.mapChildren = field.mapChildren.filter(\n        (c) => c.uuid !== payload.childId\n      );\n    })\n  )\n  .handleAction(\n    actions.removeFromArray,\n    produce((draft, { payload }) => {\n      const field = draft.fields[payload.uuid];\n      assertIsArrayField(field);\n      const child = field.arrayChildren.find((c) => c.uuid === payload.childId);\n      if (!child) {\n        throw new Error('No array-child found with given ID');\n      }\n\n      // Remove any descendants\n      for (const uuid of getDescendantIds(draft.fields, [child.valueId])) {\n        delete draft.fields[uuid];\n      }\n\n      // Remove reference from parent\n      field.arrayChildren = field.arrayChildren.filter(\n        (c) => c.uuid !== payload.childId\n      );\n    })\n  )\n  .handleAction(\n    actions.updateName,\n    produce((draft, { payload }) => {\n      const field = draft.fields[payload.uuid];\n      assertIsMapField(field);\n      const childField = field.mapChildren.find(\n        (c) => c.uuid === payload.childId\n      );\n      if (!childField) {\n        throw new Error('No map-child found with given ID');\n      }\n      childField.name = payload.name;\n    })\n  )\n  .handleAction(\n    actions.updateType,\n    produce((draft, { payload }) => {\n      if (payload.type === FieldType.MAP) {\n        draft.fields[payload.uuid] = { mapChildren: [] };\n      } else if (payload.type === FieldType.ARRAY) {\n        draft.fields[payload.uuid] = { arrayChildren: [] };\n      } else if (payload.type === FieldType.JSON) {\n        draft.fields[payload.uuid] = { isJson: true, value: {} };\n      } else {\n        draft.fields[payload.uuid] = {\n          value: defaultValueForPrimitiveType(payload.type),\n        };\n      }\n    })\n  )\n  .handleAction(\n    actions.updateValue,\n    produce((draft, { payload }) => {\n      const field = draft.fields[payload.uuid];\n      assertIsPrimitiveField(field);\n      field.value = payload.value;\n    })\n  );\n\nexport const storeReducer: React.Reducer<Store, Action> = (state, action) => {\n  return (reducer.handlers as any)[action.type](state, action);\n};\n\nexport const DocumentStore: React.FC<{\n  store: Store;\n  dispatch: React.Dispatch<Action>;\n}> = ({ store, dispatch, children }) => {\n  return (\n    <documentStoreContext.Provider value={{ store, dispatch }}>\n      {children}\n    </documentStoreContext.Provider>\n  );\n};\n\nexport function useDocumentStore(): {\n  store: Store;\n  dispatch: React.Dispatch<Action>;\n} {\n  const context = React.useContext(documentStoreContext);\n  if (context === undefined) {\n    throw new Error('useDocumentStore must be used within a <DocumentStore>');\n  }\n  return context;\n}\n\nexport function useStore(): Store {\n  const { store } = useDocumentStore();\n  return React.useMemo(() => store, [store]);\n}\n\nexport function useDispatch(): React.Dispatch<Action> {\n  const { dispatch } = useDocumentStore();\n  return React.useMemo(() => dispatch, [dispatch]);\n}\n\nexport function useField(uuid: number): Field {\n  const store = useStore();\n  return React.useMemo(() => store.fields[uuid], [store, uuid]);\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport { Field } from '../../common/Field';\n\nconst StringEditor: React.FC<{\n  value: string;\n  onChange: (value: string) => void;\n}> = ({ value, onChange }) => {\n  return (\n    <Field\n      value={value}\n      outlined\n      label=\"Value\"\n      onChange={(e) => onChange(e.currentTarget.value)}\n    />\n  );\n};\n\nexport default StringEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\nimport React, { useEffect, useState } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Field } from '../../common/Field';\n\nfunction dateToLocale(date: Date): string {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const dateOfMonth = String(date.getDate()).padStart(2, '0');\n  const hours = String(date.getHours()).padStart(2, '0');\n  const minutes = String(date.getMinutes()).padStart(2, '0');\n  const seconds = String(date.getSeconds()).padStart(2, '0');\n\n  return `${year}-${month}-${dateOfMonth}T${hours}:${minutes}:${seconds}`;\n}\n\n// TODO: update to a date-picker that potentially supports time-zones\nconst TimestampEditor: React.FC<{\n  value: firebase.firestore.Timestamp;\n  onChange: (value: firebase.firestore.Timestamp) => void;\n  name: string;\n}> = ({ value, onChange, name }) => {\n  const [date, setDate] = useState(value.toDate());\n\n  const {\n    errors,\n    formState: { touched },\n    register,\n    unregister,\n    setValue,\n  } = useFormContext();\n\n  useEffect(() => {\n    register(name, {\n      validate: (e) => !isNaN(e) || 'Must be a date-time',\n    });\n\n    return () => unregister(name);\n  }, [register, unregister, name]);\n\n  useEffect(() => {\n    if (value.toMillis() !== date.getTime()) {\n      onChange(firebase.firestore.Timestamp.fromDate(date));\n    }\n  }, [value, date, onChange]);\n\n  return (\n    <Field\n      label=\"Value\"\n      type=\"datetime-local\"\n      defaultValue={dateToLocale(date)}\n      onChange={(e) => {\n        const timestamp = Date.parse(e.currentTarget.value);\n        setValue(name, timestamp, true);\n        if (!isNaN(timestamp) && timestamp !== date.getTime()) {\n          setDate(new Date(timestamp));\n        }\n      }}\n      error={touched[name] && errors[name]?.message}\n    />\n  );\n};\n\nexport default TimestampEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport { IconButton } from '@rmwc/icon-button';\nimport firebase from 'firebase';\nimport React, { useEffect } from 'react';\nimport { FormContext, useForm, useFormContext } from 'react-hook-form';\n\nimport { Field, SelectField } from '../../common/Field';\nimport { FieldType, FirestoreAny, FirestoreMap } from '../models';\nimport {\n  getFieldType,\n  isBoolean,\n  isGeoPoint,\n  isNumber,\n  isString,\n  isTimestamp,\n} from '../utils';\nimport * as actions from './actions';\nimport BooleanEditor from './BooleanEditor';\nimport GeoPointEditor from './GeoPointEditor';\nimport JsonEditor from './JsonEditor';\nimport NumberEditor from './NumberEditor';\nimport ReferenceEditor from './ReferenceEditor';\nimport {\n  DocumentStore,\n  storeReducer,\n  useDispatch,\n  useField,\n  useStore,\n} from './store';\nimport StringEditor from './StringEditor';\nimport TimestampEditor from './TimestampEditor';\nimport {\n  Field as DocumentField,\n  DocumentPath,\n  MapField,\n  isArrayField,\n  isJSONField,\n  isMapField,\n} from './types';\nimport { denormalize, normalize } from './utils';\n\nconst FIRESTORE_FIELD_TYPES = [\n  FieldType.STRING,\n  FieldType.NUMBER,\n  FieldType.BOOLEAN,\n  FieldType.MAP,\n  FieldType.ARRAY,\n  FieldType.NULL,\n  FieldType.TIMESTAMP,\n  FieldType.GEOPOINT,\n  FieldType.REFERENCE,\n];\n\n/**\n * Firestore does not support nested arrays\n * TODO(tlavelle): consider moving these upstream, and outside\n * of the \"DocumentEditor\"\n */\nconst FIRESTORE_ARRAY_FIELD_TYPES = FIRESTORE_FIELD_TYPES.filter(\n  (ft) => ft !== FieldType.ARRAY\n);\n\nconst RTDB_FIELD_TYPES = [\n  FieldType.STRING,\n  FieldType.NUMBER,\n  FieldType.BOOLEAN,\n  FieldType.MAP,\n  FieldType.ARRAY,\n  FieldType.JSON,\n];\n\nconst supportedFieldTypeSet = new Set(FIRESTORE_FIELD_TYPES);\n\nexport function supportsEditing(value: FirestoreAny): boolean {\n  return supportedFieldTypeSet.has(getFieldType(value));\n}\n\n/**\n * Entry point for a Document/Field editor\n *\n * areRootKeysMutable: can a root key be changed, this is generally not the case\n *     once a field has been persisted via the SDK.\n * areRootFielsMutable: can a root field be added/removed.\n */\nconst DocumentEditor: React.FC<{\n  value: FirestoreAny;\n  onChange?: (value?: FirestoreMap) => void;\n  areRootNamesMutable?: boolean;\n  areRootFieldsMutable?: boolean;\n  rtdb?: boolean;\n  startingIndex?: number;\n  supportNestedArrays?: boolean;\n  firestore?: firebase.firestore.Firestore;\n}> = ({\n  value,\n  onChange,\n  areRootNamesMutable,\n  areRootFieldsMutable,\n  rtdb = false,\n  startingIndex,\n  supportNestedArrays,\n  firestore,\n}) => {\n  const initialState = normalize(value);\n  const [store, dispatch] = React.useReducer(storeReducer, initialState);\n  const methods = useForm({ mode: 'onChange' });\n\n  const denormalizedStore = React.useMemo(() => denormalize(store, firestore), [\n    store,\n    firestore,\n  ]);\n\n  const errorCount = React.useMemo(() => Object.keys(methods.errors).length, [\n    methods,\n  ]);\n\n  useEffect(() => {\n    if (errorCount === 0) {\n      onChange && onChange(denormalizedStore as FirestoreMap);\n    } else {\n      onChange && onChange(undefined);\n    }\n  }, [denormalizedStore, errorCount, onChange]);\n\n  return (\n    <FormContext {...methods}>\n      <DocumentStore store={store} dispatch={dispatch}>\n        <div className=\"DocumentEditor\">\n          {\n            <>\n              {store.uuid !== undefined && (\n                <FieldEditor\n                  uuid={store.uuid}\n                  isRtdb={rtdb}\n                  areNamesMutable={areRootNamesMutable}\n                  areFieldsMutable={areRootFieldsMutable}\n                  startingIndex={startingIndex}\n                  supportNestedArrays={supportNestedArrays}\n                />\n              )}\n            </>\n          }\n        </div>\n      </DocumentStore>\n    </FormContext>\n  );\n};\n\n/**\n * Field with call-to-actions for editing as well as rendering applicable child-nodes\n */\nconst FieldEditor: React.FC<{\n  uuid: number;\n  isRtdb: boolean;\n  areNamesMutable?: boolean;\n  areFieldsMutable?: boolean;\n  startingIndex?: number;\n  supportNestedArrays?: boolean;\n  isJson?: boolean;\n}> = ({\n  uuid,\n  isRtdb,\n  areNamesMutable = true,\n  areFieldsMutable = true,\n  startingIndex = 0,\n  supportNestedArrays = true,\n  isJson = false,\n}) => {\n  const store = useStore();\n  const dispatch = useDispatch();\n  const field = useField(uuid);\n\n  if (isMapField(field)) {\n    const allowedChildTypes = isRtdb ? RTDB_FIELD_TYPES : FIRESTORE_FIELD_TYPES;\n\n    return (\n      <div className=\"DocumentEditor-Map\">\n        <div className=\"DocumentEditor-MapEntries\">\n          {field.mapChildren.map((c) => {\n            return (\n              <div className=\"DocumentEditor-MapEntry\" key={c.uuid}>\n                <div className=\"DocumentEditor-MapEntryMetadata\">\n                  <NameEditor\n                    uuid={uuid}\n                    field={field}\n                    childId={c.uuid}\n                    readonly={!areNamesMutable && uuid === store.uuid}\n                  />\n                  <span className=\"Document-TypeSymbol\">=</span>\n                  <ChildTypeSelect\n                    uuid={c.valueId}\n                    allowedTypes={allowedChildTypes}\n                  />\n                </div>\n                <FieldEditor uuid={c.valueId} isRtdb={isRtdb} isJson={isJson} />\n                {areFieldsMutable && (\n                  <IconButton\n                    className=\"DocumentEditor-MapEntryDelete\"\n                    type=\"button\"\n                    icon=\"delete\"\n                    label=\"Remove field\"\n                    onClick={() =>\n                      dispatch(actions.removeFromMap({ uuid, childId: c.uuid }))\n                    }\n                  />\n                )}\n              </div>\n            );\n          })}\n          {areFieldsMutable && (\n            <IconButton\n              label=\"Add field\"\n              type=\"button\"\n              icon=\"add\"\n              onClick={() =>\n                dispatch(\n                  actions.addToMap({\n                    uuid,\n                    name: '',\n                    value: '',\n                  })\n                )\n              }\n            />\n          )}\n        </div>\n      </div>\n    );\n  } else if (isArrayField(field)) {\n    const allowedChildTypes = isRtdb\n      ? RTDB_FIELD_TYPES\n      : supportNestedArrays\n      ? FIRESTORE_FIELD_TYPES\n      : FIRESTORE_ARRAY_FIELD_TYPES;\n\n    return (\n      <div className=\"DocumentEditor-Array\">\n        <div className=\"DocumentEditor-ArrayEntries\">\n          {field.arrayChildren.map((c, index) => {\n            return (\n              <div className=\"DocumentEditor-ArrayEntry\" key={c.uuid}>\n                <div className=\"DocumentEditor-ArrayEntryMetadata\">\n                  <div className=\"DocumentEditor-ArrayIndex\">\n                    <Field\n                      value={index + startingIndex}\n                      label=\"Index\"\n                      disabled\n                    />\n                  </div>\n                  <span className=\"Document-TypeSymbol\">=</span>\n                  <ChildTypeSelect\n                    uuid={c.valueId}\n                    allowedTypes={allowedChildTypes}\n                  />\n                </div>\n                <FieldEditor uuid={c.valueId} isRtdb={isRtdb} />\n                {areFieldsMutable && (\n                  <IconButton\n                    className=\"DocumentEditor-ArrayEntryDelete\"\n                    type=\"button\"\n                    icon=\"delete\"\n                    label=\"Remove field\"\n                    onClick={() =>\n                      dispatch(\n                        actions.removeFromArray({ uuid, childId: c.uuid })\n                      )\n                    }\n                  />\n                )}\n              </div>\n            );\n          })}\n          {areFieldsMutable && (\n            <IconButton\n              label=\"Add field\"\n              type=\"button\"\n              icon=\"add\"\n              onClick={() =>\n                dispatch(\n                  actions.addToArray({\n                    uuid,\n                    value: '',\n                  })\n                )\n              }\n            />\n          )}\n        </div>\n      </div>\n    );\n  } else if (isJSONField(field)) {\n    return (\n      <JsonEditor\n        name={`${uuid}`}\n        value={field.value}\n        onChange={(value) => dispatch(actions.updateValue({ uuid, value }))}\n      />\n    );\n  } else {\n    const valueEditor =\n      field.value instanceof DocumentPath ? (\n        <ReferenceEditor\n          name={`${uuid}`}\n          value={field.value}\n          onChange={(value) => dispatch(actions.updateValue({ uuid, value }))}\n        />\n      ) : isString(field.value) ? (\n        <StringEditor\n          value={field.value}\n          onChange={(value) => dispatch(actions.updateValue({ uuid, value }))}\n        />\n      ) : isBoolean(field.value) ? (\n        <BooleanEditor\n          value={field.value}\n          onChange={(value) => dispatch(actions.updateValue({ uuid, value }))}\n        />\n      ) : isNumber(field.value) ? (\n        <NumberEditor\n          name={`${uuid}`}\n          value={field.value}\n          onChange={(value) => dispatch(actions.updateValue({ uuid, value }))}\n        />\n      ) : isGeoPoint(field.value) ? (\n        <GeoPointEditor\n          name={`${uuid}`}\n          value={field.value}\n          onChange={(value) => dispatch(actions.updateValue({ uuid, value }))}\n        />\n      ) : isTimestamp(field.value) ? (\n        <TimestampEditor\n          name={`${uuid}`}\n          value={field.value}\n          onChange={(value) => dispatch(actions.updateValue({ uuid, value }))}\n        />\n      ) : null;\n\n    return <div className=\"DocumentEditor-Primitive\">{valueEditor}</div>;\n  }\n};\n\nconst ChildTypeSelect: React.FC<{\n  uuid: number;\n  allowedTypes: FieldType[];\n}> = ({ uuid, allowedTypes }) => {\n  const field = useField(uuid);\n  const dispatch = useDispatch();\n\n  return (\n    <SelectField\n      label=\"Type\"\n      outlined\n      options={allowedTypes}\n      value={getDocumentFieldType(field)}\n      onChange={(e) => {\n        dispatch(\n          actions.updateType({ uuid, type: e.currentTarget.value as FieldType })\n        );\n      }}\n    />\n  );\n};\n\nconst NameEditor: React.FC<{\n  uuid: number;\n  field: MapField;\n  childId: number;\n  readonly: boolean;\n}> = ({ uuid, field, childId, readonly }) => {\n  const {\n    register,\n    unregister,\n    errors,\n    clearError,\n    setValue,\n    setError,\n    formState: { touched },\n  } = useFormContext();\n\n  const dispatch = useDispatch();\n  const child = field.mapChildren.find((c) => c.uuid === childId);\n  if (!child) {\n    throw new Error('Tried to render a name-edtior for a non-map-child');\n  }\n\n  const formName = `${childId}`;\n\n  const siblingNames = React.useMemo(() => {\n    return field.mapChildren\n      .filter((c) => c.uuid !== childId)\n      .map((c) => c.name);\n  }, [field, childId]);\n\n  useEffect(() => {\n    register(formName);\n    return () => unregister(formName);\n  }, [register, unregister, formName]);\n\n  useEffect(() => {\n    // Validate `name` when siblings change\n    const isUnique = siblingNames.every((name) => name !== child.name);\n    if (!child.name) {\n      setError(formName, 'required', 'Required');\n    } else if (!isUnique) {\n      setError(formName, 'unique', 'Must be unique');\n    } else {\n      clearError(formName);\n    }\n  }, [child, siblingNames, formName, setError, clearError]);\n\n  return (\n    <Field\n      label=\"Field\"\n      outlined\n      value={child.name}\n      disabled={readonly}\n      onChange={(e) => {\n        setValue(formName, e.currentTarget.value);\n        dispatch(\n          actions.updateName({\n            uuid,\n            childId,\n            name: e.currentTarget.value,\n          })\n        );\n      }}\n      // Show the `unique` error regardless of the field having been\n      // touched; in case another field's name was updated to now conflict\n      error={\n        (touched[formName] || errors[formName]?.type === 'unique') &&\n        errors[formName]?.message\n      }\n    />\n  );\n};\n\nfunction getDocumentFieldType(field: DocumentField): FieldType {\n  if (isMapField(field)) {\n    return FieldType.MAP;\n  } else if (isArrayField(field)) {\n    return FieldType.ARRAY;\n  } else if (isJSONField(field)) {\n    return FieldType.JSON;\n  } else {\n    if (field.value instanceof DocumentPath) {\n      return FieldType.REFERENCE;\n    }\n    return getFieldType(field.value);\n  }\n}\n\n//\nexport default DocumentEditor;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './InlineEditor.scss';\n\nimport {\n  Card,\n  CardActionButton,\n  CardActionButtons,\n  CardActions,\n} from '@rmwc/card';\nimport { Elevation } from '@rmwc/elevation';\nimport firebase from 'firebase';\nimport React, { useState } from 'react';\nimport { FocusOn } from 'react-focus-on';\n\nimport DocumentEditor from '../DocumentEditor';\nimport { FirestoreAny } from '../models';\n\n/** Editor entry point for a selected field */\nconst InlineEditor: React.FC<{\n  value: FirestoreAny;\n  onCancel: () => void;\n  onSave: (key: string, value: FirestoreAny) => void;\n  areRootKeysMutable: boolean;\n  rtdb?: boolean;\n  startingIndex?: number;\n  firestore?: firebase.firestore.Firestore;\n}> = ({\n  value,\n  onCancel,\n  onSave,\n  areRootKeysMutable,\n  rtdb,\n  startingIndex,\n  firestore,\n}) => {\n  const [internalValue, setInternalValue] = useState<\n    FirestoreAny | undefined\n  >();\n\n  function handleChange(value: FirestoreAny | undefined) {\n    setInternalValue(value);\n  }\n\n  function handleCancel() {\n    onCancel();\n  }\n\n  function handleSubmit(e: React.MouseEvent<HTMLButtonElement>) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (internalValue) {\n      onSave(Object.keys(internalValue)[0], Object.values(internalValue)[0]);\n    }\n  }\n\n  return (\n    <FocusOn\n      className=\"Firestore-InlineEditor-relative-anchor\"\n      onClickOutside={handleCancel}\n      onEscapeKey={handleCancel}\n    >\n      <Elevation z={8} wrap>\n        <Card\n          className=\"Firestore-InlineEditor\"\n          tag=\"form\"\n          onSubmit={handleSubmit}\n        >\n          <div className=\"Firestore-InlineEditorContent\">\n            <DocumentEditor\n              value={value}\n              onChange={handleChange}\n              areRootNamesMutable={areRootKeysMutable}\n              areRootFieldsMutable={false}\n              rtdb={rtdb}\n              startingIndex={startingIndex}\n              supportNestedArrays={false}\n              firestore={firestore}\n            />\n          </div>\n          <CardActions className=\"Firestore-InlineEditorActions\">\n            <CardActionButtons>\n              <CardActionButton type=\"button\" onClick={handleCancel}>\n                Cancel\n              </CardActionButton>\n              <CardActionButton\n                type=\"submit\"\n                unelevated\n                disabled={!internalValue}\n              >\n                Save\n              </CardActionButton>\n            </CardActionButtons>\n          </CardActions>\n        </Card>\n      </Elevation>\n    </FocusOn>\n  );\n};\n\nexport default InlineEditor;\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './NodeLink.scss';\n\nimport { Typography } from '@rmwc/typography';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { Link, matchPath, useRouteMatch } from 'react-router-dom';\n\nimport { getDbRootUrl } from './common/view_model';\n\nexport interface Props {\n  dbRef: firebase.database.Reference;\n}\n\nexport const NodeLink = React.memo<Props>(function NodeLink$({ dbRef }) {\n  const key = dbRef.key || getDbRootUrl(dbRef);\n  const path = new URL(dbRef.toString()).pathname;\n  const href = useHrefWithinSameRoute(path);\n  return (\n    <Typography\n      className=\"NodeLink\"\n      use=\"body1\"\n      aria-label=\"Key name\"\n      tag={Link}\n      to={href}\n    >\n      {key}\n    </Typography>\n  );\n});\n\n/**\n * Creates a href that replaces the `/:path*` part of the current `<Route>`\n *\n * e.g. `/database/sample/data/a/b/c` -> `/database/sample/data/x/y/z`\n */\nfunction useHrefWithinSameRoute(absolutePath: string) {\n  const match = useRouteMatch();\n\n  // remove the wildcard :path param, so we can append it manually\n  const withoutPath = match.path.replace('/:path*', '');\n\n  const result = matchPath(match.url, { path: withoutPath, strict: true });\n  const baseUrl = result?.url || '';\n  return baseUrl === '/' ? absolutePath : `${baseUrl}${absolutePath}`;\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './ValueDisplay.scss';\n\nimport { Typography, TypographyProps } from '@rmwc/typography';\nimport * as React from 'react';\nimport { DOMAttributes } from 'react';\n\nexport interface Props extends DOMAttributes<HTMLSpanElement>, TypographyProps {\n  value: string | number | boolean | null;\n}\n\nexport const ValueDisplay = React.memo<Props>(function ValueDisplay$({\n  value,\n  use,\n  ...otherProps\n}) {\n  const trimmedValue =\n    typeof value === 'string' && value.length >= 24\n      ? `${value.substr(0, 21)}...`\n      : value;\n\n  const getClass = (value: Props['value']) =>\n    `ValueDisplay ValueDisplay__${typeof value}`;\n  return (\n    <Typography\n      use=\"body1\"\n      className={getClass(value)}\n      {...otherProps}\n      aria-label=\"Node value\"\n    >\n      {JSON.stringify(trimmedValue)}\n    </Typography>\n  );\n});\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './NodeLeaf.scss';\n\nimport { IconButton } from '@rmwc/icon-button';\nimport { Tooltip } from '@rmwc/tooltip';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useState } from 'react';\n\nimport InlineEditor from '../../Firestore/DocumentPreview/InlineEditor';\nimport { FirestoreAny } from '../../Firestore/models';\nimport { NodeLink } from './NodeLink';\nimport { ValueDisplay } from './ValueDisplay';\n\nexport interface Props {\n  realtimeRef: firebase.database.Reference;\n  value: string | boolean | number | null;\n}\n\nexport const NodeLeaf = React.memo<Props>(function NodeLeaf$({\n  value,\n  realtimeRef,\n}) {\n  const [isEditing, setIsEditing] = useState(false);\n  const [isAdding, setIsAdding] = useState(false);\n  const handleEdit = () => {\n    setIsEditing(!isEditing);\n  };\n\n  const handleEditSuccess = async (key: string, value: FirestoreAny) => {\n    await realtimeRef.set(value);\n    setIsEditing(false);\n  };\n\n  const handleAdd = () => {\n    setIsAdding(!isAdding);\n  };\n\n  const handleAddSuccess = async (key: string, value: FirestoreAny) => {\n    await realtimeRef.child(key).set(value);\n    setIsAdding(false);\n  };\n\n  const handleDelete = async () => {\n    try {\n      await realtimeRef.remove();\n    } catch (e) {\n      throw e;\n    }\n  };\n\n  const showAddButton = !realtimeRef.parent && value === null;\n  return (\n    <div className=\"NodeLeaf\">\n      <div className=\"NodeLeaf__key\">\n        <NodeLink dbRef={realtimeRef} />\n        {': '}\n        <ValueDisplay use=\"body1\" value={value} onClick={handleEdit} />\n      </div>\n      <span className=\"NodeLeaf__actions\">\n        <Tooltip content=\"Edit value\">\n          <IconButton\n            icon=\"edit\"\n            onClick={handleEdit}\n            aria-label=\"Edit value\"\n          />\n        </Tooltip>\n        {showAddButton && (\n          <Tooltip content=\"Add child\">\n            <IconButton icon=\"add\" onClick={handleAdd} aria-label=\"Add child\" />\n          </Tooltip>\n        )}\n        <Tooltip content=\"Delete value\">\n          <IconButton\n            icon=\"delete\"\n            onClick={handleDelete}\n            aria-label=\"Delete value\"\n          />\n        </Tooltip>\n      </span>\n      <div className=\"NodeLeaf__edit-ui\">\n        {isEditing && (\n          <InlineEditor\n            rtdb\n            value={{\n              [realtimeRef.key || realtimeRef.toString()]:\n                value === null ? '' : value,\n            }}\n            onCancel={() => setIsEditing(false)}\n            onSave={handleEditSuccess}\n            areRootKeysMutable={false}\n          />\n        )}\n        {isAdding && (\n          <InlineEditor\n            rtdb\n            value={{ [realtimeRef.push().key!]: '' }}\n            onCancel={() => setIsAdding(false)}\n            onSave={handleAddSuccess}\n            areRootKeysMutable={true}\n          />\n        )}\n      </div>\n    </div>\n  );\n});\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ok } from 'assert';\n\nimport { Checkbox } from '@rmwc/checkbox';\nimport {\n  Dialog,\n  DialogActions,\n  DialogButton,\n  DialogContent,\n  DialogTitle,\n} from '@rmwc/dialog';\nimport { TextField } from '@rmwc/textfield';\nimport { Typography } from '@rmwc/typography';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useEffect, useState } from 'react';\n\nimport { Field } from '../../common/Field';\n\nexport interface Props {\n  realtimeRef: firebase.database.Reference;\n  query?: firebase.database.Query;\n  /**\n   * Called when complete, if the data was cloned the key is returned, else\n   * undefined.\n   */\n  onComplete: (string?: string) => void;\n}\n\n/**\n * Strips protocol and domain name (usually http://localhost:9000/)\n * from the ref's path\n * @example \"localhost:9000/todos/one\" -> \"/todos/one\"\n * @param ref\n */\nconst getAbsoluteRefPath = (ref: firebase.database.Reference) => {\n  return new URL(ref.toString()).pathname;\n};\n\n/**\n * Returns a key value that is either a new push id if the current\n * ref's key is a push id or a \"copy\" key if not.\n * @param key\n * @param ref\n */\nconst cloneKey = (key: string, ref: firebase.database.Reference) => {\n  return key.startsWith('-')\n    ? `${getAbsoluteRefPath(ref.parent!)}/${ref.push().key!}`\n    : `${getAbsoluteRefPath(ref)}_copy`;\n};\n\nexport const CloneDialog = React.memo<Props>(function CloneDialog$({\n  realtimeRef,\n  query,\n  onComplete,\n}) {\n  ok(realtimeRef.parent, 'Cannot clone the root node!');\n\n  // queries only exist if queryParams are passed into the dialog\n  let hasQuery = query != null;\n\n  const originalKey = realtimeRef.key!;\n  const [newDestinationPath, setNewDestinationPath] = useState('');\n\n  const [form, setForm] = useState<Record<string, string>>({});\n  const [isLoading, setIsLoading] = useState(true);\n  const [isCloningWithFiltered, setCloningFiltered] = useState(hasQuery);\n\n  useEffect(() => {\n    const loadData = async () => {\n      let snapshot = null;\n      // only apply the query if the user has selected the checkbox\n      // and the query has been passed as a prop\n      if (query != null && isCloningWithFiltered) {\n        snapshot = await query.once('value');\n      } else {\n        snapshot = await realtimeRef.once('value');\n      }\n      const data: Record<string, string> = {};\n      Object.entries(snapshot.val() || {}).forEach(([key, val]) => {\n        data[key] = JSON.stringify(val);\n      });\n      setForm(data);\n      setNewDestinationPath(cloneKey(originalKey, realtimeRef));\n      setIsLoading(false);\n    };\n    loadData();\n  }, [\n    setIsLoading,\n    setForm,\n    setNewDestinationPath,\n    originalKey,\n    realtimeRef,\n    isCloningWithFiltered,\n    query,\n  ]);\n\n  const updateField = (e: React.FormEvent<HTMLInputElement>) => {\n    const target = e.target as HTMLInputElement;\n    setForm({\n      ...form,\n      [target.name]: target.value,\n    });\n  };\n\n  const handleSubmit = (e: React.FormEvent<HTMLElement>) => {\n    e.preventDefault();\n    const data: Record<string, any> = {};\n    Object.entries(form).forEach(([key, value]) => {\n      data[key] = JSON.parse(value);\n    });\n    realtimeRef.root.child(newDestinationPath).set(data);\n\n    onComplete(newDestinationPath);\n  };\n\n  return (\n    <Dialog open>\n      <form onSubmit={handleSubmit}>\n        <DialogTitle>Clone \"{originalKey}\"</DialogTitle>\n        <DialogContent>\n          <Field\n            label=\"New destination path:\"\n            value={newDestinationPath}\n            onChange={(e) =>\n              setNewDestinationPath((e.target as HTMLInputElement).value)\n            }\n            type=\"text\"\n          />\n\n          {hasQuery ? (\n            <div>\n              <Checkbox\n                label=\"Clone filtered data set\"\n                checked={isCloningWithFiltered}\n                onChange={(event) => {\n                  setCloningFiltered(!!event.currentTarget.checked);\n                }}\n              />\n            </div>\n          ) : null}\n\n          <Typography use=\"headline6\">Data</Typography>\n          {isLoading\n            ? 'Loading...'\n            : Object.entries(form).map(([key, val]) => (\n                <div key={key}>\n                  <label>\n                    {key}:\n                    <TextField\n                      name={key}\n                      type=\"text\"\n                      value={val}\n                      onChange={updateField}\n                      placeholder=\"JSON or simple text\"\n                    />\n                  </label>\n                </div>\n              ))}\n        </DialogContent>\n        <DialogActions>\n          <DialogButton\n            type=\"button\"\n            action=\"close\"\n            theme=\"secondary\"\n            onClick={() => onComplete()}\n          >\n            Cancel\n          </DialogButton>\n          <DialogButton unelevated action=\"accept\">\n            Clone\n          </DialogButton>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n});\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './InlineQuery.scss';\n\nimport {\n  Card,\n  CardActionButton,\n  CardActionButtons,\n  CardActions,\n} from '@rmwc/card';\nimport keycode from 'keycode';\nimport * as React from 'react';\nimport { useEffect, useRef, useState } from 'react';\n\nimport { Field, SelectField } from '../../common/Field';\nimport {\n  DEFAULT_PAGE_SIZE,\n  DEFAULT_QUERY_PARAMS,\n  QueryParams,\n  jsonIshValue,\n} from './common/view_model';\n\nexport interface Props {\n  params?: QueryParams;\n  onSubmit: (params: QueryParams) => void;\n  onCancel: () => void;\n}\n\ntype FormData = { [K in keyof QueryParams]: string };\n\nexport const InlineQuery = React.memo<Props>(function InlineQuery$({\n  params = {},\n  onSubmit,\n  onCancel,\n}) {\n  const {\n    key = '',\n    operator = '==',\n    value = '',\n    limit = DEFAULT_PAGE_SIZE,\n  } = params;\n\n  const [form, setValues] = useState<FormData>({\n    key,\n    operator,\n    value: JSON.stringify(value),\n    limit: `${limit}`,\n  });\n\n  const updateField = (\n    e: React.FormEvent<HTMLInputElement | HTMLSelectElement>\n  ) => {\n    const target = e.target as HTMLInputElement;\n    setValues({\n      ...form,\n      [target.name]: target.value,\n    });\n  };\n\n  const submitForm = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    onSubmit && onSubmit(toParams(form));\n  };\n\n  const cancelOnEscape = (e: React.KeyboardEvent) => {\n    if (e.keyCode === keycode('esc')) {\n      onCancel && onCancel();\n    }\n  };\n\n  const keyInputRef = useRef<HTMLInputElement>(null);\n  const valueInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (key) {\n      valueInputRef.current!.focus();\n      valueInputRef.current!.select();\n    } else {\n      keyInputRef.current!.focus();\n      keyInputRef.current!.select();\n    }\n  }, [key]);\n\n  return (\n    <Card\n      className=\"InlineQuery InlineQuery__card\"\n      tag=\"form\"\n      onSubmit={submitForm}\n      onKeyDown={cancelOnEscape}\n    >\n      <div className=\"InlineQuery__form-fields\">\n        <Field\n          outlined\n          label=\"Key\"\n          name=\"key\"\n          value={form.key}\n          onChange={updateField}\n          inputRef={keyInputRef}\n        />\n        <SelectField\n          label=\"Condition\"\n          name=\"operator\"\n          options={['==', '>=', '<=']}\n          value={form.operator}\n          onChange={updateField}\n        />\n        <Field\n          label=\"Value\"\n          name=\"value\"\n          value={form.value}\n          onChange={updateField}\n          inputRef={valueInputRef}\n          placeholder=\"JSON or plain text\"\n        />\n        <Field\n          label=\"limit\"\n          name=\"limit\"\n          value={form.limit}\n          onChange={updateField}\n        />\n      </div>\n      <CardActions className=\"InlineQuery__actions\">\n        <CardActionButtons>\n          {params !== DEFAULT_QUERY_PARAMS && (\n            <CardActionButton\n              type=\"button\"\n              label=\"Reset\"\n              danger\n              onClick={() => onSubmit(DEFAULT_QUERY_PARAMS)}\n            />\n          )}\n          <CardActionButton\n            theme=\"secondary\"\n            type=\"button\"\n            label=\"Cancel\"\n            onClick={() => onCancel && onCancel()}\n          />\n          <CardActionButton unelevated type=\"submit\" label=\"Search\" />\n        </CardActionButtons>\n      </CardActions>\n    </Card>\n  );\n});\n\nfunction toParams(form: FormData): QueryParams {\n  const { key, operator, value, limit } = form;\n  return {\n    key,\n    operator: operator as QueryParams['operator'],\n    value: jsonIshValue(value || 'null'),\n    limit: Number(limit),\n  };\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Dialog,\n  DialogActions,\n  DialogButton,\n  DialogContent,\n  DialogTitle,\n} from '@rmwc/dialog';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useState } from 'react';\n\nimport { Field } from '../../common/Field';\n\nexport interface Props {\n  realtimeRef: firebase.database.Reference;\n  isOpen: boolean;\n  onComplete: (didRename: boolean) => void;\n}\n\nexport const RenameDialog = React.memo<Props>(function RenameDialog$({\n  realtimeRef,\n  isOpen,\n  onComplete,\n}) {\n  const originalKey = realtimeRef.key!;\n  const [form, setForm] = useState<Record<string, string>>({\n    newKey: originalKey,\n  });\n\n  const updateField = (e: React.FormEvent<HTMLInputElement>) => {\n    const target = e.target as HTMLInputElement;\n    setForm({\n      ...form,\n      [target.name]: target.value,\n    });\n  };\n\n  const onSubmit = async (e: React.FormEvent<HTMLElement>) => {\n    e.preventDefault();\n    const snap = await realtimeRef.once('value');\n    try {\n      await realtimeRef.parent!.update({\n        [form.newKey]: snap.val(),\n        [originalKey]: null,\n      });\n    } catch (e) {\n      // TODO: handle error state\n    }\n    onComplete(true);\n  };\n\n  return (\n    <Dialog open={isOpen} onClose={() => onComplete(false)}>\n      <form onSubmit={onSubmit}>\n        <DialogTitle>Rename \"{originalKey}\"</DialogTitle>\n        <DialogContent onSubmit={onSubmit}>\n          <Field\n            name=\"newKey\"\n            label=\"New key:\"\n            value={form.newKey}\n            onChange={updateField}\n            type=\"text\"\n          />\n        </DialogContent>\n        <DialogActions>\n          <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n            Cancel\n          </DialogButton>\n          <DialogButton type=\"submit\" unelevated>\n            Rename\n          </DialogButton>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n});\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport '@material/data-table/dist/mdc.data-table.css';\nimport '@rmwc/data-table/styles';\n\nimport './NodeTabularDisplay.scss';\n\nimport { Button } from '@rmwc/button';\nimport {\n  DataTable,\n  DataTableBody,\n  DataTableCell,\n  DataTableContent,\n  DataTableHead,\n  DataTableHeadCell,\n  DataTableRow,\n} from '@rmwc/data-table';\nimport { Typography } from '@rmwc/typography';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useEffect, useState } from 'react';\n\nimport { DEFAULT_PAGE_SIZE } from './common/view_model';\nimport { NodeLink } from './NodeLink';\nimport { ValueDisplay } from './ValueDisplay';\n\nexport interface Props {\n  hasMoreRows?: boolean;\n  query: firebase.database.Query;\n  onLoadMore?: () => void;\n}\n\nenum TableType {\n  KeyValue = 'kvp',\n  KeyObject = 'ko',\n  Array = 'arr',\n}\n\ninterface Table {\n  type: TableType;\n  headers: string[];\n  rows: { pkId: string; value: any }[];\n}\n\nexport const NodeTabularDisplay = React.memo<Props>(\n  function NodeTabularDisplay$({ query, hasMoreRows, onLoadMore }) {\n    const [table, setTable] = useState<Table>({\n      type: TableType.Array,\n      headers: [],\n      rows: [],\n    });\n\n    const raiseOnLoadMore = () => onLoadMore && onLoadMore();\n\n    useEffect(() => {\n      (async () => {\n        setTable(await buildTable(query));\n      })();\n    }, [query]);\n\n    return (\n      <DataTable className=\"NodeTabularDisplay\">\n        <DataTableContent>\n          <DataTableHead>\n            <DataTableRow>\n              {table.headers.map((header, i) => (\n                <DataTableHeadCell key={i}>\n                  <Typography use=\"body1\">{header}</Typography>\n                </DataTableHeadCell>\n              ))}\n            </DataTableRow>\n          </DataTableHead>\n          <DataTableBody>\n            {table.rows.map((row, idx) => (\n              <DataTableRow key={idx}>\n                {table.headers.map((header, i) =>\n                  getColumnValue(table, row, header, i, query.ref)\n                )}\n              </DataTableRow>\n            ))}\n          </DataTableBody>\n          {hasMoreRows && (\n            <DataTableHead>\n              <DataTableRow>\n                <DataTableCell colSpan={table.headers.length}>\n                  <Button onClick={() => raiseOnLoadMore()}>Load More</Button>\n                </DataTableCell>\n              </DataTableRow>\n            </DataTableHead>\n          )}\n        </DataTableContent>\n      </DataTable>\n    );\n  }\n);\n\nfunction getColumnValue(\n  table: Table,\n  row: { pkId: string; value: any },\n  key: string,\n  colIndex: number,\n  ref: firebase.database.Reference\n) {\n  if (colIndex === 0) {\n    return (\n      <DataTableCell key={key}>\n        <Typography use=\"body2\" className=\"NodeTabularDisplay__key\">\n          <NodeLink dbRef={ref.child(row.pkId)} />\n        </Typography>\n      </DataTableCell>\n    );\n  }\n\n  const value =\n    table.type === TableType.KeyValue || table.type === TableType.Array\n      ? row.value\n      : row.value[key];\n\n  switch (typeof value) {\n    case 'undefined':\n      return <DataTableCell className=\"undef\" key={key} />;\n    case 'object':\n      return (\n        <DataTableCell className=\"object\" key={key}>\n          <Typography use=\"body2\">{'{ ... }'}</Typography>\n        </DataTableCell>\n      );\n    default:\n      return (\n        <DataTableCell className={typeof value} key={key}>\n          <ValueDisplay value={value} use=\"body2\" />\n        </DataTableCell>\n      );\n  }\n}\n\nasync function buildTable(query: firebase.database.Query): Promise<Table> {\n  const snap = await query.once('value');\n  const data = snap.val();\n\n  // empty filter results\n  if (data === undefined || data === null) {\n    return {\n      type: TableType.KeyValue,\n      headers: ['No Data Available'],\n      rows: [{ pkId: 'value is undefined', value: 'Value is undefined' }],\n    };\n  }\n\n  const entries = Object.entries(data);\n  const type = getTableType(entries);\n\n  return {\n    type,\n    headers: getHeaders(type, entries),\n    rows: entries.map(([key, value]) => ({ pkId: key, value })),\n  };\n}\n\nfunction getTableType(entries: [string, unknown][]) {\n  const [key, value] = entries[0];\n\n  if (!isNaN(parseInt(key))) {\n    return TableType.Array;\n  } else if (typeof value === 'object') {\n    return TableType.KeyObject;\n  } else {\n    return TableType.KeyValue;\n  }\n}\n\nfunction getHeaders(type: TableType, entries: [string, any][]) {\n  const [, value] = entries[0];\n  switch (type) {\n    case TableType.KeyValue:\n      return ['key', 'value'];\n    case TableType.Array:\n      return ['', 'value'];\n    default:\n      return ['key', ...Object.keys(value)];\n  }\n}\n\nexport function isArrayLike(childKeys: string[]) {\n  if (childKeys.length <= 1) {\n    return false;\n  }\n\n  const halfOfList = childKeys.slice(0, DEFAULT_PAGE_SIZE * 2).sort();\n\n  const isArrayIndex = (v: string, i: number) => v === i.toString();\n  const isPushId = (v: string) => v.length === 20 && v[0] === '-';\n\n  return halfOfList.every(isPushId) || halfOfList.every(isArrayIndex);\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Icon } from '@rmwc/icon';\nimport { IconButton } from '@rmwc/icon-button';\nimport { MenuItem, SimpleMenu } from '@rmwc/menu';\nimport { Tooltip } from '@rmwc/tooltip';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useState } from 'react';\n\nimport InlineEditor from '../../Firestore/DocumentPreview/InlineEditor';\nimport { FirestoreAny } from '../../Firestore/models';\nimport { CloneDialog } from './CloneDialog';\nimport { applyQuery } from './common/fetch';\nimport {\n  ChildrenDisplayType,\n  DEFAULT_QUERY_PARAMS,\n  QueryParams,\n} from './common/view_model';\nimport { InlineQuery } from './InlineQuery';\nimport { RenameDialog } from './RenameDialog';\n\nexport interface Props {\n  realtimeRef: firebase.database.Reference;\n  displayType: ChildrenDisplayType;\n  queryParams?: QueryParams;\n  updateQuery?: (params: QueryParams) => void;\n  onDisplayTypeChange: (displayType: ChildrenDisplayType) => void;\n  onExpandRequested: () => void;\n}\n\nconst getNextDisplayType = (current: ChildrenDisplayType) => {\n  return current === ChildrenDisplayType.Table\n    ? ChildrenDisplayType.TreeView\n    : ChildrenDisplayType.Table;\n};\n\nconst getToggleIcon = (current: ChildrenDisplayType) => {\n  switch (current) {\n    case ChildrenDisplayType.Table:\n      return 'view_comfy';\n    case ChildrenDisplayType.TreeView:\n      return 'view_list';\n    default:\n      throw new Error(`Display type is unrecognized`);\n  }\n};\n\nconst ACTIVE_ICON = { color: '#09d3ac' };\n\nexport const NodeActions = React.memo<Props>(function NodeActions$({\n  displayType,\n  onDisplayTypeChange,\n  realtimeRef,\n  updateQuery,\n  onExpandRequested,\n  queryParams,\n}) {\n  const [isMenuOpen, setMenuOpen] = useState(false);\n  const [isAdding, setIsAdding] = useState(false);\n  const [showQueryUi, setShowQueryUi] = useState(false);\n  const [cloneDialogIsOpen, setCloneDialogIsOpen] = useState(false);\n  const [renameDialogIsOpen, setRenameDialogIsOpen] = useState(false);\n\n  const isActive =\n    isMenuOpen ||\n    isAdding ||\n    showQueryUi ||\n    cloneDialogIsOpen ||\n    renameDialogIsOpen ||\n    queryParams !== DEFAULT_QUERY_PARAMS;\n  const isRoot = realtimeRef.parent === null;\n\n  const pushId = realtimeRef.push().key!;\n  const handleAddSuccess = async (key: string, value: FirestoreAny) => {\n    await realtimeRef.child(key).set(value);\n    setIsAdding(false);\n  };\n  const addChild = () => {\n    onExpandRequested();\n    setIsAdding(!isAdding);\n  };\n\n  const removeNode = async () => {\n    try {\n      await realtimeRef.remove();\n    } catch (e) {\n      throw e;\n    }\n  };\n\n  const showQueryUiAndExpand = () => {\n    onExpandRequested();\n    setShowQueryUi(true);\n  };\n\n  const toggleTable = () => {\n    onDisplayTypeChange(getNextDisplayType(displayType));\n  };\n\n  const potentialQuery = React.useMemo(\n    () => applyQuery(realtimeRef, queryParams || {}),\n    [realtimeRef, queryParams]\n  );\n\n  return (\n    <aside className={'NodeActions' + (isActive ? ' NodeActions--active' : '')}>\n      <Tooltip content=\"Filter children\">\n        <IconButton\n          icon=\"filter_list\"\n          onIcon={<span style={ACTIVE_ICON}>filter_list</span>}\n          onClick={() => showQueryUiAndExpand()}\n          checked={queryParams !== DEFAULT_QUERY_PARAMS}\n        />\n      </Tooltip>\n      <Tooltip content=\"Add child\">\n        <IconButton icon=\"add\" onClick={addChild} />\n      </Tooltip>\n      {!isRoot ? (\n        <Tooltip content=\"Switch view\">\n          <IconButton\n            icon={getToggleIcon(getNextDisplayType(displayType))}\n            onClick={() => toggleTable()}\n          />\n        </Tooltip>\n      ) : null}\n      <SimpleMenu\n        renderToPortal={\n          /*\n           * Actions show on hover, so hoisting has some weird effects, popping\n           * in and out of the top left corner\n           */\n          false\n        }\n        handle={<IconButton icon=\"more_vert\" />}\n        onOpen={() => setMenuOpen(true)}\n        onClose={() => setMenuOpen(false)}\n      >\n        <MenuItem onClick={removeNode}>\n          <Icon icon=\"delete\" /> Remove\n        </MenuItem>\n        {!isRoot && (\n          <MenuItem onClick={() => setCloneDialogIsOpen(true)}>\n            <Icon icon=\"file_copy\" /> Clone\n          </MenuItem>\n        )}\n        {!isRoot && (\n          <MenuItem onClick={() => setRenameDialogIsOpen(true)}>\n            <Icon icon=\"edit\" /> Rename\n          </MenuItem>\n        )}\n      </SimpleMenu>\n\n      {/* Extra UI that shows when actions are triggered */}\n      <div className=\"NodeActions__additional-ui\">\n        {isAdding && (\n          <InlineEditor\n            rtdb\n            value={{ [pushId]: '' }}\n            onCancel={() => setIsAdding(false)}\n            onSave={handleAddSuccess}\n            areRootKeysMutable={true}\n          />\n        )}\n        {showQueryUi && (\n          <InlineQuery\n            params={queryParams}\n            onSubmit={(params) => {\n              updateQuery && updateQuery(params);\n              setShowQueryUi(false);\n            }}\n            onCancel={() => setShowQueryUi(false)}\n          />\n        )}\n        {cloneDialogIsOpen && (\n          <CloneDialog\n            realtimeRef={realtimeRef}\n            query={potentialQuery}\n            onComplete={() => setCloneDialogIsOpen(false)}\n          />\n        )}\n        {!isRoot && (\n          <RenameDialog\n            realtimeRef={realtimeRef}\n            isOpen={renameDialogIsOpen}\n            onComplete={() => setRenameDialogIsOpen(false)}\n          />\n        )}\n      </div>\n    </aside>\n  );\n});\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './NodeParent.scss';\n\nimport { Button } from '@rmwc/button';\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useCallback, useState } from 'react';\n\nimport {\n  ChildrenDisplayType,\n  DEFAULT_PAGE_SIZE,\n  QueryParams,\n} from './common/view_model';\nimport { NodeActions } from './NodeActions';\nimport { NodeContainer } from './NodeContainer';\nimport { NodeLink } from './NodeLink';\nimport { NodeTabularDisplay } from './NodeTabularDisplay';\n\nexport interface Props {\n  realtimeRef: firebase.database.Reference;\n  children: string[];\n  isRealtime?: boolean;\n  queryParams?: QueryParams;\n  /**\n   * This node is the top most visible node in viewer (not the same as the real\n   * db root). It will show breadcrumbs of all hidden parent nodes to the root.\n   */\n  isViewRoot?: boolean;\n  updateQuery?: (params: QueryParams) => void;\n  query?: firebase.database.Query;\n}\n\nexport const NodeParent = React.memo<Props>(function NodeParent$({\n  realtimeRef,\n  children,\n  queryParams,\n  updateQuery,\n  isViewRoot,\n  query,\n}) {\n  const isRoot = realtimeRef.parent === null;\n  const hasChildren = !!children.length;\n  const [isExpanded, setIsExpanded] = useState(\n    isRoot || isViewRoot ? true : false\n  );\n  const [displayType, setDisplayType] = useState(ChildrenDisplayType.TreeView);\n\n  const hasMore =\n    queryParams && queryParams.limit\n      ? children.length >= queryParams.limit\n      : children.length >= DEFAULT_PAGE_SIZE;\n\n  const loadMore = () => {\n    const currentPageSize = queryParams\n      ? queryParams.limit || DEFAULT_PAGE_SIZE\n      : DEFAULT_PAGE_SIZE;\n    updateQuery &&\n      updateQuery({\n        ...queryParams,\n        limit: currentPageSize + DEFAULT_PAGE_SIZE,\n      });\n  };\n\n  const toggleExpansion = useCallback(() => setIsExpanded(!isExpanded), [\n    setIsExpanded,\n    isExpanded,\n  ]);\n\n  return (\n    <div className=\"NodeParent\">\n      {/* Label */}\n      <div className=\"NodeParent__label\">\n        {isExpanded ? (\n          <button\n            className=\"NodeParent__tree-button material-icons\"\n            aria-label=\"less\"\n            onClick={toggleExpansion}\n          >\n            arrow_drop_down\n          </button>\n        ) : (\n          <button\n            className=\"NodeParent__tree-button material-icons\"\n            aria-label=\"more\"\n            onClick={toggleExpansion}\n          >\n            arrow_right\n          </button>\n        )}\n        <NodeLink dbRef={realtimeRef} />\n        <NodeActions\n          realtimeRef={realtimeRef}\n          displayType={displayType}\n          onDisplayTypeChange={(type) => {\n            setDisplayType(type);\n            setIsExpanded(true);\n          }}\n          onExpandRequested={() => setIsExpanded(true)}\n          queryParams={queryParams}\n          updateQuery={updateQuery}\n        />\n      </div>\n      <div className=\"NodeParent__children-container\">\n        {hasChildren &&\n          isExpanded &&\n          (displayType === ChildrenDisplayType.Table ? (\n            <NodeTabularDisplay\n              query={query || realtimeRef}\n              hasMoreRows={hasMore}\n              onLoadMore={loadMore}\n            />\n          ) : (\n            <ul className=\"NodeParent__children\">\n              {children.map((key) => (\n                <li key={key}>\n                  <NodeContainer realtimeRef={realtimeRef.child(key)} />\n                </li>\n              ))}\n              {hasMore && (\n                <li className=\"load-more\">\n                  <Button onClick={loadMore}>Load more...</Button>\n                </li>\n              )}\n            </ul>\n          ))}\n      </div>\n    </div>\n  );\n});\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\nimport * as React from 'react';\nimport { useEffect, useState } from 'react';\nimport { Subject } from 'rxjs';\n\nimport { canDoRealtime, createViewModel } from './common/fetch';\nimport {\n  DEFAULT_QUERY_PARAMS,\n  QueryParams,\n  ViewModel,\n} from './common/view_model';\nimport { NodeLeaf } from './NodeLeaf';\nimport { NodeParent } from './NodeParent';\n\nexport interface Props {\n  realtimeRef: firebase.database.Reference;\n  /**\n   * This node is the top most visible node in viewer (not the same as the real\n   * db root). It will show breadcrumbs of all hidden parent nodes to the root.\n   */\n  isViewRoot?: boolean;\n}\n\nconst initialState: ViewModel = {\n  isLoading: true,\n  children: [],\n};\n\nexport const NodeContainer = React.memo<Props>(function NodeContainer$({\n  realtimeRef,\n  isViewRoot,\n}) {\n  const [viewModel, setViewModel] = useState<ViewModel>(initialState);\n  const [querySubject, setQuerySubject] = useState<\n    Subject<QueryParams> | undefined\n  >(undefined);\n\n  useEffect(() => {\n    const canDoRealtime$ = canDoRealtime(realtimeRef);\n    const { query, viewModel$ } = createViewModel(realtimeRef, canDoRealtime$);\n    setQuerySubject(query);\n    const sub = viewModel$.subscribe((vm) => setViewModel(vm));\n    return () => sub.unsubscribe();\n  }, [realtimeRef]);\n\n  const updateQuery = (q: QueryParams) => {\n    setQueryParams(q);\n    querySubject && querySubject.next(q);\n  };\n\n  const [queryParams, setQueryParams] = useState(DEFAULT_QUERY_PARAMS);\n\n  const { children, query } = viewModel;\n  const hasChildren = !!children.length;\n  const isFiltered = queryParams !== DEFAULT_QUERY_PARAMS;\n  return !hasChildren && !isFiltered ? (\n    <NodeLeaf realtimeRef={realtimeRef} value={viewModel.value!} />\n  ) : (\n    <NodeParent\n      realtimeRef={realtimeRef}\n      children={children}\n      queryParams={queryParams}\n      updateQuery={updateQuery}\n      isViewRoot={isViewRoot}\n      query={query}\n    />\n  );\n});\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { IconButton } from '@rmwc/icon-button';\nimport { MenuItem, SimpleMenu } from '@rmwc/menu';\nimport firebase from 'firebase';\nimport React, { useEffect, useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { useHistory } from 'react-router-dom';\n\nimport { initDatabase } from '../../firebase';\nimport { DatabaseConfig } from '../../store/config';\nimport { InteractiveBreadCrumbBar } from '../common/InteractiveBreadCrumbBar';\nimport { DatabaseApi } from './api';\nimport { ImportDialog } from './DataViewer/ImportDialog';\nimport { NodeContainer } from './DataViewer/NodeContainer';\n\nexport interface PropsFromState {\n  namespace: string;\n  path?: string;\n  config: DatabaseConfig;\n}\n\nexport type Props = PropsFromState;\n\nconst getPrefix = (ref: firebase.database.Reference) => {\n  const base = ref.root.toString();\n  return base.substring(0, base.length - 1);\n};\n\nexport const Database: React.FC<Props> = ({ config, namespace, path }) => {\n  const [ref, setRef] = useState<firebase.database.Reference | undefined>(\n    undefined\n  );\n  const [api, setApi] = useState<DatabaseApi | undefined>(undefined);\n\n  const history = useHistory();\n\n  const [importDialogOpen, setImportDialogOpen] = useState(false);\n  const [droppedFile, setDroppedFile] = useState<File | undefined>();\n\n  const closeImportDialog = () => {\n    setDroppedFile(undefined);\n    setImportDialogOpen(false);\n  };\n\n  useEffect(() => {\n    const [db, { cleanup }] = initDatabase(config, namespace);\n    setRef(path ? db.ref(path) : db.ref());\n\n    const api = new DatabaseApi(config, namespace);\n    setApi(api);\n\n    return function cleanupDb() {\n      cleanup();\n      api.delete();\n    };\n  }, [config, namespace, path]);\n\n  const urlBase = `/database/${namespace}/data`;\n  const handleNavigate = (newPath: string) => {\n    if (newPath.startsWith('/')) {\n      newPath = newPath.substr(1);\n    }\n    history.push(`${urlBase}/${newPath}`);\n  };\n\n  return (\n    <div className=\"Database-Database\">\n      {ref && api ? (\n        <>\n          <InteractiveBreadCrumbBar\n            base={urlBase}\n            path={path || '/'}\n            inputPrefix={getPrefix(ref)}\n            onNavigate={handleNavigate}\n          >\n            <SimpleMenu\n              handle={<IconButton icon=\"more_vert\" label=\"Open menu\" />}\n              renderToPortal\n            >\n              <MenuItem onClick={() => setImportDialogOpen(true)}>\n                Import JSON\n              </MenuItem>\n            </SimpleMenu>\n          </InteractiveBreadCrumbBar>\n\n          <DatabaseDropZone onDrop={(f) => setDroppedFile(f)}>\n            <NodeContainer realtimeRef={ref} isViewRoot />\n          </DatabaseDropZone>\n\n          {(importDialogOpen || droppedFile) && (\n            <ImportDialog\n              api={api}\n              reference={ref}\n              droppedFile={droppedFile}\n              onComplete={closeImportDialog}\n            />\n          )}\n        </>\n      ) : (\n        <p>Loading</p>\n      )}\n    </div>\n  );\n};\n\nexport default Database;\n\n/**\n * Renders child content inside a dropzone that will show a scrim and accept\n * JSON files\n */\nconst DatabaseDropZone: React.FC<{ onDrop: (file: File) => void }> = ({\n  onDrop,\n  children,\n}) => {\n  const {\n    getInputProps,\n    getRootProps,\n    isDragActive,\n    isDragAccept,\n  } = useDropzone({\n    onDrop: (files) => onDrop(files[0]),\n    noClick: true,\n    accept: 'application/json',\n  });\n\n  return (\n    <div className=\"Database-Content\" {...getRootProps()}>\n      {children}\n\n      {isDragActive && (\n        <div className=\"Database-Content-Dragging\">\n          {isDragAccept ? (\n            'Drop JSON file to import'\n          ) : (\n            <span className=\"invalid\">\n              Only JSON files are supported for data import.\n            </span>\n          )}\n        </div>\n      )}\n\n      <input {...getInputProps()} />\n    </div>\n  );\n};\n","import { createSelector } from 'reselect';\n\nimport { hasData } from '../utils';\nimport { AppState } from '..';\n\nexport function getDatabases(state: AppState) {\n  return state.database.databases;\n}\n\n// Get the names of the databases or undefined, if not ready for any reason.\nexport const getDatabaseNames = createSelector(getDatabases, (databases) =>\n  hasData(databases.result)\n    ? databases.result.data.map((db) => db.name)\n    : undefined\n);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './DatabasePicker.scss';\n\nimport {\n  List,\n  ListDivider,\n  ListGroup,\n  ListGroupSubheader,\n  ListItem,\n  ListItemGraphic,\n  ListItemText,\n} from '@rmwc/list';\nimport { Typography } from '@rmwc/typography';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport { DatabaseCircleIcon } from '../common/icons';\n\nexport interface PropsFromState {\n  databases: string[] | undefined;\n}\n\nexport type Props = PropsFromState & {\n  primary: string;\n  current: string;\n  navigation: (db: string) => string;\n};\n\nconst DatabaseListItem: React.FC<{\n  name: string;\n  navigation: (db: string) => string;\n  activated: boolean;\n}> = ({ name, navigation, activated }) => {\n  const to = navigation(name);\n  return (\n    <ListItem\n      activated={activated}\n      tag={Link}\n      to={to}\n      data-testid={`nav-${name}`}\n    >\n      <ListItemGraphic tag={DatabaseCircleIcon} size=\"large\" theme=\"primary\" />\n      <ListItemText>{name}</ListItemText>\n    </ListItem>\n  );\n};\n\nexport const DatabasePicker: React.FC<Props> = ({\n  primary,\n  current,\n  navigation,\n  databases,\n}) => {\n  const secondaryDbs = databases\n    ? databases.filter((db) => db !== primary)\n    : [];\n\n  // Always show current database, which may not be in the list.\n  if (current !== primary && secondaryDbs.indexOf(current) < 0) {\n    secondaryDbs.push(current);\n  }\n\n  let pickerClassName = 'Database-Picker';\n  if (secondaryDbs.length === 0) {\n    pickerClassName += ' Database-Picker--primary-only';\n  }\n\n  return (\n    <div className={pickerClassName}>\n      <List>\n        <ListGroup>\n          <ListGroupSubheader>\n            <Typography use=\"caption\">Databases</Typography>\n          </ListGroupSubheader>\n          <DatabaseListItem\n            activated={current === primary}\n            name={primary}\n            navigation={navigation}\n          />\n          <ListDivider tag=\"div\" />\n          {secondaryDbs.map((db) => (\n            <DatabaseListItem\n              key={db}\n              activated={current === db}\n              name={db}\n              navigation={navigation}\n            />\n          ))}\n        </ListGroup>\n      </List>\n    </div>\n  );\n};\n\nexport default DatabasePicker;\n","import { Button } from '@rmwc/button';\nimport { Card } from '@rmwc/card';\nimport { Elevation } from '@rmwc/elevation';\nimport { GridCell } from '@rmwc/grid';\nimport React, { useEffect, useState } from 'react';\nimport { MapDispatchToPropsFunction, connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../store';\nimport { databasesSubscribe, databasesUnsubscribe } from '../../store/database';\nimport { getDatabaseNames } from '../../store/database/selectors';\nimport { Callout } from '../common/Callout';\nimport DatabasePicker from './DatabasePicker';\n\nexport const mapStateToProps = createStructuredSelector({\n  databases: getDatabaseNames,\n});\n\nexport interface PropsFromState {\n  databases: string[] | undefined;\n}\n\nexport interface PropsFromDispatch {\n  databasesSubscribe: () => void;\n  databasesUnsubscribe: () => void;\n}\n\nexport type Props = PropsFromState &\n  PropsFromDispatch & {\n    children?: React.ReactNode;\n    current: string;\n    primary: string;\n    navigation: (db: string) => string;\n  };\n\nexport const DatabaseContainer: React.FC<Props> = ({\n  current,\n  primary,\n  navigation,\n  databases,\n  children,\n  databasesSubscribe,\n  databasesUnsubscribe,\n}) => {\n  useEffect(() => {\n    databasesSubscribe();\n    return databasesUnsubscribe; // Unsubscribe when unmounting.\n  }, [databasesSubscribe, databasesUnsubscribe]);\n  const [dbs, setDbs] = useState(databases);\n\n  let hasNewDbs = false;\n  if (databases !== dbs) {\n    if (\n      dbs === undefined ||\n      databases === undefined ||\n      dbs.join('|') === databases.join('|') // databases from state are sorted\n    ) {\n      // Don't show reload button for initial data or unchanged.\n      setDbs(databases);\n    } else {\n      hasNewDbs = true;\n    }\n  }\n\n  return (\n    <>\n      {hasNewDbs && (\n        <GridCell span={12}>\n          <Callout\n            icon=\"info\"\n            actions={\n              <Button theme=\"secondary\" onClick={() => setDbs(databases)}>\n                Reload\n              </Button>\n            }\n          >\n            There are new databases that have been created. Reload the page to\n            view them.\n          </Callout>\n        </GridCell>\n      )}\n      <GridCell span={12}>\n        <Elevation z={2} wrap>\n          <Card className=\"canvas-card\">\n            <div className=\"Database\">\n              <DatabasePicker\n                current={current}\n                primary={primary}\n                navigation={navigation}\n                databases={dbs}\n              />\n              {children}\n            </div>\n          </Card>\n        </Elevation>\n      </GridCell>\n    </>\n  );\n};\n\nexport const mapDispatchToProps: MapDispatchToPropsFunction<\n  PropsFromDispatch,\n  {}\n> = (dispatch) => ({\n  databasesSubscribe: () => void dispatch(databasesSubscribe()),\n  databasesUnsubscribe: () => void dispatch(databasesUnsubscribe()),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DatabaseContainer);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect, Route, Switch, useRouteMatch } from 'react-router-dom';\n\nimport { createStructuredSelector } from '../../store';\nimport { DatabaseConfig } from '../../store/config';\nimport {\n  getDatabaseConfigResult,\n  getProjectIdResult,\n} from '../../store/config/selectors';\nimport { combineData, handle } from '../../store/utils';\nimport { EmulatorDisabled } from '../common/EmulatorDisabled';\nimport { Spinner } from '../common/Spinner';\nimport Database from './Database';\nimport DatabaseContainer from './DatabaseContainer';\n\nexport const mapStateToProps = createStructuredSelector({\n  projectIdResult: getProjectIdResult,\n  configResult: getDatabaseConfigResult,\n});\n\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport const DatabaseRoute: React.FC<PropsFromState> = ({\n  projectIdResult,\n  configResult,\n}) => {\n  return handle(combineData(projectIdResult, configResult), {\n    onNone: () => (\n      <Spinner span={12} message=\"Realtime Database Emulator Loading...\" />\n    ),\n    onError: () => <DatabaseRouteDisabled />,\n    onData: ([projectId, config]) =>\n      config === undefined ? (\n        <DatabaseRouteDisabled />\n      ) : (\n        <DatabaseRouteContent projectId={projectId} config={config} />\n      ),\n  });\n};\n\nexport default connect(mapStateToProps)(DatabaseRoute);\n\n// Components for different loading cases:\n\nexport type ContentProps = {\n  projectId: string;\n  config: DatabaseConfig;\n};\n\nexport const DatabaseRouteContent: React.FC<ContentProps> = ({\n  projectId,\n  config,\n}) => {\n  let { path, url } = useRouteMatch()!;\n  const primary = projectId;\n\n  return (\n    <Switch>\n      <Route exact path={path}>\n        <Redirect to={`${url}/${primary}/data`} />;\n      </Route>\n      <Route\n        path={`${path}/:namespace/data/:path*`}\n        render={({ match }: any) => {\n          const current = match.params.namespace;\n          const dbPath = `/${match.params.path || ''}`;\n          return (\n            <DatabaseContainer\n              primary={primary}\n              current={current}\n              navigation={(db) => `${url}/${db}/data`}\n            >\n              <Database namespace={current} path={dbPath} config={config} />\n            </DatabaseContainer>\n          );\n        }}\n      />\n    </Switch>\n  );\n};\n\nexport const DatabaseRouteDisabled: React.FC = () => (\n  <EmulatorDisabled productName=\"RTDB\" />\n);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DialogButton } from '@rmwc/dialog';\nimport React from 'react';\n\nimport { confirm } from '../../common/DialogQueue';\n\nexport const promptClearAll = () =>\n  confirm({\n    title: 'Delete all data?',\n    body: `Proceeding will delete all your collections, sub-collections and\n             documents within your database.`,\n    // hide standard buttons so as to use `danger` button\n    acceptLabel: null,\n    cancelLabel: null,\n    footer: (\n      <>\n        <DialogButton type=\"button\" theme=\"secondary\" action=\"close\">\n          Cancel\n        </DialogButton>\n        <DialogButton unelevated action=\"accept\" isDefaultAction danger>\n          Clear\n        </DialogButton>\n      </>\n    ),\n  });\n","import { IconButton, IconButtonProps } from '@rmwc/icon-button';\nimport { HTMLProps } from '@rmwc/types';\nimport React, { useCallback, useState } from 'react';\n\ninterface CopyButtonProps extends HTMLProps<IconButtonProps> {\n  textToCopy: string;\n}\n\nfunction useClipboard(text: string) {\n  const [isTextCopied, setIsTextCopied] = useState(false);\n  return {\n    isTextCopied,\n    writeText: useCallback(() => {\n      return navigator.clipboard\n        .writeText(text)\n        .then(() => setIsTextCopied(true))\n        .catch(() => setIsTextCopied((isTextCopied) => isTextCopied));\n    }, [text]),\n  };\n}\n\nexport function CopyButton({\n  textToCopy: text,\n  label,\n  theme,\n}: CopyButtonProps) {\n  label = label || 'Copy';\n  theme = theme || 'textPrimaryOnBackground';\n  const { writeText } = useClipboard(text);\n  return (\n    <IconButton\n      theme={theme}\n      icon=\"content_copy\"\n      label={label}\n      onClick={writeText}\n    />\n  );\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createAction } from 'typesafe-actions';\n\nimport { CollectionFilter } from './models';\n\nexport const addCollectionFilter = createAction(\n  '@firestore/addCollectionFilter'\n)<\n  {\n    path: string;\n  } & CollectionFilter\n>();\nexport const removeCollectionFilter = createAction(\n  '@firestore/removeCollectionFilter'\n)<{\n  path: string;\n}>();\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport produce from 'immer';\nimport * as React from 'react';\nimport { Action, createReducer } from 'typesafe-actions';\n\nimport * as actions from './actions';\nimport { CollectionFilter } from './models';\n\nexport interface CollectionFilters {\n  [path: string]: CollectionFilter;\n}\n\nexport interface Store {\n  collectionFilters: CollectionFilters;\n}\n\nconst INIT_STATE: Store = { collectionFilters: {} };\n\nconst firestoreStoreContext = React.createContext<{\n  store: Store;\n  dispatch: React.Dispatch<any>;\n}>({ store: INIT_STATE, dispatch: () => {} });\n\nconst reducer = createReducer<Store, Action>(INIT_STATE)\n  .handleAction(\n    actions.addCollectionFilter,\n    produce((draft, { payload }) => {\n      const { path, ...filter } = payload;\n      draft.collectionFilters[payload.path] = filter;\n    })\n  )\n  .handleAction(\n    actions.removeCollectionFilter,\n    produce((draft, { payload }) => {\n      delete draft.collectionFilters[payload.path];\n    })\n  );\n\nconst storeReducer: React.Reducer<Store, Action> = (state, action) => {\n  return (reducer.handlers as any)[action.type](state, action);\n};\n\nexport const FirestoreStore: React.FC<{ initState?: Store }> = ({\n  initState = INIT_STATE,\n  children,\n}) => {\n  const [store, dispatch] = React.useReducer(storeReducer, initState);\n  return (\n    <firestoreStoreContext.Provider value={{ store, dispatch }}>\n      {children}\n    </firestoreStoreContext.Provider>\n  );\n};\n\nexport function useFirestoreStore(): {\n  store: Store;\n  dispatch: React.Dispatch<Action>;\n} {\n  const context = React.useContext(firestoreStoreContext);\n  if (context === undefined) {\n    throw new Error('useFirestoreStore must be used within a <FirestoreStore>');\n  }\n  return context;\n}\n\nexport function useStore(): Store {\n  const { store } = useFirestoreStore();\n  return React.useMemo(() => store, [store]);\n}\n\nexport function useDispatch(): React.Dispatch<Action> {\n  const { dispatch } = useFirestoreStore();\n  return React.useMemo(() => dispatch, [dispatch]);\n}\n\nexport function useCollectionFilter(\n  path: string\n): CollectionFilter | undefined {\n  const { store } = useFirestoreStore();\n  return store.collectionFilters[path];\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { Controller, useFormContext } from 'react-hook-form';\n\nimport { Field, SelectField } from '../../../components/common/Field';\nimport { NUMBER_REGEX, isBoolean, isNumber } from '../utils';\nimport styles from './CollectionFilter.module.scss';\n\nfunction getConditionEntryType(value: any) {\n  if (isBoolean(value)) {\n    return 'boolean';\n  }\n  if (isNumber(value)) {\n    return 'number';\n  }\n  return 'string';\n}\n\ninterface ConditionEntryProps {\n  name: string;\n  // Error may be undefined; require consumers to still pass or we might end up\n  // in a state where we validate without showing the error message.\n  error: string | undefined;\n}\n\nexport const ConditionEntry: React.FC<ConditionEntryProps> = React.memo(\n  ({ name, error }) => {\n    const { setValue, watch } = useFormContext();\n    const value = watch(name);\n    const [fieldType, setFieldType] = useState(getConditionEntryType(value));\n\n    useEffect(() => {\n      // Essentially setting the defaultValue of this form-field,\n      // specifically when chaning types between Single <--> Multi\n      if (value === undefined) {\n        setValue(name, '');\n      }\n    }, [value, setValue, name]);\n\n    return (\n      <div className={styles.conditionEntry}>\n        <SelectField\n          options={['string', 'number', 'boolean']}\n          value={fieldType}\n          onChange={(evt) => {\n            setFieldType(evt.currentTarget.value);\n          }}\n          fieldClassName={styles.conditionEntryType}\n        />\n\n        {fieldType === 'string' && (\n          <Controller\n            as={Field}\n            name={name}\n            defaultValue=\"\"\n            error={error}\n            fieldClassName={styles.conditionEntryValue}\n            aria-label=\"Value\"\n          />\n        )}\n\n        {fieldType === 'number' && (\n          <Controller\n            as={Field}\n            name={name}\n            defaultValue={''}\n            rules={{\n              pattern: {\n                value: NUMBER_REGEX,\n                message: 'Must be a number',\n              },\n            }}\n            error={error}\n            onChange={([event]) =>\n              // Cast it back to a number before saving to model\n              event.target.value.match(NUMBER_REGEX)\n                ? parseFloat(event.target.value)\n                : event.target.value\n            }\n            fieldClassName={styles.conditionEntryValue}\n            aria-label=\"Value\"\n          />\n        )}\n\n        {fieldType === 'boolean' && <BooleanCondition name={name} />}\n      </div>\n    );\n  }\n);\n\n// RMWC select-menus do not work well with boolean values, requiring\n// custom-registration w/ the parent form\nconst BooleanCondition: React.FC<{ name: string }> = ({ name }) => {\n  const { register, setValue, unregister, watch } = useFormContext();\n\n  useEffect(() => {\n    register({ name });\n    setValue(name, true);\n\n    return () => unregister(name);\n  }, [register, unregister, setValue, name]);\n\n  const selectValue = watch(name);\n\n  return (\n    <SelectField\n      name={name}\n      options={['true', 'false']}\n      value={selectValue}\n      onChange={(evt) => setValue(name, evt.currentTarget.value === 'true')}\n      fieldClassName={styles.conditionEntryValue}\n      aria-label=\"Value\"\n    />\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Button } from '@rmwc/button';\nimport { IconButton } from '@rmwc/icon-button';\nimport React, { useEffect } from 'react';\nimport { useFieldArray, useFormContext } from 'react-hook-form';\n\nimport styles from './CollectionFilter.module.scss';\nimport { ConditionEntry } from './ConditionEntry';\n\nexport const ConditionEntries: React.FC<{ name: string }> = ({ name }) => {\n  const {\n    errors,\n    formState: { touched },\n  } = useFormContext();\n\n  const { fields, append, remove } = useFieldArray({\n    name,\n  });\n\n  useEffect(() => {\n    if (fields.length < 1) {\n      append({ _: '' });\n    }\n  }, [append, fields]);\n\n  return (\n    <ul className={styles.conditionEntries}>\n      {fields.map((field, index) => {\n        const conditionName = `${name}[${index}]`;\n        return (\n          <li key={field.id}>\n            <ConditionEntry\n              name={conditionName}\n              error={touched[conditionName] && errors[conditionName]}\n            />\n            <IconButton\n              className={\n                fields.length > 1 ? styles.removeFilter : styles.hidden\n              }\n              icon=\"delete\"\n              label=\"Remove filter\"\n              type=\"button\"\n              onClick={() => remove(index)}\n            />\n          </li>\n        );\n      })}\n      <Button type=\"button\" icon=\"add\" onClick={() => append({ _: '' })}>\n        Add value\n      </Button>\n    </ul>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Radio } from '@rmwc/radio';\nimport React, { useEffect } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nexport const SortRadioGroup: React.FC<{ name: string; disabled: boolean }> = ({\n  name,\n  disabled,\n}) => {\n  const { register, setValue, unregister, watch } = useFormContext();\n\n  useEffect(() => {\n    if (!disabled) {\n      register({ name });\n    } else {\n      setValue(name, undefined);\n    }\n\n    return () => unregister(name);\n  }, [register, unregister, disabled, name, setValue]);\n\n  const sort = watch(name);\n\n  return (\n    <>\n      <Radio\n        value=\"asc\"\n        label=\"Ascending\"\n        checked={sort === 'asc'}\n        onChange={() => setValue(name, 'asc')}\n        disabled={disabled}\n      />\n\n      <Radio\n        value=\"desc\"\n        label=\"Descending\"\n        checked={sort === 'desc'}\n        onChange={() => setValue(name, 'desc')}\n        disabled={disabled}\n      />\n    </>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CardActionButton, CardActionButtons, CardActions } from '@rmwc/card';\nimport { CollapsibleList, SimpleListItem } from '@rmwc/list';\nimport { Theme, ThemeProvider } from '@rmwc/theme';\nimport { Typography } from '@rmwc/typography';\nimport firebase from 'firebase';\nimport React, { useState } from 'react';\nimport { Controller, FormContext, useForm } from 'react-hook-form';\n\nimport { grey100 } from '../../../colors';\nimport { Field, SelectField } from '../../../components/common/Field';\nimport * as actions from '../actions';\nimport {\n  CollectionFilter as CollectionFilterType,\n  isMultiValueCollectionFilter,\n  isSingleValueCollectionFilter,\n  isSortableCollectionFilter,\n} from '../models';\nimport { useCollectionFilter, useDispatch } from '../store';\nimport styles from './CollectionFilter.module.scss';\nimport { ConditionEntries } from './ConditionEntries';\nimport { ConditionEntry } from './ConditionEntry';\nimport { SortRadioGroup } from './SortRadioGroup';\n\nexport const CollectionFilter: React.FC<{\n  className?: string;\n  path: string;\n  onClose?: () => void;\n}> = ({ className, path, onClose }) => {\n  const collectionFilter = useCollectionFilter(path);\n  const dispatch = useDispatch();\n\n  const formMethods = useForm<CollectionFilterType>({\n    mode: 'onChange',\n    defaultValues: collectionFilter,\n  });\n\n  const cf = formMethods.watch({ nest: true });\n\n  const onSubmit = (data: CollectionFilterType) => {\n    dispatch(\n      actions.addCollectionFilter({\n        path,\n        ...data,\n      })\n    );\n    onClose?.();\n  };\n\n  return (\n    <CollectionFilterTheme>\n      <FormContext {...(formMethods as any)}>\n        <form\n          onSubmit={formMethods.handleSubmit(onSubmit)}\n          className={className}\n        >\n          {/* Field entry */}\n          <FilterItem title=\"Filter by field\" preview={cf.field} defaultOpen>\n            <Controller\n              as={Field}\n              name=\"field\"\n              label=\"Enter field\"\n              rules={{ required: 'Required' }}\n              defaultValue=\"\"\n              error={\n                (formMethods.formState.touched as any)['field'] &&\n                (formMethods.errors as any)['field']?.message\n              }\n            />\n          </FilterItem>\n\n          {/* Condition entry */}\n          <FilterItem\n            title=\"Add condition\"\n            preview={<ConditionPreview cf={cf} />}\n            defaultOpen\n          >\n            <ConditionSelect>\n              {cf && isSingleValueCollectionFilter(cf) && (\n                <ConditionEntry\n                  name=\"value\"\n                  error={\n                    (formMethods.formState.touched as any)['value'] &&\n                    (formMethods.errors as any)['value']?.message\n                  }\n                />\n              )}\n\n              {cf && isMultiValueCollectionFilter(cf) && (\n                <ConditionEntries name=\"values\" />\n              )}\n            </ConditionSelect>\n          </FilterItem>\n\n          {/* Sort entry */}\n          <FilterItem\n            title=\"Sort results\"\n            preview={isSortableCollectionFilter(cf) && cf.sort}\n            defaultOpen\n          >\n            <SortRadioGroup\n              name=\"sort\"\n              disabled={!isSortableCollectionFilter(cf)}\n            />\n          </FilterItem>\n\n          <Preview path={path} cf={cf} />\n\n          <CardActions className={styles.actions}>\n            <CardActionButtons>\n              <CardActionButton\n                type=\"button\"\n                onClick={() => {\n                  dispatch(\n                    actions.removeCollectionFilter({\n                      path,\n                    })\n                  );\n                  onClose?.();\n                }}\n              >\n                Clear\n              </CardActionButton>\n            </CardActionButtons>\n            <CardActionButtons>\n              <CardActionButton type=\"button\" onClick={() => onClose?.()}>\n                Cancel\n              </CardActionButton>\n              <CardActionButton\n                unelevated\n                type=\"submit\"\n                disabled={!formMethods.formState.isValid}\n              >\n                Apply\n              </CardActionButton>\n            </CardActionButtons>\n          </CardActions>\n        </form>\n      </FormContext>\n    </CollectionFilterTheme>\n  );\n};\n\nconst CollectionFilterTheme: React.FC = ({ children }) => (\n  <ThemeProvider options={{ background: grey100, surface: '#fff' }}>\n    <Theme use={['background']} tag=\"div\">\n      {children}\n    </Theme>\n  </ThemeProvider>\n);\n\nconst ConditionPreview: React.FC<{ cf: CollectionFilterType }> = ({ cf }) => {\n  const operator = `\"${cf.operator}\"`;\n  if (isSingleValueCollectionFilter(cf)) {\n    return <span>{`${operator}, \"${cf.value}\"`}</span>;\n  }\n  if (isMultiValueCollectionFilter(cf)) {\n    return <span>{`${operator}, ${JSON.stringify(cf.values)}`}</span>;\n  }\n  return null;\n};\n\nconst Preview: React.FC<{ path: string; cf: CollectionFilterType }> = ({\n  path,\n  cf,\n}) => {\n  const collectionId = path.split('/').pop();\n  return (\n    <code className={styles.preview} aria-label=\"Code preview\">\n      <div>.collection({`${JSON.stringify(collectionId)}`})</div>\n      {(isSingleValueCollectionFilter(cf) ||\n        isMultiValueCollectionFilter(cf)) && (\n        <div className={styles.previewFilter}>\n          .where(\"{cf.field}\", <ConditionPreview cf={cf} />)\n        </div>\n      )}\n      {isSortableCollectionFilter(cf) && !!cf.sort && (\n        <div className={styles.previewFilter}>\n          .orderBy({`\"${cf.field}\", \"${cf.sort}\"`})\n        </div>\n      )}\n    </code>\n  );\n};\n\nconst ConditionSelect: React.FC = ({ children }) => {\n  const options: Array<{\n    label: string;\n    value: firebase.firestore.WhereFilterOp;\n  }> = [\n    {\n      label: '(==) equal to',\n      value: '==',\n    },\n    {\n      label: '(!=) not equal to',\n      value: '!=',\n    },\n    {\n      label: '(>) greater than',\n      value: '>',\n    },\n    {\n      label: '(>=) greater than or equal to',\n      value: '>=',\n    },\n    {\n      label: '(<) less than',\n      value: '<',\n    },\n    {\n      label: '(<=) less than or equal to',\n      value: '<=',\n    },\n    {\n      label: '(in) equal to any of the following',\n      value: 'in',\n    },\n    {\n      label: '(not-in) not equal to any of the following',\n      value: 'not-in',\n    },\n    {\n      label: '(array-contains) an array containing',\n      value: 'array-contains',\n    },\n    {\n      label: '(array-contains-any) an array containing any',\n      value: 'array-contains-any',\n    },\n  ];\n\n  return (\n    <>\n      <Controller\n        as={SelectField}\n        name=\"operator\"\n        label=\"Only show documents where the specified field is...\"\n        placeholder=\"No condition\"\n        options={options}\n        onChange={([selected]) => selected.currentTarget.value || undefined}\n      />\n      {children}\n    </>\n  );\n};\n\n// Accordian-view for expanding/collapsing panels in the query-view\nconst FilterItem: React.FC<{\n  title: string;\n  preview?: React.ReactNode;\n  defaultOpen: boolean;\n}> = ({ title, preview, defaultOpen, children }) => {\n  const [expanded, setExpanded] = useState(defaultOpen);\n\n  return (\n    <CollapsibleList\n      className={styles.listItem}\n      defaultOpen={expanded}\n      handle={\n        <SimpleListItem\n          text={\n            <div className={styles.headerTitle}>\n              <Typography use=\"body1\">{title}</Typography>\n              {!expanded && preview && (\n                <Typography use=\"caption\">{preview}</Typography>\n              )}\n            </div>\n          }\n          metaIcon=\"chevron_right\"\n          className={styles.header}\n        />\n      }\n      onOpen={() => setExpanded(true)}\n      onClose={() => setExpanded(false)}\n    >\n      <div className={styles.children}>{children}</div>\n    </CollapsibleList>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Dialog,\n  DialogActions,\n  DialogButton,\n  DialogContent,\n  DialogOnCloseEventT,\n  DialogProps,\n  DialogTitle,\n} from '@rmwc/dialog';\nimport firebase from 'firebase';\nimport React, { useCallback, useEffect, useState } from 'react';\n\nimport { Field } from '../../common/Field';\nimport DocumentEditor from '../DocumentEditor';\nimport { FirestoreMap } from '../models';\n\nexport interface AddDocumentDialogValue {\n  id: string;\n  data: any;\n}\n\nexport interface AddDocumentStepProps {\n  collectionRef: firebase.firestore.CollectionReference;\n  onChange: (value: AddDocumentDialogValue) => void;\n}\n\nexport const AddDocumentStep: React.FC<AddDocumentStepProps> = ({\n  collectionRef,\n  onChange,\n}) => {\n  const [id, setId] = useState(collectionRef.doc().id);\n  const [data, setData] = useState<FirestoreMap | undefined>();\n\n  // TODO: Validation\n  const getValue = useCallback(() => {\n    try {\n      return { id, data };\n    } catch (e) {\n      return { id, data: { invalidData: true } };\n    }\n  }, [id, data]);\n\n  // emit initial value immediately (to capture auto generated doc id)\n  useEffect(() => {\n    onChange(getValue());\n  }, [getValue, onChange]);\n\n  const updateId = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    setId(evt.target.value);\n    onChange(getValue());\n  };\n\n  return (\n    <>\n      <Field\n        id=\"add-document-path\"\n        fullwidth\n        disabled\n        label=\"Parent path\"\n        value={collectionRef.path}\n      />\n      <Field\n        id=\"add-document-id\"\n        fullwidth\n        label=\"Document ID\"\n        value={id}\n        onChange={updateId}\n        required\n      />\n      <DocumentEditor value={{ '': '' }} onChange={(data) => setData(data)} />\n    </>\n  );\n};\n\ninterface Props extends DialogProps {\n  collectionRef: firebase.firestore.CollectionReference;\n  onValue: (v: AddDocumentDialogValue | null) => void;\n}\n\nexport const AddDocumentDialog: React.FC<Props> = ({\n  collectionRef,\n  onClose,\n  onValue,\n  ...dialogProps\n}) => {\n  const [document, setDocument] = useState<AddDocumentDialogValue>({\n    id: '',\n    data: undefined,\n  });\n\n  const emitValueAndClose = (evt: DialogOnCloseEventT) => {\n    onValue(evt.detail.action === 'accept' ? document : null);\n    onClose && onClose(evt);\n  };\n\n  return (\n    <Dialog {...dialogProps} onClose={emitValueAndClose}>\n      <DialogTitle>Add a document</DialogTitle>\n\n      <DialogContent>\n        <AddDocumentStep collectionRef={collectionRef} onChange={setDocument} />\n      </DialogContent>\n\n      <DialogActions>\n        <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n          Cancel\n        </DialogButton>\n        <DialogButton\n          unelevated\n          action=\"accept\"\n          isDefaultAction\n          disabled={!document.data}\n        >\n          Save\n        </DialogButton>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ListItem,\n  ListItemPrimaryText,\n  ListItemSecondaryText,\n  ListItemText,\n} from '@rmwc/list';\nimport { Theme } from '@rmwc/theme';\nimport classNames from 'classnames';\nimport React from 'react';\nimport { NavLink } from 'react-router-dom';\n\nimport styles from './DocumentListItem.module.scss';\nimport { FirestoreAny } from './models';\nimport { summarize } from './utils';\n\nconst DocumentListItem: React.FC<{\n  docId: string;\n  url: string;\n  queryFieldValue: FirestoreAny | undefined;\n  missing?: boolean;\n}> = ({ docId, url, queryFieldValue, missing }) => {\n  const maxSummaryLen = 20;\n\n  const listItemClass = classNames('Firestore-List-Item', {\n    [styles.missing]: missing,\n  });\n\n  return (\n    <Theme\n      use={[missing ? 'textSecondaryOnBackground' : 'textPrimaryOnBackground']}\n    >\n      <ListItem\n        className={listItemClass}\n        tag={NavLink}\n        to={`${url}/${encodeURIComponent(docId)}`}\n        activeClassName=\"mdc-list-item--activated\"\n        data-testid=\"firestore-document-list-item\"\n      >\n        {queryFieldValue === undefined ? (\n          <ListItemText>{docId}</ListItemText>\n        ) : (\n          <ListItemText data-testid=\"twoLine\">\n            <ListItemPrimaryText>\n              {summarize(queryFieldValue, maxSummaryLen)}\n            </ListItemPrimaryText>\n            <ListItemSecondaryText>{docId}</ListItemSecondaryText>\n          </ListItemText>\n        )}\n      </ListItem>\n    </Theme>\n  );\n};\n\nexport default DocumentListItem;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport useSwr from 'swr';\n\ninterface RequestOptions {\n  refreshInterval?: number;\n}\n\nexport function useFetcher<T = unknown>(\n  options: RequestInit,\n  onSuccess = (r: Response) => r.json()\n) {\n  return async (url: string) => {\n    return await fetch(url, {\n      ...options,\n      headers: {\n        ...options.headers,\n        Authorization: 'Bearer owner',\n      },\n    }).then(onSuccess);\n  };\n}\n\nexport function useRequest<T = unknown>(\n  url: string,\n  options: RequestInit,\n  { refreshInterval = 0 }: RequestOptions\n) {\n  const fetcher = useFetcher<T>(options);\n\n  return useSwr<T>(url, fetcher, {\n    refreshInterval,\n    suspense: true,\n  });\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\nimport React, { Suspense, useEffect, useState } from 'react';\nimport {\n  FirebaseAppProvider,\n  preloadFirestore,\n  useFirebaseApp,\n  useFirestore,\n} from 'reactfire';\nimport { mutate } from 'swr';\n\nimport { useEmulatedFirebaseApp } from '../../firebase';\nimport { useFirestoreConfig, useProjectId } from '../../store/config/selectors';\nimport { Spinner } from '../common/Spinner';\nimport { useFetcher, useRequest } from '../common/useRequest';\nimport { MissingDocument } from './models';\n\ninterface WindowWithFirestore extends Window {\n  firestore?: firebase.firestore.Firestore;\n}\n\n/**\n * Provide a local-FirebaseApp with a FirestoreSDK connected to\n * the Emulator Hub.\n */\nexport const FirestoreEmulatedApiProvider: React.FC<{\n  disableDevTools?: boolean;\n}> = React.memo(({ children, disableDevTools }) => {\n  const config = useFirestoreConfig();\n  const app = useEmulatedFirebaseApp('firestore', config);\n\n  return (\n    <FirebaseAppProvider firebaseApp={app}>\n      <Suspense\n        fallback={<Spinner message=\"Loading Firestore SDK\" span={12} />}\n      >\n        <FirestoreEmulatorSettings>\n          {children}\n          {disableDevTools || <FirestoreDevTools />}\n        </FirestoreEmulatorSettings>\n      </Suspense>\n    </FirebaseAppProvider>\n  );\n});\n\n// Connect FirestoreSDK to Emulator Hub\nconst FirestoreEmulatorSettings: React.FC = React.memo(({ children }) => {\n  const [connected, setConnected] = useState(false);\n  const firebaseApp = useFirebaseApp();\n  // TODO: update config to always have a firestore-config obj\n  const config = useFirestoreConfig()!;\n\n  useEffect(() => {\n    preloadFirestore({\n      firebaseApp,\n      setup: (firestore) => firestore().useEmulator(config.host, config.port),\n    }).then(() => setConnected(true));\n  }, [firebaseApp, config]);\n\n  return connected ? <>{children}</> : null;\n});\n\nconst FirestoreDevTools: React.FC = React.memo(() => {\n  const firestore = useFirestore();\n\n  useEffect(() => {\n    const windowWithFirestore = window as WindowWithFirestore;\n    windowWithFirestore.firestore = firestore;\n    console.log(`🔥 Firestore is available at window.firestore.\n\n    Try:\n    firestore.doc('hello/world').set({hello: 'world!'});\n    firestore.doc('hello/world').get().then( snap => console.log(snap.data()) );`);\n\n    return () => {\n      delete windowWithFirestore.firestore;\n    };\n  }, [firestore]);\n\n  return null;\n});\n\nfunction useFirestoreRestApi() {\n  // TODO: update config to always have a firestore-config obj\n  const config = useFirestoreConfig()!;\n  const projectId = useProjectId();\n  const databaseId = '(default)';\n\n  return {\n    baseUrl: `http://${config.hostAndPort}/v1/projects/${projectId}/databases/${databaseId}`,\n    baseEmulatorUrl: `http://${config.hostAndPort}/emulator/v1/projects/${projectId}/databases/${databaseId}`,\n  };\n}\n\nexport function useRootCollections() {\n  const { baseUrl } = useFirestoreRestApi();\n  const firestore = useFirestore();\n  const url = `${baseUrl}/documents:listCollectionIds`;\n\n  const { data } = useRequest<{ collectionIds: string[] }>(\n    url,\n    {\n      method: 'POST',\n    },\n    {\n      refreshInterval: 10_000,\n    }\n  );\n\n  const collectionIds = data?.collectionIds || [];\n  return collectionIds.map((id) => firestore.collection(id));\n}\n\nexport function useSubCollections(\n  docRef: firebase.firestore.DocumentReference\n) {\n  const { baseUrl } = useFirestoreRestApi();\n  const encodedPath = encodePath(docRef.path);\n  const url = `${baseUrl}/documents/${encodedPath}:listCollectionIds`;\n\n  const { data } = useRequest<{ collectionIds: string[] }>(\n    url,\n    {\n      method: 'POST',\n    },\n    {\n      refreshInterval: 10_000,\n    }\n  );\n\n  const collectionIds = data?.collectionIds || [];\n  return collectionIds.map((id) => docRef.collection(id));\n}\n\nconst DOCUMENT_PATH_RE = /projects\\/(?<project>.*)\\/databases\\/(?<database>.*)\\/documents\\/(?<path>.*)/;\n\nexport function useMissingDocuments(\n  collection: firebase.firestore.CollectionReference\n): MissingDocument[] {\n  const { baseUrl } = useFirestoreRestApi();\n  const encodedPath = encodePath(collection.path);\n  const url = `${baseUrl}/documents/${encodedPath}?mask.fieldPaths=_none_&pageSize=300&showMissing=true`;\n\n  const { data } = useRequest<{\n    documents: { name: string; createTime?: string }[];\n  }>(\n    url,\n    {\n      method: 'GET',\n    },\n    {\n      refreshInterval: 10_000,\n    }\n  );\n\n  return (\n    data?.documents\n      ?.filter((d) => !d.createTime)\n      .map((d) => {\n        const match = DOCUMENT_PATH_RE.exec(d.name);\n        if (!match) {\n          throw new Error(\n            `Document path \"${d.name}\" returned by API does not match regex.`\n          );\n        }\n        const [, , , path] = match;\n        return { path };\n      }) || []\n  );\n}\n\nexport function useEjector() {\n  const { baseEmulatorUrl } = useFirestoreRestApi();\n  const url = `${baseEmulatorUrl}/documents`;\n\n  const fetcher = useFetcher({\n    method: 'DELETE',\n  });\n\n  return async () => {\n    mutate('*');\n    return await fetcher(url);\n  };\n}\n\nfunction encodePath(path: string): string {\n  return path\n    .split('/')\n    .map((uri) => encodeURIComponent(uri))\n    .join('/');\n}\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './PanelHeader.scss';\n\nimport { Theme } from '@rmwc/theme';\nimport { Typography } from '@rmwc/typography';\nimport React from 'react';\n\nimport { CardActionBar, CardActionBarActions } from '../common/CardActionBar';\n\nexport const PanelHeader: React.FC<{ id: string; icon: React.ReactNode }> = ({\n  id,\n  icon,\n  children,\n}) => {\n  return (\n    <div className=\"Firestore-PanelHeader\">\n      <CardActionBar>\n        <Theme use=\"secondary\">{icon}</Theme>\n        <Typography use=\"body2\" className=\"Firestore-PanelHeader-title\">\n          {id}\n        </Typography>\n        <CardActionBarActions>{children}</CardActionBarActions>\n      </CardActionBar>\n    </div>\n  );\n};\n\nexport default PanelHeader;\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ReactNode, useEffect, useState } from 'react';\nimport React from 'react';\nimport { Redirect, useLocation, useRouteMatch } from 'react-router-dom';\n\nconst FIRESTORE_ROUTE = '/firestore';\n\n/**\n * Given a list of collections or documents, auto select the first item. Only\n * works on root (`/firestore`) or top level collections (`/firestore/users`)\n * to prevent deep auto selection.\n */\nexport function useAutoSelect<T extends { id: string }>(list?: T[] | null) {\n  const { url } = useRouteMatch()!;\n  const { pathname } = useLocation();\n  const [autoSelect, setAutoSelect] = useState<ReactNode | null>(null);\n\n  useEffect(() => {\n    const isRootOrRootCollection =\n      url === FIRESTORE_ROUTE ||\n      // /firestore/users\n      (url.startsWith(FIRESTORE_ROUTE) && url.split('/').length === 3);\n    const hasNothingSelected = url === pathname;\n    const firstChild = list?.[0];\n    const shouldAutoSelect = isRootOrRootCollection && hasNothingSelected;\n\n    setAutoSelect(\n      shouldAutoSelect && firstChild ? (\n        <Redirect to={`${url}/${encodeURIComponent(firstChild.id)}`} />\n      ) : null\n    );\n  }, [pathname, url, list, setAutoSelect]);\n\n  return autoSelect;\n}\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport { Button } from '@rmwc/button';\nimport { Icon } from '@rmwc/icon';\nimport { IconButton } from '@rmwc/icon-button';\nimport { List, ListItem } from '@rmwc/list';\nimport { MenuSurface, MenuSurfaceAnchor } from '@rmwc/menu';\nimport firebase from 'firebase';\nimport get from 'lodash.get';\nimport React, { useState } from 'react';\nimport { Route, useHistory, useRouteMatch } from 'react-router-dom';\nimport { useFirestoreCollection } from 'reactfire';\n\nimport { CopyButton } from '../common/CopyButton';\nimport { Spinner } from '../common/Spinner';\nimport styles from './Collection.module.scss';\nimport { CollectionFilter } from './CollectionFilter';\nimport {\n  AddDocumentDialog,\n  AddDocumentDialogValue,\n} from './dialogs/AddDocumentDialog';\nimport { Document } from './Document';\nimport DocumentListItem from './DocumentListItem';\nimport { useMissingDocuments } from './FirestoreEmulatedApiProvider';\nimport {\n  CollectionFilter as CollectionFilterType,\n  MissingDocument,\n  isMultiValueCollectionFilter,\n  isSingleValueCollectionFilter,\n  isSortableCollectionFilter,\n} from './models';\nimport PanelHeader from './PanelHeader';\nimport { useCollectionFilter } from './store';\nimport { useAutoSelect } from './useAutoSelect';\n\nconst NO_DOCS: firebase.firestore.QueryDocumentSnapshot<firebase.firestore.DocumentData>[] = [];\n\nexport interface Props {\n  collection: firebase.firestore.CollectionReference;\n}\n\nexport function withCollectionState(\n  Presentation: React.ComponentType<CollectionPresentationProps>\n): React.ComponentType<Props> {\n  return ({ collection }) => {\n    const [newDocumentId, setNewDocumentId] = useState<string>();\n    const collectionFilter = useCollectionFilter(collection.path);\n    const filteredCollection = applyCollectionFilter(\n      collection,\n      collectionFilter\n    );\n    const collectionSnapshot = useFirestoreCollection<unknown>(\n      filteredCollection,\n      {\n        suspense: true,\n      }\n    );\n    const history = useHistory();\n\n    const { url } = useRouteMatch()!;\n\n    const missingDocs = useMissingDocuments(collection);\n\n    const docs = collectionSnapshot.data.docs.length\n      ? collectionSnapshot.data.docs\n      : NO_DOCS;\n    const redirectIfAutoSelectable = useAutoSelect(docs);\n\n    const addDocument = async (value: AddDocumentDialogValue | null) => {\n      if (value && value.id) {\n        await collection.doc(value.id).set(value.data);\n        setNewDocumentId(value.id);\n      }\n    };\n\n    if (newDocumentId) {\n      history.push(`${url}/${encodeURIComponent(newDocumentId)}`);\n      setNewDocumentId('');\n      return null;\n    }\n\n    if (redirectIfAutoSelectable) {\n      return <>{redirectIfAutoSelectable}</>;\n    }\n\n    return (\n      <Presentation\n        collection={collection}\n        collectionFilter={collectionFilter}\n        addDocument={addDocument}\n        docs={docs}\n        missingDocs={missingDocs}\n        url={url}\n      />\n    );\n  };\n}\n\n// TODO: create a CollectionSkeleton that the loading+loaded state can utilize\nexport const CollectionLoading: React.FC<{\n  collection: firebase.firestore.CollectionReference<firebase.firestore.DocumentData>;\n}> = ({ collection }) => (\n  <div className=\"Firestore-Collection\">\n    <PanelHeader\n      id={collection.id}\n      icon={<Icon icon={{ icon: 'collections_bookmark', size: 'small' }} />}\n    />\n    <Spinner message=\"Loading collection\" />\n  </div>\n);\n\ninterface CollectionPresentationProps {\n  collection: firebase.firestore.CollectionReference<firebase.firestore.DocumentData>;\n  collectionFilter: ReturnType<typeof useCollectionFilter>;\n  addDocument: (value: AddDocumentDialogValue | null) => Promise<void>;\n  docs: firebase.firestore.QueryDocumentSnapshot<firebase.firestore.DocumentData>[];\n  missingDocs: MissingDocument[];\n  url: string;\n}\n\nexport const CollectionPresentation: React.FC<CollectionPresentationProps> = ({\n  collection,\n  collectionFilter,\n  addDocument,\n  docs,\n  missingDocs,\n  url,\n}) => {\n  const [isFilterOpen, setIsFilterOpen] = useState(false);\n  const [isAddDocumentDialogOpen, setAddDocumentDialogOpen] = useState(false);\n\n  return (\n    <>\n      <div className=\"Firestore-Collection\">\n        <PanelHeader\n          id={collection.id}\n          icon={<Icon icon={{ icon: 'collections_bookmark', size: 'small' }} />}\n        >\n          <MenuSurfaceAnchor>\n            <MenuSurface\n              open={isFilterOpen}\n              onClose={() => setIsFilterOpen(false)}\n            >\n              {isFilterOpen && (\n                <CollectionFilter\n                  className={styles['query-panel']}\n                  path={collection.path}\n                  onClose={() => setIsFilterOpen(false)}\n                />\n              )}\n            </MenuSurface>\n\n            <div className={collectionFilter && styles.badge}>\n              <CopyButton\n                textToCopy={collection.id}\n                label=\"Copy collection ID\"\n              />\n              <IconButton\n                icon=\"filter_list\"\n                label=\"Filter documents in this collection\"\n                onClick={() => setIsFilterOpen(!isFilterOpen)}\n              />\n            </div>\n          </MenuSurfaceAnchor>\n        </PanelHeader>\n\n        {isAddDocumentDialogOpen && (\n          <AddDocumentDialog\n            collectionRef={collection}\n            open={isAddDocumentDialogOpen}\n            onValue={addDocument}\n            onClose={() => setAddDocumentDialogOpen(false)}\n          />\n        )}\n        <List dense className=\"List-Actions\" tag=\"div\">\n          <ListItem\n            className=\"list-button\"\n            tag={Button}\n            label=\"Add document\"\n            {...{ dense: true, icon: 'add' }} // types get confused\n            onClick={() => setAddDocumentDialogOpen(true)}\n          ></ListItem>\n        </List>\n\n        <List\n          dense\n          className=\"Firestore-Document-List\"\n          tag=\"div\"\n          twoLine={\n            collectionFilter && isSortableCollectionFilter(collectionFilter)\n          }\n        >\n          {docs.map((doc) => (\n            <DocumentListItem\n              key={doc.ref.id}\n              url={url}\n              docId={doc.ref.id}\n              queryFieldValue={\n                collectionFilter && isSortableCollectionFilter(collectionFilter)\n                  ? get(doc.data(), collectionFilter.field)\n                  : undefined\n              }\n            />\n          ))}\n\n          {missingDocs.map((doc: { path: string }) => {\n            const id = doc.path.replace(collection.path, '').split('/')[1];\n\n            return (\n              <DocumentListItem\n                missing\n                key={id}\n                url={url}\n                docId={id}\n                queryFieldValue={undefined}\n              />\n            );\n          })}\n        </List>\n      </div>\n      <Route\n        path={`${url}/:id`}\n        render={({ match }: any) => {\n          const docId = decodeURIComponent(match.params.id);\n          const docRef = collection.doc(docId);\n          return <Document reference={docRef} />;\n        }}\n      ></Route>\n    </>\n  );\n};\n\nfunction applyCollectionFilter(\n  collection: firebase.firestore.Query<firebase.firestore.DocumentData>,\n  collectionFilter?: CollectionFilterType\n): firebase.firestore.Query<firebase.firestore.DocumentData> {\n  let filteredCollection = collection;\n  if (collectionFilter && isSingleValueCollectionFilter(collectionFilter)) {\n    filteredCollection = filteredCollection.where(\n      collectionFilter.field,\n      collectionFilter.operator,\n      collectionFilter.value\n    );\n  }\n  if (collectionFilter && isMultiValueCollectionFilter(collectionFilter)) {\n    filteredCollection = filteredCollection.where(\n      collectionFilter.field,\n      collectionFilter.operator,\n      collectionFilter.values\n    );\n  }\n  if (collectionFilter && isSortableCollectionFilter(collectionFilter)) {\n    filteredCollection = filteredCollection.orderBy(\n      collectionFilter.field,\n      collectionFilter.sort\n    );\n  }\n  return filteredCollection;\n}\n\nexport const Collection = withCollectionState(CollectionPresentation);\n\nexport default Collection;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Dialog,\n  DialogActions,\n  DialogButton,\n  DialogContent,\n  DialogOnCloseEventT,\n  DialogProps,\n  DialogTitle,\n} from '@rmwc/dialog';\nimport firebase from 'firebase';\nimport React, { useState } from 'react';\nimport { useFirestore } from 'reactfire';\n\nimport { Field } from '../../common/Field';\nimport { AddDocumentDialogValue, AddDocumentStep } from './AddDocumentDialog';\n\ninterface AddCollectionStepProps {\n  documentRef?: firebase.firestore.DocumentReference;\n  onChange: (value: string) => void;\n}\n\nexport const AddCollectionStep = ({\n  documentRef,\n  onChange,\n}: AddCollectionStepProps) => {\n  const [id, setId] = useState('');\n  const updateId = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    setId(evt.target.value);\n    onChange(evt.target.value);\n  };\n\n  return (\n    <>\n      <Field\n        label=\"Parent path\"\n        value={documentRef ? documentRef.path : '/'}\n        disabled\n      />\n\n      <Field label=\"Collection ID\" required value={id} onChange={updateId} />\n    </>\n  );\n};\n\nexport interface AddCollectionDialogValue {\n  collectionId: string;\n  document: AddDocumentDialogValue;\n}\n\ninterface Props extends DialogProps {\n  documentRef?: firebase.firestore.DocumentReference;\n  onValue: (v: AddCollectionDialogValue | null) => void;\n}\n\nenum Step {\n  COLLECTION,\n  DOCUMENT,\n}\n\nexport const AddCollectionDialog: React.FC<Props> = ({\n  documentRef,\n  onValue,\n  onClose,\n  ...dialogProps\n}) => {\n  const firestore = useFirestore();\n  const [step, setStep] = useState(Step.COLLECTION);\n  const [collectionId, setCollectionId] = useState('');\n  const [document, setDocument] = useState<AddDocumentDialogValue>({\n    id: '',\n    data: undefined,\n  });\n\n  const next = () =>\n    step === Step.COLLECTION && collectionId && setStep(step + 1);\n\n  const getValue = () => ({\n    collectionId,\n    document,\n  });\n\n  const emitValueAndClose = (evt: DialogOnCloseEventT) => {\n    onValue(evt.detail.action === 'accept' ? getValue() : null);\n    onClose && onClose(evt);\n  };\n\n  return (\n    <Dialog {...dialogProps} onClose={emitValueAndClose}>\n      <DialogTitle>Start a collection</DialogTitle>\n\n      <DialogContent>\n        {step === Step.COLLECTION ? (\n          <AddCollectionStep\n            documentRef={documentRef}\n            onChange={setCollectionId}\n          />\n        ) : (\n          <AddDocumentStep\n            collectionRef={\n              documentRef\n                ? documentRef.collection(collectionId)\n                : firestore.collection(collectionId)\n            }\n            onChange={setDocument}\n          />\n        )}\n      </DialogContent>\n\n      <DialogActions>\n        <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n          Cancel\n        </DialogButton>\n        {step === Step.DOCUMENT ? (\n          <DialogButton\n            unelevated\n            action=\"accept\"\n            isDefaultAction\n            disabled={!document.data}\n          >\n            Save\n          </DialogButton>\n        ) : (\n          <DialogButton unelevated onClick={next}>\n            Next\n          </DialogButton>\n        )}\n      </DialogActions>\n    </Dialog>\n  );\n};\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport { Button } from '@rmwc/button';\nimport { List, ListItem } from '@rmwc/list';\nimport firebase from 'firebase';\nimport React, { useState } from 'react';\nimport { NavLink, useHistory, useRouteMatch } from 'react-router-dom';\nimport { useFirestore } from 'reactfire';\n\nimport {\n  AddCollectionDialog,\n  AddCollectionDialogValue,\n} from './dialogs/AddCollectionDialog';\nimport {\n  useRootCollections,\n  useSubCollections,\n} from './FirestoreEmulatedApiProvider';\nimport { useAutoSelect } from './useAutoSelect';\n\nexport interface Props {\n  collections: firebase.firestore.CollectionReference[];\n  reference?: firebase.firestore.DocumentReference;\n}\n\nexport const RootCollectionList: React.FC = () => {\n  const rootCollections = useRootCollections();\n  return <CollectionList collections={rootCollections} />;\n};\n\nexport const SubCollectionList: React.FC<{\n  reference: firebase.firestore.DocumentReference;\n}> = ({ reference }) => {\n  const subCollections = useSubCollections(reference);\n  return <CollectionList collections={subCollections} reference={reference} />;\n};\n\nconst CollectionList: React.FC<Props> = ({ collections, reference }) => {\n  const { url } = useRouteMatch()!;\n  const history = useHistory();\n  const firestore = useFirestore();\n  const redirectIfAutoSelectable = useAutoSelect(collections);\n\n  const [isAddCollectionDialogOpen, setAddCollectionDialogOpen] = useState(\n    false\n  );\n\n  const addCollection = async (value: AddCollectionDialogValue | null) => {\n    if (value?.collectionId && value?.document.id) {\n      const ref = reference || firestore;\n      const newCollection = ref.collection(value.collectionId);\n      await newCollection.doc(value.document.id).set(value.document.data);\n\n      // Redirect to the new collection\n      const encodedCollectionId = encodeURIComponent(value.collectionId);\n      if (reference) {\n        const encodedReferencePath = reference.path\n          .split('/')\n          .map((uri) => encodeURIComponent(uri))\n          .join('/');\n        history.push(\n          `/firestore/${encodedReferencePath}/${encodedCollectionId}`\n        );\n      } else {\n        history.push(`/firestore/${encodedCollectionId}`);\n      }\n    }\n  };\n\n  return (\n    <div className=\"Firestore-CollectionList\" data-testid=\"collection-list\">\n      {redirectIfAutoSelectable}\n\n      {isAddCollectionDialogOpen && (\n        <AddCollectionDialog\n          documentRef={reference}\n          open={isAddCollectionDialogOpen}\n          onValue={addCollection}\n          onClose={() => setAddCollectionDialogOpen(false)}\n        />\n      )}\n      {/* Actions */}\n      <List dense className=\"List-Actions\" tag=\"div\">\n        <ListItem\n          className=\"list-button\"\n          tag={Button}\n          {...{ dense: true, icon: 'add' }} // types get confused\n          label=\"Start collection\"\n          onClick={() => setAddCollectionDialogOpen(true)}\n        ></ListItem>\n      </List>\n\n      <List dense tag=\"div\">\n        {collections &&\n          collections.map((coll) => (\n            <CollectionListItem\n              key={coll.id}\n              collectionId={coll.id}\n              routeMatchUrl={url}\n            />\n          ))}\n      </List>\n    </div>\n  );\n};\n\nexport const CollectionListItem: React.FC<{\n  collectionId: string;\n  routeMatchUrl: string;\n}> = ({ collectionId, routeMatchUrl }) => {\n  return (\n    <ListItem\n      key={collectionId}\n      className=\"Firestore-List-Item\"\n      tag={NavLink}\n      to={`${routeMatchUrl}/${encodeURIComponent(collectionId)}`}\n      activeClassName=\"mdc-list-item--activated\"\n      data-testid=\"firestore-collection-list-item\"\n    >\n      {collectionId}\n    </ListItem>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DialogButton } from '@rmwc/dialog';\nimport firebase from 'firebase';\nimport React from 'react';\n\nimport { Callout } from '../../common/Callout';\nimport { confirm } from '../../common/DialogQueue';\nimport { Field } from '../../common/Field';\n\nexport const promptDeleteDocument = (\n  reference: firebase.firestore.DocumentReference\n) =>\n  confirm({\n    title: 'Delete document',\n    body: (\n      <div className=\"Firestore--dialog-body\">\n        <Callout aside type=\"warning\">\n          This will permanently delete the document.\n        </Callout>\n        <Field\n          label=\"Document location\"\n          value={reference.path || '/'}\n          disabled\n        />\n      </div>\n    ),\n    // hide standard buttons so as to use `danger` button\n    acceptLabel: null,\n    cancelLabel: null,\n    footer: (\n      <>\n        <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n          Cancel\n        </DialogButton>\n        <DialogButton unelevated action=\"accept\" isDefaultAction danger>\n          Delete\n        </DialogButton>\n      </>\n    ),\n  });\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DialogButton } from '@rmwc/dialog';\nimport firebase from 'firebase';\nimport React from 'react';\n\nimport { Callout } from '../../common/Callout';\nimport { confirm } from '../../common/DialogQueue';\nimport { Field } from '../../common/Field';\n\nexport const promptDeleteDocumentFields = (\n  reference: firebase.firestore.DocumentReference\n) =>\n  confirm({\n    title: 'Delete data',\n    body: (\n      <div className=\"Firestore--dialog-body\">\n        <Callout aside type=\"warning\">\n          This will delete all fields of the document, excluding subcollections.\n        </Callout>\n        <Field\n          label=\"Document location\"\n          value={reference.path || '/'}\n          fullwidth\n          disabled\n        />\n      </div>\n    ),\n    // hide standard buttons so as to use `danger` button\n    acceptLabel: null,\n    cancelLabel: null,\n    footer: (\n      <>\n        <DialogButton action=\"close\" type=\"button\" theme=\"secondary\">\n          Cancel\n        </DialogButton>\n        <DialogButton unelevated action=\"accept\" isDefaultAction danger>\n          Delete\n        </DialogButton>\n      </>\n    ),\n  });\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from 'firebase';\n\nimport { FirestoreAny, FirestoreMap } from '../models';\nimport { isArray, isMap, withFieldRemoved, withFieldSet } from '../utils';\n\nconst DELETE_FIELD = firebase.firestore.FieldValue.delete();\n\nexport function deleteField(\n  documentRef: firebase.firestore.DocumentReference,\n  documentData: FirestoreMap,\n  path: string[]\n) {\n  const payload = adjustPayloadForArray(documentData, path, DELETE_FIELD);\n  documentRef.update(...payload);\n}\n\nexport function updateField(\n  documentRef: firebase.firestore.DocumentReference,\n  documentData: FirestoreMap,\n  path: string[],\n  value: FirestoreAny\n) {\n  const payload = adjustPayloadForArray(documentData, path, value);\n  documentRef.update(...payload);\n}\n\nexport async function addFieldToMissingDocument(\n  reference: firebase.firestore.DocumentReference,\n  key: string,\n  value: FirestoreAny\n) {\n  const snapshot = await reference.get();\n  if (snapshot.exists) {\n    // TODO: Better surface this to the user.\n    throw new Error('.set() on an existing document would delete other fields');\n  }\n\n  await reference.set({ [key]: value });\n}\n\n/**\n * Firestore does not allow array syntax when updating/deleting fields i.e.\n * .update('obj.array[2]', true)\n *\n * This normalizes a payload's `objectPath` and `updateValue` into a form\n * that writes to the top most array with a reconstructed payload contains the\n * updated (or deleted) value.\n */\nfunction adjustPayloadForArray(\n  doc: FirestoreMap,\n  fieldPath: string[],\n  value: FirestoreAny | firebase.firestore.FieldValue\n): [firebase.firestore.FieldPath, FirestoreAny] {\n  let cur: FirestoreAny | undefined = doc;\n  let parentPath: string[] = [];\n  for (const key of fieldPath) {\n    if (cur === undefined || !isMap(cur)) {\n      throw new Error(`Tried to set field ${key} on non-map value.`);\n    }\n    cur = cur[key];\n    parentPath.push(key);\n    if (parentPath.length < fieldPath.length && isArray(cur)) {\n      // Note: We're avoiding arrayUnion, arrayRemove, etc. since they may\n      // skip adding or / remove all \"equal\" elements. Checking the edge cases\n      // will require implementing Firestore deep equals locally, which is way\n      // beyond the scope of this function and hard to keep in sync.\n      // Instead, just overwrite the whole array, which may touch more data\n      // than needed, but is always correct.\n      const pathToUpdate = new firebase.firestore.FieldPath(...parentPath);\n      const childPath = fieldPath.slice(parentPath.length);\n\n      // Note: FieldValue sentinels are not guaranteed to be\n      // `instanceof FieldValue`, so let's just use type casting here.\n      if (value === DELETE_FIELD || DELETE_FIELD.isEqual(value as any)) {\n        return [pathToUpdate, withFieldRemoved(cur, childPath)];\n      } else {\n        return [pathToUpdate, withFieldSet(cur, childPath, value)];\n      }\n    }\n  }\n  return [new firebase.firestore.FieldPath(...fieldPath), value];\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport get from 'lodash.get';\nimport React from 'react';\n\nimport { FirestoreAny, FirestoreMap } from '../models';\n\nconst DocumentStateContext = React.createContext<FirestoreMap>({});\n\nexport const DocumentProvider: React.FC<{\n  value: FirestoreMap;\n}> = ({ value, children }) => {\n  return (\n    <DocumentStateContext.Provider value={value}>\n      {children}\n    </DocumentStateContext.Provider>\n  );\n};\n\nexport function useDocumentState(): FirestoreMap {\n  const context = React.useContext(DocumentStateContext);\n  if (context === undefined) {\n    throw new Error('useDocumentState must be used within a DocumentProvider');\n  }\n  return context;\n}\n\nexport function useFieldState(path: string[]): FirestoreAny {\n  const documentState = useDocumentState();\n  if (path.length === 0) return documentState;\n  return get(documentState, path);\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './FieldPreview.scss';\n\nimport { Icon } from '@rmwc/icon';\nimport { IconButton } from '@rmwc/icon-button';\nimport { ListItem, ListItemMeta } from '@rmwc/list';\nimport { Theme } from '@rmwc/theme';\nimport classnames from 'classnames';\nimport firebase from 'firebase';\nimport React, { useState } from 'react';\n\nimport { supportsEditing } from '../DocumentEditor';\nimport { FirestoreArray } from '../models';\nimport {\n  compareFirestoreKeys,\n  getFieldType,\n  getParentPath,\n  isArray,\n  isMap,\n  isPrimitive,\n  lastFieldName,\n  summarize,\n} from '../utils';\nimport { deleteField, updateField } from './api';\nimport InlineEditor from './InlineEditor';\nimport { useDocumentState, useFieldState } from './store';\n\nconst FieldPreview: React.FC<{\n  path: string[];\n  documentRef: firebase.firestore.DocumentReference;\n  maxSummaryLen: number;\n}> = ({ path, documentRef, maxSummaryLen }) => {\n  const documentData = useDocumentState();\n  const parentState = useFieldState(path.slice(0, -1));\n  const state = useFieldState(path);\n  const [isEditing, setIsEditing] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(true);\n  const [isAddingField, setIsAddingField] = useState(false);\n\n  let childFields = null;\n  if (isMap(state)) {\n    // Inline editor for new field will default to key: ''\n    childFields = Object.keys(state)\n      .sort(compareFirestoreKeys)\n      .map((childLeaf) => {\n        const childPath = [...path, childLeaf];\n        return (\n          <FieldPreview\n            key={childLeaf}\n            path={childPath}\n            documentRef={documentRef}\n            maxSummaryLen={maxSummaryLen}\n          />\n        );\n      });\n  } else if (isArray(state)) {\n    // Inline editor for new field will default to key: '{index}'\n    childFields = state.map((value, index) => {\n      const childPath = [...path, `${index}`];\n      return (\n        <FieldPreview\n          key={index}\n          path={childPath}\n          documentRef={documentRef}\n          maxSummaryLen={maxSummaryLen}\n        />\n      );\n    });\n  }\n\n  return isEditing ? (\n    <>\n      {isArray(parentState) && (\n        <InlineEditor\n          value={[state] as FirestoreArray}\n          onCancel={() => {\n            setIsEditing(false);\n          }}\n          onSave={(key, value) => {\n            updateField(documentRef, documentData, path, value);\n            setIsEditing(false);\n          }}\n          areRootKeysMutable={false}\n          firestore={documentRef.firestore}\n        />\n      )}\n      {isMap(parentState) && (\n        <InlineEditor\n          value={{ [lastFieldName(path)]: state }}\n          onCancel={() => {\n            setIsEditing(false);\n          }}\n          onSave={(key, value) => {\n            updateField(\n              documentRef,\n              documentData,\n              [...getParentPath(path), key],\n              value\n            );\n            setIsEditing(false);\n          }}\n          areRootKeysMutable={false}\n          firestore={documentRef.firestore}\n        />\n      )}\n    </>\n  ) : (\n    <>\n      <ListItem\n        onClick={() => setIsExpanded(!isExpanded)}\n        className={classnames('FieldPreview', {\n          'FieldPreview--primitive': isPrimitive(state),\n          'FieldPreview--expanded': !isPrimitive(state) && isExpanded,\n        })}\n      >\n        <Icon\n          className=\"FieldPreview-expand-icon\"\n          icon={{\n            size: 'xsmall',\n            icon: isExpanded ? 'arrow_drop_down' : 'arrow_right',\n          }}\n        />\n        <Theme use=\"secondary\" tag=\"span\" className=\"FieldPreview-key\">\n          {lastFieldName(path)}\n        </Theme>\n        <span className=\"FieldPreview-summary\">\n          {summarize(state, maxSummaryLen)}\n        </span>\n        <ListItemMeta className=\"FieldPreview-actions\">\n          <span className=\"FieldPreview-type\">({getFieldType(state)})</span>\n          {isPrimitive(state) && supportsEditing(state) && (\n            <IconButton\n              icon=\"edit\"\n              label=\"Edit field\"\n              onClick={(e) => {\n                e.stopPropagation();\n                setIsEditing(true);\n              }}\n            />\n          )}{' '}\n          {(isArray(state) || isMap(state)) && (\n            <IconButton\n              icon=\"add\"\n              label=\"Add field\"\n              onClick={(e) => {\n                e.stopPropagation();\n                setIsAddingField(true);\n              }}\n            />\n          )}\n          <IconButton\n            icon=\"delete\"\n            label=\"Remove field\"\n            onClick={(e) => {\n              e.stopPropagation();\n              deleteField(documentRef, documentData, path);\n            }}\n          />\n        </ListItemMeta>\n      </ListItem>\n\n      {isAddingField && isArray(state) && (\n        <InlineEditor\n          value={['']}\n          onCancel={() => {\n            setIsAddingField(false);\n          }}\n          startingIndex={state.length}\n          onSave={(key, value) => {\n            const newPath = [...path, `${state.length}`];\n            updateField(documentRef, documentData, newPath, value);\n            setIsAddingField(false);\n          }}\n          areRootKeysMutable={!isArray(state)}\n          firestore={documentRef.firestore}\n        />\n      )}\n\n      {isAddingField && isMap(state) && (\n        <InlineEditor\n          value={{ '': '' }}\n          onCancel={() => {\n            setIsAddingField(false);\n          }}\n          onSave={(key, value) => {\n            const newPath = [...path, key];\n            updateField(documentRef, documentData, newPath, value);\n            setIsAddingField(false);\n          }}\n          areRootKeysMutable={!isArray(state)}\n          firestore={documentRef.firestore}\n        />\n      )}\n\n      {!isPrimitive(state) && isExpanded && (\n        <div className=\"FieldPreview-children\">{childFields}</div>\n      )}\n    </>\n  );\n};\n\nexport default FieldPreview;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport './HighlightedJSON.scss';\n\nimport React from 'react';\n\nimport { CompiledGetterCache } from './CompiledGetterCache';\n\nexport enum HierarchyReferenceMode {\n  NONE,\n  DOT,\n  BRACKET,\n  INCREMENT,\n}\n\nexport interface HierarchyReference {\n  mode: HierarchyReferenceMode;\n  key: number | string;\n}\n\nconst toHierarchyStep = (key: string) => {\n  if (key.match(/^[A-Z|_]+$/i)) {\n    return {\n      mode: HierarchyReferenceMode.DOT,\n      key,\n    };\n  } else {\n    return {\n      mode: HierarchyReferenceMode.BRACKET,\n      key,\n    };\n  }\n};\n\nconst toHierarchyJS = (hierarchy: HierarchyReference[]) =>\n  hierarchy\n    .map((ref) => {\n      switch (ref.mode) {\n        case HierarchyReferenceMode.NONE:\n          return ref.key;\n        case HierarchyReferenceMode.BRACKET:\n          return `[\"${ref.key}\"]`;\n        case HierarchyReferenceMode.DOT:\n          return `.${ref.key}`;\n        case HierarchyReferenceMode.INCREMENT:\n          return `[${JSON.stringify(ref.key)}]`;\n      }\n\n      return '';\n    })\n    .join('');\n\nexport interface Props {\n  data: object;\n  appendToQuery: (key: string, value: string) => void;\n  compiledGetters: CompiledGetterCache;\n}\n\nexport const HighlightedJSON: React.FC<Props> = ({\n  data,\n  appendToQuery,\n  compiledGetters,\n}) => {\n  const lines = JSON.stringify(data, null, 2).split('\\n');\n\n  if (lines.length === 1)\n    return <div className=\"log-message-single\">{data}</div>;\n\n  let isObject = false;\n\n  let hierarchy: HierarchyReference[] = [\n    {\n      mode: HierarchyReferenceMode.NONE,\n      key: 'user',\n    },\n  ];\n\n  const pluck = (obj: any, path: string) => {\n    return compiledGetters.getOrCompile(path, { user: obj });\n  };\n\n  const elements = lines.map((line, index) => {\n    const quote_count = line.split('\"').length - 1;\n\n    const isStart = index === 0 && line.startsWith('{');\n    const isEnd = index === lines.length - 1 && line.endsWith('}');\n\n    const isEmptyArray = line.endsWith('[]') || line.endsWith('[],');\n    const isEmptyObj = line.endsWith('{}') || line.endsWith('{},');\n\n    const isKeyedObjStart =\n      quote_count >= 2 && (line.endsWith('{') || isEmptyObj);\n    const isKeyedArrayStart =\n      quote_count >= 2 && (line.endsWith('[') || isEmptyArray);\n\n    const isKeylessArrayStart =\n      !isKeyedArrayStart && (line.endsWith('[') || isEmptyArray);\n    const isKeylessObjStart =\n      !isKeylessArrayStart && (line.endsWith('{') || isEmptyObj);\n\n    const isLiteral =\n      !line.endsWith('[') &&\n      !line.endsWith('{') &&\n      !line.endsWith('}') &&\n      !line.endsWith('},');\n\n    const isObjEnd = line.endsWith('}') || line.endsWith('},');\n    const isArrayEnd = line.endsWith(']') || line.endsWith('],');\n\n    if (isStart) {\n      isObject = true;\n      return (\n        <div key={index} className=\"line start\">\n          {line}\n        </div>\n      );\n    }\n\n    if (isEnd) {\n      return (\n        <div key={index} className=\"line end\">\n          {line}\n        </div>\n      );\n    }\n\n    if (isKeylessObjStart || isKeylessArrayStart || isLiteral) {\n      const ref = hierarchy[hierarchy.length - 1];\n      if (ref.mode === HierarchyReferenceMode.INCREMENT) {\n        (ref as any).key += 1;\n      }\n    }\n\n    if (isKeylessObjStart) {\n      hierarchy.push({ mode: HierarchyReferenceMode.NONE, key: '' });\n    }\n\n    if (isKeylessArrayStart) {\n      hierarchy.push({ mode: HierarchyReferenceMode.NONE, key: '' });\n      hierarchy.push({ mode: HierarchyReferenceMode.INCREMENT, key: -1 });\n    }\n\n    if (isKeyedObjStart || isKeyedArrayStart) {\n      const [start, ...splat] = line.split(':');\n      const [indent, ...key_chunks] = start.split('\"');\n      const key = key_chunks.filter((v: string) => v).join('\"');\n      const value = splat.join(':');\n\n      hierarchy.push(toHierarchyStep(key));\n      const hierarchy_chain = toHierarchyJS(hierarchy);\n\n      if (isKeyedArrayStart) {\n        hierarchy.push({ mode: HierarchyReferenceMode.INCREMENT, key: -1 });\n      }\n\n      if (isArrayEnd) {\n        hierarchy.pop(); // Remove reference with array name (i.e. \"users\")\n        hierarchy.pop(); // Remove reference with array index (i.e. 3)\n      }\n\n      if (isObjEnd) {\n        hierarchy.pop();\n      }\n\n      return (\n        <div key={index} className=\"line object-start\">\n          {indent}\n          <div\n            className=\"clickable key\"\n            onClick={() => appendToQuery(hierarchy_chain, '*')}\n          >\n            \"{key}\"\n          </div>\n          :{value}\n        </div>\n      );\n    }\n\n    if (isObjEnd) {\n      if (\n        hierarchy[hierarchy.length - 1].mode !==\n        HierarchyReferenceMode.INCREMENT\n      ) {\n        hierarchy.pop();\n      }\n      return (\n        <div key={index} className=\"line object-end\">\n          {line}\n        </div>\n      );\n    }\n\n    if (isArrayEnd) {\n      hierarchy.pop(); // Remove reference with array name (i.e. \"users\")\n      hierarchy.pop(); // Remove reference with array index (i.e. 3)\n\n      return (\n        <div key={index} className=\"line array-end\">\n          {line}\n        </div>\n      );\n    }\n\n    if (isLiteral) {\n      if (!isObject) {\n        return (\n          <div key={index} className=\"line literal\">\n            <div className=\"value clickable\">{line}</div>\n          </div>\n        );\n      }\n\n      const [start, ...splat] = line.split(':');\n      const key_chunks = start.split('\"').slice(1);\n      const key = key_chunks.filter((v: string) => v).join('\"');\n      const value = splat.join(':').trim();\n\n      const new_indent = new Array(line.length - line.trim().length + 1).join(\n        ' '\n      );\n      if (key && value) {\n        const hierarchy_chain = toHierarchyJS([\n          ...hierarchy,\n          toHierarchyStep(key),\n        ]);\n        return (\n          <div key={index} className=\"line literal\">\n            {new_indent}\n            <div\n              className=\"key clickable\"\n              onClick={() => appendToQuery(hierarchy_chain, '*')}\n            >\n              \"{key}\"\n            </div>\n            :{' '}\n            <div\n              className=\"clickable value\"\n              onClick={() =>\n                appendToQuery(hierarchy_chain, pluck(data, hierarchy_chain))\n              }\n            >\n              {value}\n            </div>\n          </div>\n        );\n      } else {\n        const hierarchy_chain = toHierarchyJS(hierarchy);\n        return (\n          <div key={index} className=\"line literal\">\n            {new_indent}\n            <div\n              className=\"clickable value\"\n              onClick={() =>\n                appendToQuery(hierarchy_chain, pluck(data, hierarchy_chain))\n              }\n            >\n              {line.trim()}\n            </div>\n          </div>\n        );\n      }\n    }\n\n    return (\n      <div key={index} className={`line generic`}>\n        {line}\n      </div>\n    );\n  });\n\n  return <div className=\"HighlightedJSON\">{elements}</div>;\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Button } from '@rmwc/button';\nimport { List, ListItem } from '@rmwc/list';\nimport { Typography } from '@rmwc/typography';\nimport firebase from 'firebase';\nimport React, { useState } from 'react';\nimport { useFirestoreDoc } from 'reactfire';\n\nimport { FirestoreMap } from '../models';\nimport { compareFirestoreKeys } from '../utils';\nimport { addFieldToMissingDocument, updateField } from './api';\nimport FieldPreview from './FieldPreview';\nimport InlineEditor from './InlineEditor';\nimport { DocumentProvider } from './store';\n\nexport interface Props {\n  reference: firebase.firestore.DocumentReference;\n  maxSummaryLen?: number;\n}\n\nconst DocumentPreview: React.FC<Props> = ({\n  reference,\n  maxSummaryLen = 20,\n}) => {\n  const snapshot = useFirestoreDoc(reference, { suspense: true }).data;\n  const [isAddingField, setIsAddingField] = useState(false);\n  const docExists = snapshot.exists;\n  const data = docExists ? (snapshot.data() as FirestoreMap) : {};\n  const docEmpty = docExists && Object.keys(data).length === 0;\n\n  return (\n    <>\n      <DocumentProvider value={data || {}}>\n        <List\n          dense\n          className=\"List-Actions Firestore-Document-Fields\"\n          tag=\"div\"\n        >\n          {/* Actions */}\n          <ListItem\n            className=\"list-button\"\n            tag={Button}\n            label=\"Add field\"\n            {...{ dense: true, icon: 'add' }} // types get confused\n            onClick={() => setIsAddingField(true)}\n          ></ListItem>\n\n          {isAddingField && (\n            <InlineEditor\n              value={{ '': '' }}\n              onCancel={() => {\n                setIsAddingField(false);\n              }}\n              onSave={async (key, value) => {\n                if (!docExists) {\n                  await addFieldToMissingDocument(reference, key, value);\n                } else {\n                  updateField(reference, data, [key], value);\n                }\n                setIsAddingField(false);\n              }}\n              areRootKeysMutable={true}\n              firestore={reference.firestore}\n            />\n          )}\n\n          {docExists && !docEmpty && (\n            <div className=\"Firestore-Field-List\">\n              {Object.keys(data)\n                .sort(compareFirestoreKeys)\n                .map((name) => (\n                  <FieldPreview\n                    key={name}\n                    path={[name]}\n                    documentRef={reference}\n                    maxSummaryLen={maxSummaryLen}\n                  />\n                ))}\n            </div>\n          )}\n          {!docExists && (\n            <DocumentWarning>\n              This document does not exist, it will not appear in queries or\n              snapshots\n            </DocumentWarning>\n          )}\n          {docEmpty && (\n            <DocumentWarning>This document has no data</DocumentWarning>\n          )}\n        </List>\n      </DocumentProvider>\n    </>\n  );\n};\n\nconst DocumentWarning: React.FC<{}> = ({ children }) => (\n  <Typography\n    theme=\"secondary\"\n    use=\"body2\"\n    className=\"Firestore-Document-Warning\"\n  >\n    <i>{children}</i>\n  </Typography>\n);\n\nexport default DocumentPreview;\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport { Icon } from '@rmwc/icon';\nimport { IconButton } from '@rmwc/icon-button';\nimport { ListDivider } from '@rmwc/list';\nimport { MenuItem, SimpleMenu } from '@rmwc/menu';\nimport firebase from 'firebase';\nimport React, { Suspense } from 'react';\nimport { Route, useRouteMatch } from 'react-router-dom';\nimport { useFirestore } from 'reactfire';\n\nimport { CopyButton } from '../common/CopyButton';\nimport { FirestoreIcon } from '../common/icons';\nimport { Spinner } from '../common/Spinner';\nimport Collection, { CollectionLoading } from './Collection';\nimport { RootCollectionList, SubCollectionList } from './CollectionList';\nimport { promptDeleteDocument } from './dialogs/deleteDocument';\nimport { promptDeleteDocumentFields } from './dialogs/deleteDocumentFields';\nimport DocumentPreview from './DocumentPreview';\nimport PanelHeader from './PanelHeader';\n\nconst Doc: React.FC<{\n  id: string;\n  collectionById: (id: string) => firebase.firestore.CollectionReference;\n  children: React.ReactNode;\n}> = ({ collectionById, children }) => {\n  const { url } = useRouteMatch()!;\n\n  return (\n    <>\n      <div className=\"Firestore-Document\">{children}</div>\n\n      <Route\n        path={`${url}/:id`}\n        render={({ match }: any) => {\n          return (\n            <Suspense\n              fallback={\n                <CollectionLoading\n                  collection={collectionById(\n                    decodeURIComponent(match.params.id)\n                  )}\n                />\n              }\n            >\n              <Collection\n                collection={collectionById(decodeURIComponent(match.params.id))}\n              />\n            </Suspense>\n          );\n        }}\n      ></Route>\n    </>\n  );\n};\n\n/** Root node */\nexport const Root: React.FC = () => {\n  const firestore = useFirestore();\n\n  return (\n    <Doc id={'Root'} collectionById={(id: string) => firestore.collection(id)}>\n      <PanelHeader id=\"Root\" icon={<FirestoreIcon />} />\n      <Suspense fallback={<Spinner message=\"Loading collections\" />}>\n        <RootCollectionList />\n      </Suspense>\n    </Doc>\n  );\n};\n\n/** Document node */\nexport const Document: React.FC<{\n  reference: firebase.firestore.DocumentReference;\n}> = ({ reference }) => {\n  const handleDeleteDocument = async () => {\n    const shouldDelete = await promptDeleteDocument(reference);\n    // TODO: recursively delete sub documents\n    shouldDelete && reference.delete();\n  };\n\n  const handleDeleteFields = async () => {\n    const shouldDelete = await promptDeleteDocumentFields(reference);\n    shouldDelete && reference.set({});\n  };\n\n  return (\n    <Doc\n      id={reference.id}\n      collectionById={(id: string) => reference.collection(id)}\n    >\n      <PanelHeader\n        id={reference.id}\n        icon={<Icon icon={{ icon: 'insert_drive_file', size: 'small' }} />}\n      >\n        <CopyButton textToCopy={reference.id} label=\"Copy document ID\" />\n        <SimpleMenu handle={<IconButton icon=\"more_vert\" />} renderToPortal>\n          <MenuItem onClick={handleDeleteDocument}>Delete document</MenuItem>\n          <MenuItem onClick={handleDeleteFields}>Delete all fields</MenuItem>\n        </SimpleMenu>\n      </PanelHeader>\n\n      <Suspense fallback={<Spinner message=\"Loading collections\" />}>\n        <SubCollectionList reference={reference} />\n      </Suspense>\n      <ListDivider tag=\"div\" />\n      <Suspense fallback={<Spinner message=\"Loading document\" />}>\n        <DocumentPreview reference={reference} />\n      </Suspense>\n    </Doc>\n  );\n};\n","/**\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport { Button } from '@rmwc/button';\nimport { Card } from '@rmwc/card';\nimport { Elevation } from '@rmwc/elevation';\nimport { GridCell } from '@rmwc/grid';\nimport firebase from 'firebase';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { useFirestore } from 'reactfire';\n\nimport { createStructuredSelector } from '../../store';\nimport {\n  getFirestoreConfigResult,\n  getProjectIdResult,\n} from '../../store/config/selectors';\nimport { combineData, handle } from '../../store/utils';\nimport { CustomThemeProvider } from '../../themes';\nimport { EmulatorDisabled } from '../common/EmulatorDisabled';\nimport { InteractiveBreadCrumbBar } from '../common/InteractiveBreadCrumbBar';\nimport { Spinner } from '../common/Spinner';\nimport { promptClearAll } from './dialogs/clearAll';\nimport { Root } from './Document';\nimport {\n  FirestoreEmulatedApiProvider,\n  useEjector,\n} from './FirestoreEmulatedApiProvider';\nimport PanelHeader from './PanelHeader';\nimport { FirestoreStore } from './store';\n\ninterface WindowWithFirestoreDb extends Window {\n  firestore?: firebase.firestore.Firestore;\n}\n\nexport const mapStateToProps = createStructuredSelector({\n  projectIdResult: getProjectIdResult,\n  configResult: getFirestoreConfigResult,\n});\n\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport const FirestoreRoute: React.FC<PropsFromState> = ({\n  projectIdResult,\n  configResult,\n}) => {\n  return handle(combineData(projectIdResult, configResult), {\n    onNone: () => <Spinner span={12} message=\"Firestore Emulator Loading...\" />,\n    onError: () => <FirestoreRouteDisabled />,\n    onData: ([projectId, config]) =>\n      config === undefined ? (\n        <FirestoreRouteDisabled />\n      ) : (\n        <FirestoreEmulatedApiProvider>\n          <Firestore />\n        </FirestoreEmulatedApiProvider>\n      ),\n  });\n};\n\nexport default connect(mapStateToProps)(FirestoreRoute);\n\nexport const Firestore: React.FC = React.memo(() => {\n  const firestore = useFirestore();\n  const location = useLocation();\n  const history = useHistory();\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const eject = useEjector();\n\n  // TODO: do something better here!\n  const path = location.pathname.replace(/^\\/firestore/, '');\n  const showCollectionShell = path.split('/').length < 2;\n  const showDocumentShell = path.split('/').length < 3;\n\n  useEffect(() => {\n    (window as WindowWithFirestoreDb).firestore = firestore;\n    return () => ((window as WindowWithFirestoreDb).firestore = undefined);\n  }, [firestore]);\n\n  async function handleClearData() {\n    const shouldNuke = await promptClearAll();\n    if (!shouldNuke) return;\n    setIsRefreshing(true);\n    await eject();\n    handleNavigate();\n    setIsRefreshing(false);\n  }\n\n  function handleNavigate(path?: string) {\n    // TODO: move to routing constants\n    const root = '/firestore';\n    if (path === undefined) {\n      history.push(root);\n    } else {\n      history.push(`${root}/${path}`);\n    }\n  }\n\n  return isRefreshing ? (\n    <Spinner span={12} data-testid=\"firestore-loading\" />\n  ) : (\n    <FirestoreStore>\n      <GridCell span={12} className=\"Firestore\">\n        <div className=\"Firestore-actions\">\n          <CustomThemeProvider use=\"warning\" wrap>\n            <Button unelevated onClick={() => handleClearData()}>\n              Clear all data\n            </Button>\n          </CustomThemeProvider>\n        </div>\n        <Elevation z=\"2\" wrap>\n          <Card className=\"Firestore-panels-wrapper\">\n            <InteractiveBreadCrumbBar\n              base=\"/firestore\"\n              path={path}\n              onNavigate={handleNavigate}\n            />\n            <div className=\"Firestore-panels\">\n              <Root />\n              {showCollectionShell && (\n                <div\n                  className=\"Firestore-Collection\"\n                  data-testid=\"collection-shell\"\n                >\n                  <PanelHeader id=\"\" icon={null} />\n                </div>\n              )}\n              {showDocumentShell && (\n                <div\n                  className=\"Firestore-Document\"\n                  data-testid=\"document-shell\"\n                >\n                  <PanelHeader id=\"\" icon={null} />\n                </div>\n              )}\n            </div>\n          </Card>\n        </Elevation>\n      </GridCell>\n    </FirestoreStore>\n  );\n});\n\nexport const FirestoreRouteDisabled: React.FC = () => (\n  <EmulatorDisabled productName=\"Firestore\" />\n);\n","import { useLocalStorage, writeStorage } from '@rehooks/local-storage';\nimport { Button } from '@rmwc/button';\nimport { GridCell } from '@rmwc/grid';\nimport React from 'react';\n\nimport { Callout } from '../common/Callout';\nimport { CONSOLE_ROOT } from '../common/constants';\n\nconst DISMISS_KEY = 'isLocalWarningCalloutDismissed';\n\nexport const LocalWarningCallout: React.FC<{\n  projectId: string;\n}> = ({ projectId }) => {\n  const [isDismissed] = useLocalStorage<boolean>(DISMISS_KEY);\n\n  if (isDismissed) {\n    return null;\n  }\n\n  return (\n    <GridCell span={12}>\n      <Callout\n        type=\"note\"\n        actions={\n          <>\n            <Button\n              tag=\"a\"\n              href={`${CONSOLE_ROOT}/project/${projectId}/overview`}\n              target=\"_blank\"\n              label=\"View project\"\n            />\n            <Button\n              label=\"Dismiss\"\n              onClick={() => writeStorage(DISMISS_KEY, true)}\n            />\n          </>\n        }\n      >\n        Remember this is a local environment. Visit the production version of{' '}\n        <strong>{projectId}</strong> in the console.\n      </Callout>\n    </GridCell>\n  );\n};\n","export const CONSOLE_ROOT = 'https://console.firebase.google.com';\n","import { Icon } from '@rmwc/icon';\nimport { Typography } from '@rmwc/typography';\nimport React from 'react';\n\nimport { CustomThemeProvider } from '../../themes';\nimport styles from './StatusLabel.module.scss';\n\nconst ACTIVE_ICON = {\n  icon: 'check_circle',\n  size: 'xsmall',\n};\n\nconst INACTIVE_ICON = {\n  icon: 'block',\n  size: 'xsmall',\n};\n\n/** A basic On/Off label with icon */\nexport const StatusLabel: React.FC<{\n  isActive: boolean;\n}> = ({ isActive }) => {\n  return (\n    <CustomThemeProvider use={isActive ? 'success' : 'note'} wrap>\n      <Typography\n        use=\"headline6\"\n        tag=\"div\"\n        theme={isActive ? 'primary' : 'secondary'}\n        className={styles.container}\n      >\n        {isActive ? 'On' : 'Off'}\n        <Icon\n          icon={isActive ? ACTIVE_ICON : INACTIVE_ICON}\n          className={styles.icon}\n        />\n      </Typography>\n    </CustomThemeProvider>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport {\n  Card,\n  CardActionButton,\n  CardActionIcons,\n  CardActions,\n} from '@rmwc/card';\nimport { GridCell, GridRow } from '@rmwc/grid';\nimport { ListDivider } from '@rmwc/list';\nimport { Typography } from '@rmwc/typography';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\n\nimport { createStructuredSelector } from '../../store';\nimport { Config, EmulatorConfig } from '../../store/config';\nimport { getConfig } from '../../store/config/selectors';\nimport { squash } from '../../store/utils';\nimport {\n  AuthIcon,\n  DatabaseIcon,\n  FirestoreIcon,\n  FunctionsIcon,\n  HostingIcon,\n  PubSubIcon,\n} from '../common/icons';\nimport { Spinner } from '../common/Spinner';\nimport { LocalWarningCallout } from './LocalWarningCallout';\nimport { StatusLabel } from './StatusLabel';\n\nexport const mapStateToProps = createStructuredSelector({\n  configRemote: getConfig,\n});\n\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\nexport type Props = PropsFromState;\n\nexport const Home: React.FC<Props> = ({ configRemote }) =>\n  squash(configRemote, {\n    onNone: () => <Spinner span={12} message=\"Overview Page Loading...\" />,\n    onData: (config) => <Overview config={config} />,\n    // Show all emulators as \"off\" on error.\n    onError: () => <Overview config={{}} />,\n  });\n\nexport default connect(mapStateToProps)(Home);\n\nconst Overview: React.FC<{\n  config: Partial<Config>;\n}> = ({ config }) => {\n  return (\n    <GridCell span={12}>\n      <GridRow>\n        {config.projectId && (\n          <LocalWarningCallout projectId={config.projectId} />\n        )}\n        <GridCell span={12}>\n          <Typography use=\"headline5\">Emulator overview</Typography>\n        </GridCell>\n        <EmulatorCard\n          name=\"Authentication emulator\"\n          icon={<AuthIcon theme=\"secondary\" />}\n          config={config.auth}\n          linkTo=\"/auth\"\n          testId=\"emulator-info-auth\"\n        />\n        <EmulatorCard\n          name=\"Firestore emulator\"\n          icon={<FirestoreIcon theme=\"secondary\" />}\n          config={config.firestore}\n          linkTo=\"/firestore\"\n          testId=\"emulator-info-firestore\"\n        />\n        <EmulatorCard\n          name=\"Realtime Database emulator\"\n          icon={<DatabaseIcon theme=\"secondary\" />}\n          config={config.database}\n          linkTo=\"/database\"\n          testId=\"emulator-info-database\"\n        />\n        <EmulatorCard\n          name=\"Functions emulator\"\n          icon={<FunctionsIcon theme=\"secondary\" />}\n          config={config.functions}\n          linkTo=\"/functions\"\n          linkLabel=\"View logs\"\n          testId=\"emulator-info-functions\"\n        />\n        <EmulatorCard\n          name=\"Hosting emulator\"\n          icon={<HostingIcon theme=\"secondary\" />}\n          config={config.hosting}\n          testId=\"emulator-info-hosting\"\n          linkToExternal={\n            config.hosting && `http://${config.hosting.hostAndPort}/`\n          }\n          linkLabel=\"View website\"\n        />\n        <EmulatorCard\n          name=\"PubSub emulator\"\n          icon={<PubSubIcon theme=\"secondary\" />}\n          config={config.pubsub}\n          testId=\"emulator-info-pubsub\"\n        />\n      </GridRow>\n    </GridCell>\n  );\n};\n\nexport const EmulatorCard: React.FC<{\n  name: string;\n  icon: React.ReactElement;\n  config: EmulatorConfig | undefined;\n  linkTo?: string;\n  linkToExternal?: string;\n  linkLabel?: string;\n  testId?: string;\n}> = ({ name, icon, config, linkTo, linkLabel, linkToExternal, testId }) => (\n  <GridCell span={4}>\n    <Card className=\"Home-EmulatorCard\" data-testid={testId}>\n      <div className=\"Home-EmulatorCard-Info\">\n        <Typography use=\"headline6\" tag=\"h3\" className=\"title\">\n          {icon} <span>{name}</span>\n        </Typography>\n        <Typography use=\"body2\" tag=\"h4\" theme=\"secondary\">\n          Status\n        </Typography>\n        <StatusLabel isActive={!!config} />\n        <Typography use=\"body2\" tag=\"h4\" theme=\"secondary\">\n          Port number\n        </Typography>\n        <Typography use=\"headline6\" tag=\"div\">\n          {config ? config.port : 'N/A'}\n        </Typography>\n      </div>\n      {(linkToExternal || linkTo) && <ListDivider tag=\"div\" />}\n      <CardActions>\n        <CardActionIcons>\n          {linkToExternal && (\n            <CardActionButton tag=\"a\" href={linkToExternal} target=\"_blank\">\n              {linkLabel}\n            </CardActionButton>\n          )}\n          {linkTo && (\n            <CardActionButton tag={Link} to={linkTo}>\n              {linkLabel || 'Go to emulator'}\n            </CardActionButton>\n          )}\n        </CardActionIcons>\n      </CardActions>\n    </Card>\n  </GridCell>\n);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class CompiledGetterCache {\n  getters: { [path: string]: Function } = {};\n\n  getOrCompile(path: string, obj: any) {\n    if (!this.getters[path]) {\n      try {\n        // eslint-disable-next-line no-new-func\n        this.getters[path] = new Function('obj', 'return obj.' + path + ';');\n      } catch (err) {\n        console.warn(err);\n        return undefined;\n      }\n    }\n\n    try {\n      return this.getters[path](obj);\n    } catch (err) {\n      return undefined;\n    }\n  }\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport './QueryBar.scss';\n\nimport { Button } from '@rmwc/button';\nimport React, { useEffect, useState } from 'react';\n\nimport { LogEntry } from '../../store/logviewer';\nimport { CompiledGetterCache } from './CompiledGetterCache';\n\nexport const filtersToQueryString = (filters: {\n  [key: string]: string | number;\n}) => {\n  const formattedQueryLines = [];\n  for (const key in filters) {\n    formattedQueryLines.push(`${key}=${JSON.stringify(filters[key])}`);\n  }\n  return formattedQueryLines.sort().join('\\n');\n};\n\nexport const isQueryMatch = (\n  query: { filters: { [key: string]: string } },\n  log: LogEntry,\n  compiledGetters: CompiledGetterCache\n) => {\n  for (const originalFieldPath of Object.keys(query.filters)) {\n    if (originalFieldPath === 'search') {\n      const stringifedLog = JSON.stringify(log).toLowerCase();\n\n      if (\n        stringifedLog.indexOf(\n          query.filters[originalFieldPath].toLowerCase()\n        ) === -1\n      ) {\n        return false;\n      }\n    } else {\n      let fieldPath = originalFieldPath;\n      if (\n        fieldPath.startsWith('user.') ||\n        fieldPath.startsWith('metadata.') ||\n        fieldPath.startsWith('user[') ||\n        fieldPath.startsWith('metadata[')\n      ) {\n        fieldPath = `data.${fieldPath}`;\n      }\n\n      const fieldValue = query.filters[originalFieldPath];\n      const value = compiledGetters.getOrCompile(fieldPath, log);\n      if (\n        !value ||\n        (fieldValue !== undefined &&\n          fieldValue !== '*' &&\n          fieldValue.toString() !== value.toString())\n      ) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n};\n\nexport interface ParsedQuery {\n  elements: JSX.Element[];\n  filters: { [key: string]: string };\n}\n\nconst queryFields = [\n  'level',\n  'search',\n  'metadata.emulator',\n  'metadata.emulator.name',\n  'metadata.function',\n  'metadata.function.name',\n];\nexport function parseQuery(query: string): ParsedQuery {\n  let escapedQuery = '';\n  let isEscaped = false;\n\n  for (const char of query) {\n    if (isEscaped) {\n      escapedQuery += 'ˍ';\n      isEscaped = false;\n    } else {\n      escapedQuery += char;\n\n      if (char === '\\\\') {\n        isEscaped = true;\n      }\n    }\n  }\n\n  const quoted_query = escapedQuery\n    .split('\"')\n    .map((t, i) => (i % 2 ? t.replace(/ /g, 'ˍ') : t))\n    .join('\"');\n\n  const sections: string[] = quoted_query\n    .split('\\n')\n    .reduce((sections, line) => {\n      return [\n        ...sections,\n        ...line.split(/((?:[^\\s]+)\\s?=\\s?(?:[^\\s]+))/),\n        '\\n',\n      ];\n    }, [] as string[]);\n\n  const filters: { [key: string]: string } = {};\n  const queryChunks: string[] = [];\n\n  let position = 0;\n  const elements = sections.map((quoted_section, index) => {\n    const section = query.slice(position, position + quoted_section.length);\n    position += quoted_section.length;\n\n    const equalPosition = section.indexOf('=');\n    const isKeyPair =\n      equalPosition > -1 && section[0] !== '=' && section.slice(-1)[0] !== '=';\n    const isNewline = section === '\\n';\n\n    if (isNewline) {\n      return <br key={index} />;\n    }\n    if (!isKeyPair) {\n      queryChunks.push(section);\n      return (\n        <span key={index} className=\"text\">\n          {section}\n        </span>\n      );\n    }\n\n    const pairKey = section.split('=')[0].trim();\n    if (\n      isKeyPair &&\n      queryFields.indexOf(pairKey) === -1 &&\n      !(pairKey.startsWith('user.') || pairKey.startsWith('user['))\n    ) {\n      return (\n        <span key={index}>\n          <span className=\"invalid_pair\">{section}</span>\n        </span>\n      );\n    }\n\n    const [key, value] = section.split('=');\n    try {\n      filters[key.trim()] = JSON.parse(value);\n    } catch (err) {\n      filters[key.trim()] = value;\n    }\n    return (\n      <span key={index}>\n        <span className=\"key\">{key}=</span>\n        <span className=\"value\">{value}</span>\n      </span>\n    );\n  });\n\n  const search = [\n    filters.search,\n    queryChunks\n      .filter((v) => v)\n      .join(' ')\n      .trim(),\n  ]\n    .filter((v) => v)\n    .join(' ');\n\n  if (search.length) filters.search = search;\n\n  return {\n    elements,\n    filters,\n  };\n}\n\ninterface Props {\n  query: string;\n  setQuery: (query: string) => void;\n  compiledGetters: CompiledGetterCache;\n}\n\nexport const QueryBar: React.FC<Props> = ({ query, setQuery }) => {\n  const [temporaryQuery, setTemporaryQuery] = useState('');\n\n  useEffect(() => {\n    setTemporaryQuery(query);\n  }, [query]);\n\n  const parsedQuery = parseQuery(temporaryQuery);\n\n  return (\n    <div className=\"QueryBar\">\n      <div className=\"QueryBar-render\">{parsedQuery.elements}</div>\n      <textarea\n        rows={1}\n        className=\"QueryBar-input\"\n        spellCheck={false}\n        value={temporaryQuery}\n        onChange={(e) => setTemporaryQuery((e.target as any).value)}\n        placeholder=\"Filter or search logs...\"\n      ></textarea>\n      <div className=\"QueryBar-actions\">\n        <Button\n          unelevated\n          onClick={() => setQuery(temporaryQuery)}\n          disabled={query === temporaryQuery}\n        >\n          Apply\n        </Button>\n        <Button\n          unelevated\n          disabled={!temporaryQuery.length}\n          onClick={() => {\n            setTemporaryQuery('');\n            setQuery('');\n          }}\n        >\n          Reset\n        </Button>\n      </div>\n    </div>\n  );\n};\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EmulatorConfig } from '../../store/config';\n\nexport enum WebSocketState {\n  DISCONNECTED,\n  CONNECTED,\n  PENDING,\n}\n\nexport class ReconnectingWebSocket {\n  state: WebSocketState = WebSocketState.DISCONNECTED;\n  listener: Function | undefined = undefined;\n  interval: number | undefined = undefined;\n  ws: WebSocket | undefined = undefined;\n\n  constructor(config: EmulatorConfig) {\n    this.connect(config);\n    // XXX: The Node.js typings for setInterval is leaking in, which causes the\n    // function to be typed to return NodeJS.Timeout and thus the as-any cast.\n    // TODO: Remove Node.js typings from source files for the web.\n    this.interval = setInterval(() => this.connect(config), 1000) as any;\n  }\n\n  private connect(config: EmulatorConfig) {\n    if (this.state !== WebSocketState.DISCONNECTED) return;\n\n    const ws = new WebSocket(`ws://${config.hostAndPort}`);\n    this.ws = ws;\n    this.state = WebSocketState.PENDING;\n\n    ws.onopen = () => {\n      this.state = WebSocketState.CONNECTED;\n    };\n\n    ws.onclose = () => {\n      this.state = WebSocketState.DISCONNECTED;\n    };\n\n    ws.onmessage = (msg) => {\n      const data = JSON.parse(msg.data);\n      this.listener && this.listener(data);\n    };\n  }\n\n  cleanup() {\n    this.listener = undefined;\n    if (this.interval) clearInterval(this.interval);\n    if (this.ws) this.ws.close();\n    this.ws = undefined;\n  }\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './History.scss';\n\nimport { ThemeProvider } from '@rmwc/theme';\nimport React, { useEffect, useRef } from 'react';\nimport { connect } from 'react-redux';\n\nimport { grey100 } from '../../colors';\nimport { AppState } from '../../store';\nimport { LogEntry, LogState } from '../../store/logviewer';\nimport { CompiledGetterCache } from './CompiledGetterCache';\nimport { HighlightedJSON } from './HighlightedJSON';\nimport { ParsedQuery, filtersToQueryString, isQueryMatch } from './QueryBar';\n\nconst formatTimestamp = (timestamp: number) => {\n  const date = new Date(timestamp);\n  const segments = [date.getHours(), date.getMinutes(), date.getSeconds()];\n\n  return segments\n    .map((segment) => {\n      const number = segment.toString();\n\n      if (number.length === 2) return number;\n      else return `0${number}`;\n    })\n    .join(':');\n};\n\nconst FilterTag: React.FC<{ appendToQuery: Function; log: LogEntry }> = ({\n  appendToQuery,\n  log,\n}) => {\n  const metadata = log.data.metadata;\n  let tagButton;\n\n  if (metadata?.function?.name) {\n    tagButton = (\n      <div\n        className=\"log-tag-button\"\n        onClick={() =>\n          appendToQuery('metadata.function.name', metadata.function?.name)\n        }\n      >\n        function[{metadata.function.name}]\n      </div>\n    );\n  } else if (metadata?.emulator?.name) {\n    tagButton = (\n      <div\n        className=\"log-tag-button\"\n        onClick={() =>\n          appendToQuery('metadata.emulator.name', metadata.emulator?.name)\n        }\n      >\n        {metadata.emulator.name}\n      </div>\n    );\n  }\n\n  return <div className=\"log-tag\">{tagButton}</div>;\n};\n\ninterface PropsFromAttributes {\n  parsedQuery: ParsedQuery;\n  setQuery: (query: string) => void;\n  compiledGetters: CompiledGetterCache;\n}\n\ninterface PropsFromState {\n  log: LogState;\n}\n\ntype Props = PropsFromState & PropsFromAttributes;\n\nconst MAX_LOG_LINES = 100;\n\nexport const History: React.FC<Props> = ({\n  parsedQuery,\n  setQuery,\n  log,\n  compiledGetters,\n}) => {\n  const history = log.history.filter((log) =>\n    isQueryMatch(parsedQuery, log, compiledGetters)\n  );\n\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    if (messagesEndRef && messagesEndRef.current) {\n      (messagesEndRef.current as any).scrollIntoView();\n    }\n  };\n\n  useEffect(scrollToBottom, [history]);\n\n  const appendToQuery = (key: string, value: string) => {\n    setQuery(filtersToQueryString({ ...parsedQuery.filters, [key]: value }));\n  };\n\n  const getUserData = (log: LogEntry) =>\n    log?.data?.user && Object.keys(log?.data?.user).length;\n\n  return (\n    <ThemeProvider options={{ surface: grey100 }} className=\"LogHistory\">\n      {history.length ? (\n        history.slice(-MAX_LOG_LINES).map((log, index) => (\n          <div id={`log_${index}`} className=\"log-entry\" key={index}>\n            <span className=\"log-timestamp\">\n              {formatTimestamp(log.timestamp)}\n            </span>\n            <span\n              className={`log-level ${log.level}`}\n              onClick={() => appendToQuery('level', log.level)}\n            >\n              {log.level[0].toUpperCase()}\n            </span>\n            <FilterTag appendToQuery={appendToQuery} log={log} />\n            {getUserData(log) ? (\n              <HighlightedJSON\n                data={log.data.user}\n                appendToQuery={appendToQuery}\n                compiledGetters={compiledGetters}\n              />\n            ) : (\n              <div className=\"log-message-single\">{log.message}</div>\n            )}\n          </div>\n        ))\n      ) : (\n        <div className=\"LogHistoryEmpty\">\n          No logs are found which match your filters.\n        </div>\n      )}\n      <div ref={messagesEndRef} />\n    </ThemeProvider>\n  );\n};\n\nexport const mapStateToProps = ({ log }: AppState) => ({ log });\nexport const mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(History);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport { Card } from '@rmwc/card';\nimport { Elevation } from '@rmwc/elevation';\nimport { GridCell } from '@rmwc/grid';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { useLocation } from 'react-router-dom';\n\nimport { AppState } from '../../store';\nimport { LoggingConfig } from '../../store/config';\nimport {\n  LogEntry,\n  LogState,\n  logReceived,\n  logReset,\n} from '../../store/logviewer';\nimport { hasData } from '../../store/utils';\nimport { CompiledGetterCache } from './CompiledGetterCache';\nimport History from './History';\nimport { QueryBar, parseQuery } from './QueryBar';\nimport { ReconnectingWebSocket } from './ReconnectingWebSocket';\n\ninterface PropsFromState {\n  log: LogState;\n  config?: LoggingConfig;\n}\n\ninterface PropsFromDispatch {\n  logReceived: Function;\n  logReset: () => void;\n}\n\nexport type Props = PropsFromState & PropsFromDispatch;\n\nconst compiledGetters = new CompiledGetterCache();\n\nfunction useQuery() {\n  const { search } = useLocation();\n  return useMemo(() => new URLSearchParams(search), [search]);\n}\n\nexport const LogViewer: React.FC<Props> = ({\n  logReceived,\n  logReset,\n  config,\n}) => {\n  const qs = useQuery();\n  const [query, setQuery] = useState(qs.get('q') || '');\n\n  useEffect(() => {\n    if (!config) return;\n\n    logReset();\n    const webSocket = new ReconnectingWebSocket(config);\n    webSocket.listener = (log: LogEntry) => {\n      logReceived(log);\n    };\n    return () => webSocket.cleanup();\n  }, [config, logReceived, logReset]);\n\n  const parsedQuery = parseQuery(query);\n\n  return (\n    <GridCell span={12}>\n      <Elevation z={2} wrap>\n        <Card className=\"LogViewer\">\n          <QueryBar\n            query={query}\n            setQuery={setQuery}\n            compiledGetters={compiledGetters}\n          />\n          <History\n            parsedQuery={parsedQuery}\n            setQuery={setQuery}\n            compiledGetters={compiledGetters}\n          />\n        </Card>\n      </Elevation>\n    </GridCell>\n  );\n};\n\nexport const mapStateToProps = ({ config }: AppState) => {\n  return {\n    config: hasData(config.result) ? config.result.data.logging : undefined,\n  };\n};\nexport const mapDispatchToProps = {\n  logReceived,\n  logReset,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LogViewer);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\n\nimport Auth from './components/Auth';\nimport Database from './components/Database';\nimport Firestore from './components/Firestore';\nimport Home from './components/Home';\nimport LogsViewer from './components/LogViewer';\n\nexport interface Route {\n  path: string;\n  component: React.FC;\n  label: string;\n  exact: boolean;\n  showInNav: boolean;\n}\n\nexport const routes: ReadonlyArray<Route> = [\n  {\n    path: '/',\n    component: Home,\n    label: 'Overview',\n    exact: true,\n    showInNav: true,\n  },\n  {\n    path: '/auth',\n    component: Auth,\n    label: 'Authentication',\n    exact: false,\n    showInNav: true,\n  },\n  {\n    path: '/firestore',\n    component: Firestore,\n    label: 'Firestore',\n    exact: false,\n    showInNav: true,\n  },\n  {\n    path: '/database',\n    component: Database,\n    label: 'Realtime Database',\n    exact: false,\n    showInNav: true,\n  },\n  {\n    path: '/logs',\n    component: LogsViewer as any,\n    label: 'Logs',\n    exact: true,\n    showInNav: true,\n  },\n];\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Icon } from '@rmwc/icon';\nimport React from 'react';\n\nexport const Logo: React.FC = () => (\n  <Icon\n    className=\"Logo\"\n    icon={{\n      strategy: 'component',\n      icon: (\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          viewBox=\"0 0 192 192\"\n          style={{ width: '24px', height: '24px' }}\n        >\n          <defs>\n            <clipPath id=\"a\">\n              <path d=\"M143.41 47.34a4 4 0 0 0-6.77-2.16L115.88 66 99.54 34.89a4 4 0 0 0-7.08 0l-8.93 17-22.4-41.77a4 4 0 0 0-7.48 1.28L32 150l57.9 32.46a12 12 0 0 0 11.7 0L160 150z\" />\n            </clipPath>\n            <linearGradient\n              id=\"d\"\n              x1=\"-108.63\"\n              y1=\"-692.24\"\n              x2=\"-58.56\"\n              y2=\"-742.31\"\n              gradientTransform=\"matrix(2.67 0 0 -2.67 317.23 -1808)\"\n              gradientUnits=\"userSpaceOnUse\"\n            >\n              <stop offset=\"0\" stopColor=\"#fff\" stopOpacity=\".1\" />\n              <stop offset=\"1\" stopColor=\"#fff\" stopOpacity=\"0\" />\n            </linearGradient>\n            <linearGradient\n              id=\"b\"\n              x1=\"56.9\"\n              y1=\"102.54\"\n              x2=\"48.9\"\n              y2=\"98.36\"\n              gradientUnits=\"userSpaceOnUse\"\n            >\n              <stop offset=\"0\" stopColor=\"#a52714\" />\n              <stop offset=\".4\" stopColor=\"#a52714\" stopOpacity=\".5\" />\n              <stop offset=\".8\" stopColor=\"#a52714\" stopOpacity=\"0\" />\n            </linearGradient>\n            <linearGradient\n              id=\"c\"\n              x1=\"90.89\"\n              y1=\"90.91\"\n              x2=\"87.31\"\n              y2=\"87.33\"\n              gradientUnits=\"userSpaceOnUse\"\n            >\n              <stop offset=\"0\" stopColor=\"#a52714\" stopOpacity=\".8\" />\n              <stop offset=\".5\" stopColor=\"#a52714\" stopOpacity=\".21\" />\n              <stop offset=\"1\" stopColor=\"#a52714\" stopOpacity=\"0\" />\n            </linearGradient>\n          </defs>\n          <g clipPath=\"url(#a)\">\n            <path\n              d=\"M32 150L53.66 11.39a4 4 0 0 1 7.48-1.27l22.4 41.78 8.93-17a4 4 0 0 1 7.08 0L160 150z\"\n              fill=\"#ffa000\"\n            />\n            <path\n              opacity=\".12\"\n              fill=\"url(#b)\"\n              d=\"M106 9L0 0v192l32-42L106 9z\"\n            />\n            <path\n              d=\"M106.83 96.01l-23.3-44.12L32 150l74.83-53.99z\"\n              fill=\"#f57c00\"\n            />\n            <path opacity=\".2\" fill=\"url(#c)\" d=\"M0 0h192v192H0z\" />\n            <path\n              d=\"M160 150L143.41 47.34a4 4 0 0 0-6.77-2.16L32 150l57.9 32.47a12 12 0 0 0 11.7 0z\"\n              fill=\"#ffca28\"\n            />\n            <path\n              d=\"M143.41 47.34a4 4 0 0 0-6.77-2.16L115.88 66 99.54 34.89a4 4 0 0 0-7.08 0l-8.93 17-22.4-41.77a4 4 0 0 0-7.48 1.28L32 150h-.08l.07.08.57.28L115.83 67l20.78-20.8a4 4 0 0 1 6.78 2.16l16.45 101.74.16-.1zM32.19 149.81L53.66 12.39a4 4 0 0 1 7.48-1.28l22.4 41.78 8.93-17a4 4 0 0 1 7.08 0l16 30.43z\"\n              fill=\"#fff\"\n              fillOpacity=\".2\"\n            />\n            <path\n              d=\"M101.6 181.49a12 12 0 0 1-11.7 0l-57.76-32.4-.14.91 57.9 32.46a12 12 0 0 0 11.7 0L160 150l-.15-.92z\"\n              // style=\"isolation:isolate\"\n              fill=\"#a52714\"\n              opacity=\".2\"\n            />\n            <path\n              d=\"M143.41 47.34a4 4 0 0 0-6.77-2.16L115.88 66 99.54 34.89a4 4 0 0 0-7.08 0l-8.93 17-22.4-41.77a4 4 0 0 0-7.48 1.28L32 150l57.9 32.46a12 12 0 0 0 11.7 0L160 150z\"\n              fill=\"url(#d)\"\n            />\n          </g>\n        </svg>\n      ),\n    }}\n  />\n);\n\nexport default Logo;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './AppBar.scss';\n\nimport { Tab, TabBar } from '@rmwc/tabs';\nimport { ThemeProvider } from '@rmwc/theme';\nimport { TopAppBar } from '@rmwc/top-app-bar';\nimport { Typography } from '@rmwc/typography';\nimport React from 'react';\nimport { Link, matchPath, useLocation } from 'react-router-dom';\n\nimport { navBarOnSurface, navBarPrimary, navBarSurface } from '../../colors';\nimport { Route } from '../../routes';\nimport Logo from '../common/Logo';\n\ntype Props = {\n  routes: ReadonlyArray<Route>;\n};\n\nexport const AppBar: React.FC<Props> = ({ routes }) => {\n  let location = useLocation();\n\n  const navRoutes = routes.filter((r) => r.showInNav);\n\n  const tabs = navRoutes.map(({ path, label }: Route) => (\n    <Tab\n      key={label}\n      className=\"mdc-tab--min-width\"\n      {...{ tag: Link, to: path }}\n    >\n      {label}\n    </Tab>\n  ));\n\n  const activeTabIndex = navRoutes.findIndex((r) =>\n    matchPath(location.pathname, {\n      path: r.path,\n      exact: r.exact,\n    })\n  );\n\n  return (\n    <ThemeProvider\n      options={{\n        primary: navBarPrimary,\n        surface: navBarSurface,\n        onSurface: navBarOnSurface,\n      }}\n      wrap\n    >\n      <TopAppBar fixed className=\"AppBar\" theme=\"surface\">\n        <div className=\"AppBar-title-row\">\n          <div className=\"AppBar-logo-lockup\">\n            <Logo />\n            <Typography use=\"headline5\" className=\"AppBar-title\" tag=\"h1\">\n              Firebase Emulator Suite\n            </Typography>\n          </div>\n        </div>\n        <TabBar theme=\"onSurface\" activeTabIndex={activeTabIndex}>\n          {tabs}\n        </TabBar>\n      </TopAppBar>\n    </ThemeProvider>\n  );\n};\n\nexport default AppBar;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Dialog, DialogContent, DialogTitle } from '@rmwc/dialog';\nimport React from 'react';\nimport { connect } from 'react-redux';\n\nimport { createStructuredSelector } from '../../store';\nimport { getConfig } from '../../store/config/selectors';\nimport { hasError } from '../../store/utils';\n\nexport const mapStateToProps = createStructuredSelector({\n  configRemote: getConfig,\n});\n\nexport type PropsFromState = ReturnType<typeof mapStateToProps>;\n\nexport const AppDisconnected: React.FC<PropsFromState> = ({ configRemote }) => {\n  if (!hasError(configRemote.result)) {\n    return null;\n  }\n\n  return (\n    <Dialog open preventOutsideDismiss>\n      <DialogTitle>Emulator Suite Disconnected</DialogTitle>\n      <DialogContent>\n        All emulators for this project have stopped running. To restart all\n        emulators, at the command line, run{' '}\n        <code>firebase emulators:start</code>.\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default connect(mapStateToProps)(AppDisconnected);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './index.scss';\n\nimport { Portal } from '@rmwc/base';\nimport { DialogQueue } from '@rmwc/dialog';\nimport { Grid } from '@rmwc/grid';\nimport { Theme } from '@rmwc/theme';\nimport React from 'react';\nimport { Redirect, Route, Switch } from 'react-router-dom';\n\nimport { routes } from '../../routes';\nimport { dialogs } from '../common/DialogQueue';\nimport AppBar from './AppBar';\nimport AppDisconnected from './AppDisconnected';\n\nconst App: React.FC = () => {\n  return (\n    <>\n      <DialogQueue dialogs={dialogs} />\n      <Portal />\n      <AppDisconnected />\n      <Theme use=\"background\" wrap>\n        <div className=\"App\">\n          <AppBar routes={routes} />\n          <Grid className=\"App-main\">\n            <Switch>\n              {routes.map((r) => (\n                <Route\n                  key={r.path}\n                  path={r.path}\n                  component={r.component}\n                  exact={r.exact}\n                />\n              ))}\n              <Redirect\n                from=\"/functions\"\n                to=\"/logs?q=metadata.emulator.name%3D%22functions%22\"\n              />\n              <Redirect to=\"/\" /> {/* Fallback to redirect to overview. */}\n            </Switch>\n          </Grid>\n        </div>\n      </Theme>\n    </>\n  );\n};\n\nexport default App;\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport '@rmwc/tooltip/tooltip.css';\n\n// General + library styling. Should come before all local imports to allow\n// local styling to override them.\nimport './index.scss';\n\nimport { RMWCProvider } from '@rmwc/provider';\nimport { ThemeProvider } from '@rmwc/theme';\nimport React, { useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\n\nimport { background, primary, secondary } from './colors';\nimport App from './components/App';\nimport configureStore from './configureStore';\nimport { subscribe as subscribeToConfig } from './store/config';\nimport { error } from './themes';\n\nconst store = configureStore();\n\nconst RouterWithInit = () => {\n  useEffect(() => {\n    store.dispatch(subscribeToConfig());\n  }, []); // Empty-array means \"run only once on init\": https://reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects\n  return (\n    <BrowserRouter>\n      <Switch>\n        <Route component={App} />\n      </Switch>\n    </BrowserRouter>\n  );\n};\n\nReactDOM.unstable_createBlockingRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <RMWCProvider\n      // Globally disable ripples\n      ripple={false}\n    >\n      <ThemeProvider\n        options={{\n          background,\n          primary,\n          primaryRgb: '104, 29, 168',\n          secondary,\n          error,\n        }}\n      >\n        <Provider store={store}>\n          <RouterWithInit />\n        </Provider>\n      </ThemeProvider>\n    </RMWCProvider>\n  </React.StrictMode>\n);\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Store, applyMiddleware, compose, createStore } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\n\nimport { AppState, rootReducer, rootSaga } from './store';\n\nexport default function configureStore(): Store<AppState> {\n  const composeEnhancers =\n    (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n  const sagaMiddleware = createSagaMiddleware();\n  const store = createStore(\n    rootReducer,\n    composeEnhancers(applyMiddleware(sagaMiddleware))\n  );\n  sagaMiddleware.run(rootSaga);\n  return store;\n}\n","import { useSelector } from 'react-redux';\nimport { createSelector } from 'reselect';\n\nimport { Result, hasError, map } from '../utils';\nimport { FirestoreConfig } from './types';\nimport { AppState } from '..';\n\n// Get the RemoteResult wrapper for config. If you only care about result,\n// use getConfigResult instead for better caching.\nexport const getConfig = (state: AppState) => state.config;\n\nexport const getConfigResult = (state: AppState) => state.config.result;\n\n// Get whether config is being loaded / refreshed. Note: To check whether config\n// is present, use getConfigResult. This only tells whether we're fetching.\nexport const getConfigLoading = (state: AppState) => state.config.loading;\n\nexport const getProjectIdResult = createSelector(getConfigResult, (result) =>\n  map(result, (config) => config.projectId)\n);\n\nexport const getDatabaseConfigResult = createSelector(\n  getConfigResult,\n  (result) => map(result, (config) => config.database)\n);\n\nexport const getFirestoreConfigResult = createSelector(\n  getConfigResult,\n  (result) => map(result, (config) => config.firestore)\n);\n\nfunction useRemoteResultData<T = {}>(result: Result<T> | undefined) {\n  if (!result) {\n    throw new Error('Result data requested that is not yet populated');\n  }\n  if (hasError(result)) {\n    throw new Error(result.error.message);\n  }\n  return result.data;\n}\n\nexport function useProjectId() {\n  const projectId = useSelector(getProjectIdResult);\n  return useRemoteResultData(projectId);\n}\n\nexport function useFirestoreConfig() {\n  const config = useSelector(getFirestoreConfigResult);\n  return useRemoteResultData<FirestoreConfig | undefined>(config);\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panel\":\"CollectionFilter_panel__3z15Z\",\"header\":\"CollectionFilter_header__1-t0U\",\"headerTitle\":\"CollectionFilter_headerTitle__ebNNW\",\"preview\":\"CollectionFilter_preview__1TWpW\",\"children\":\"CollectionFilter_children__l7ZC9\",\"previewFilter\":\"CollectionFilter_previewFilter__eDMkO\",\"conditionEntries\":\"CollectionFilter_conditionEntries__2CpLn\",\"removeFilter\":\"CollectionFilter_removeFilter__1xNn1\",\"hidden\":\"CollectionFilter_hidden__IoL4U\",\"conditionEntry\":\"CollectionFilter_conditionEntry__xeuMd\",\"conditionEntryType\":\"CollectionFilter_conditionEntryType__3jxWW\",\"conditionEntryValue\":\"CollectionFilter_conditionEntryValue__3N83N\",\"actions\":\"CollectionFilter_actions__1uD4j\"};","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createAction } from 'typesafe-actions';\n\nimport { DatabaseInfo } from './types';\n\nexport const databasesFetchRequest = createAction(\n  '@database/DATABASES_FETCH_REQUEST'\n)();\n\nexport const databasesFetchSuccess = createAction(\n  '@database/DATABASES_FETCH_SUCCESS'\n)<DatabaseInfo[]>();\n\nexport const databasesFetchError = createAction(\n  '@database/DATABASES_FETCH_ERROR'\n)<{ message: string }>();\n\nexport const databasesSubscribe = createAction(\n  '@database/DATABASES_SUBSCRIBE'\n)();\n\nexport const databasesUnsubscribe = createAction(\n  '@database/DATABASES_UNSUBSCRIBE'\n)();\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createAction } from 'typesafe-actions';\n\nimport { Config } from './types';\n\nexport const fetchRequest = createAction('@config/FETCH_REQUEST')();\nexport const fetchSuccess = createAction('@config/FETCH_SUCCESS')<Config>();\nexport const fetchError = createAction('@config/FETCH_ERROR')<{\n  message: string;\n}>();\n\nexport const subscribe = createAction('@config/SUBSCRIBE')();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"emailWrapper\":\"controls_emailWrapper__2uj98\",\"error\":\"controls_error__3u2lA\",\"customAttributesWrapper\":\"controls_customAttributesWrapper__3rPpB\",\"customAttributeWrapper\":\"controls_customAttributeWrapper__w-Bmn\",\"signInWrapper\":\"controls_signInWrapper__3GGfU\",\"signInHeader\":\"controls_signInHeader__1CQk8\",\"authKindLabel\":\"controls_authKindLabel__1v_H7\"};","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from './types';\nexport * from './actions';\nexport * from './reducer';\nexport * from './sagas';\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"noResultsWrapper\":\"UsersTable_noResultsWrapper__2S_XP\",\"tableWrapper\":\"UsersTable_tableWrapper__1Quve\",\"disabled\":\"UsersTable_disabled__2DlIr\"};"],"sourceRoot":""}